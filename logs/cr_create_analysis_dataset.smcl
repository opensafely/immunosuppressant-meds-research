{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/workspace/logs/cr_create_analysis_dataset.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}17 Mar 2021, 13:53:40
{txt}
{com}. 
. * Set Ado file path
. adopath + "$projectdir/analysis/extra_ados"
{txt}  [1]  (BASE)      "{res}/usr/local/stata/ado/base/{txt}"
  [2]  (SITE)      "{res}/usr/local/ado/{txt}"
  [3]              "{res}.{txt}"
  [4]  (PERSONAL)  "{res}~/ado/personal/{txt}"
  [5]  (PLUS)      "{res}~/ado/plus/{txt}"
  [6]  (OLDPLACE)  "{res}~/ado/{txt}"
  [7]              "{res}/workspace/analysis/extra_ados{txt}"

{com}. 
. /* SET Index date ===========================================================*/
. global indexdate                        = "01/03/2020"
{txt}
{com}. 
. /* RENAME VARIABLES===========================================================*/
. 
. rename inflammatory_bowel_disease_uncla ibd_uncla
{res}{txt}
{com}. 
. /* Drop variables not needed ================================================*/
. *calculating ckd from creat 
. drop ckd ethnicity_date mepolizumab_3m_0m mepolizumab_6m_3m vedolizumab_3m_0m vedolizumab_6m_3m
{txt}
{com}. 
. /* CONVERT STRINGS TO DATE====================================================*/
. /* Comorb dates are given with month/year only, so adding day 15 to enable
>    them to be processed as dates */
. 
. foreach var of varlist   crohns_disease                                         ///
>                                                  ulcerative_colitis                                     ///
>                                                  ibd_uncla                              ///
>                                                  psoriasis                                                      ///
>                                                  hidradenitis_suppurativa                       ///
>                                                  psoriatic_arthritis                            ///
>                                                  rheumatoid_arthritis                           ///
>                                                  ankylosing_spondylitis                         ///
>                                                  chronic_cardiac_disease                        ///
>                                                  hba1c_new                                                      ///
>                                                  hba1c_old                                                      ///
>                                                  hba1c_mmol_per_mol_date                        ///
>                                                  hba1c_percentage_date                          ///
>                                                  diabetes                                                       ///
>                                                  hypertension                                           ///
>                                                  chronic_respiratory_disease            ///
>                                                  esrf                                                           ///
>                                                  copd                                                           ///
>                                                  chronic_liver_disease                          ///
>                                                  stroke                                                         ///
>                                                  lung_cancer                                            ///
>                                                  haem_cancer                                            ///
>                                                  other_cancer                                           ///
>                                                  creatinine_date                                ///
>                                                  organ_transplant                                       ///
>                                                  bmi_date_measured                              {c -(}
{txt}  2{com}.                                                         
.                 capture confirm string variable `var'
{txt}  3{com}.                 if _rc!=0 {c -(}
{txt}  4{com}.                         assert `var'==.
{txt}  5{com}.                         rename `var' `var'_date
{txt}  6{com}.                 {c )-}
{txt}  7{com}.         
.                 else {c -(}
{txt}  8{com}.                                 replace `var' = `var' + "-15"
{txt}  9{com}.                                 rename `var' `var'_dstr
{txt} 10{com}.                                 replace `var'_dstr = " " if `var'_dstr == "-15"
{txt} 11{com}.                                 gen `var'_date = date(`var'_dstr, "YMD") 
{txt} 12{com}.                                 order `var'_date, after(`var'_dstr)
{txt} 13{com}.                                 drop `var'_dstr
{txt} 14{com}.                 {c )-}
{txt} 15{com}.         
.         format `var'_date %td
{txt} 16{com}. {c )-}
{txt}variable {bf}crohns_disease{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}ulcerative_colitis{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}ibd_uncla{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}psoriasis{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}hidradenitis_suppurativa{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}psoriatic_arthritis{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}rheumatoid_arthritis{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}ankylosing_spondylitis{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}chronic_cardiac_disease{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}hba1c_new{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}hba1c_old{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}hba1c_mmol_per_mol_date{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(2,500 real changes made)
(2,500 missing values generated)
variable {bf}hba1c_percentage_date{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(2,500 real changes made)
(2,500 missing values generated)
variable {bf}diabetes{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}hypertension{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}chronic_respiratory_disease{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}esrf{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(45,000 real changes made)
(45,000 missing values generated)
variable {bf}copd{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}chronic_liver_disease{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}stroke{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}lung_cancer{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}haem_cancer{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}other_cancer{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}creatinine_date{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(2,500 real changes made)
(2,500 missing values generated)
variable {bf}organ_transplant{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(40,000 real changes made)
(40,000 missing values generated)
variable {bf}bmi_date_measured{sf} was {bf}{res}str7{sf}{txt} now {bf}{res}str10{sf}
{txt}(50,000 real changes made)
{res}{txt}(20,000 real changes made)
(20,000 missing values generated)

{com}. 
. /*conversion for dates with day already included*/
. 
. foreach var of varlist   icu_date_admitted                                      ///
>                                                  died_date_ons                                          ///
>                                                  first_pos_test_sgss                            ///
>                                                  {c -(}
{txt}  2{com}.                                                  
.                 capture confirm string variable `var'
{txt}  3{com}.                 if _rc!=0 {c -(}
{txt}  4{com}.                         assert `var'==.
{txt}  5{com}.                         rename `var' `var'_date
{txt}  6{com}.                 {c )-}
{txt}  7{com}.         
.                 else {c -(}
{txt}  8{com}.                                 rename `var' `var'_dstr
{txt}  9{com}.                                 gen `var'_date = date(`var'_dstr, "YMD") 
{txt} 10{com}.                                 order `var'_date, after(`var'_dstr)
{txt} 11{com}.                                 drop `var'_dstr
{txt} 12{com}.                                 gen `var'_date15 = `var'_date+15
{txt} 13{com}.                                 order `var'_date15, after(`var'_date)
{txt} 14{com}.                                 drop `var'_date
{txt} 15{com}.                                 rename `var'_date15 `var'_date
{txt} 16{com}.                 {c )-}
{txt} 17{com}.         
.         format `var'_date %td
{txt} 18{com}. {c )-}
{res}{txt}(45,000 missing values generated)
(45,000 missing values generated)
{res}{txt}(45,000 missing values generated)
(45,000 missing values generated)
{res}{txt}(45,000 missing values generated)
(45,000 missing values generated)
{res}{txt}
{com}.                                                  
. 
. /* RENAME VARAIBLES===========================================================*/
. *  An extra 'date' added to the end of some variable names, remove 
. rename icu_date_admitted_date                   icu_admitted_date                       
{res}{txt}
{com}. rename bmi_date_measured_date                   bmi_measured_date
{res}{txt}
{com}. rename died_date_ons_date                       died_ons_date 
{res}{txt}
{com}. rename creatinine_date_date                             creatinine_measured_date
{res}{txt}
{com}. rename hba1c_mmol_per_mol_date_date             hba1c_mmol_per_mol_date 
{res}{txt}
{com}. rename hba1c_percentage_date_date               hba1c_percentage_date
{res}{txt}
{com}. 
. 
. * Some names too long for loops below, shorten
. 
. /* CREATE BINARY VARIABLES====================================================*/
. 
. 
. *  Make indicator variables for all conditions where relevant 
. 
. 
. foreach var of varlist   crohns_disease_date                                ///
>                                                  ulcerative_colitis_date                                ///
>                                                  ibd_uncla_date                         ///
>                                                  psoriasis_date                                                 ///
>                                                  hidradenitis_suppurativa_date                  ///
>                                                  psoriatic_arthritis_date                               ///
>                                                  rheumatoid_arthritis_date                  ///
>                                                  ankylosing_spondylitis_date                    ///
>                                                  chronic_cardiac_disease_date                   ///
>                                                  hypertension_date                                              ///
>                                                  chronic_respiratory_disease_date               ///
>                                                  copd_date                                                              ///
>                                                  chronic_liver_disease_date                             ///
>                                                  stroke_date                                                    ///
>                                                  lung_cancer_date                                               ///
>                                                  haem_cancer_date                                               ///
>                                                  other_cancer_date                                              ///
>                                                  diabetes_date                                                  ///
>                                                  esrf_date                                                              ///
>                                                  creatinine_measured_date                   ///
>                                                  organ_transplant_date                                  ///
>                                                  bmi_measured_date                                          ///
>                                                  icu_admitted_date                                          ///
>                                                  died_ons_date                                                  ///
>                                                  first_pos_test_sgss_date       {c -(}
{txt}  2{com}.         /* date ranges are applied in python, so presence of date indicates presence of 
>           disease in the correct time frame */ 
.         local newvar =  substr("`var'", 1, length("`var'") - 5)
{txt}  3{com}.         gen `newvar' = (`var'!=. )
{txt}  4{com}.         order `newvar', after(`var')
{txt}  5{com}. {c )-}
{txt}
{com}. 
. /* CREATE VARIABLES===========================================================*/
. 
. /* DEMOGRAPHICS */ 
. 
. * Sex
. gen male = 1 if sex == "M"
{txt}(25,493 missing values generated)

{com}. replace male = 0 if sex == "F"
{txt}(25,493 real changes made)

{com}. 
. * Ethnicity
. replace ethnicity = .u if ethnicity == .
{txt}(12,500 real changes made, 12,500 to missing)

{com}. 
. *rearrange in order of prevalence
. recode ethnicity 2=6 /* mixed to 6 */
{txt}(ethnicity: 0 changes made)

{com}. recode ethnicity 3=2 /* south asian to 2 */
{txt}(ethnicity: 3720 changes made)

{com}. recode ethnicity 4=3 /* black to 3 */
{txt}(ethnicity: 0 changes made)

{com}. recode ethnicity 6=4 /* mixed to 4 */
{txt}(ethnicity: 0 changes made)

{com}. 
. label define ethnicity  1 "White"                                       ///
>                                                 2 "South Asian"                         ///
>                                                 3 "Black"                                       ///
>                                                 4 "Mixed"                                       ///
>                                                 5 "Other"                                       ///
>                                                 .u "Unknown"
{txt}
{com}. label values ethnicity ethnicity
{txt}
{com}. 
. gen ethnicity2 = ethnicity
{txt}(12,500 missing values generated)

{com}. replace ethnicity2 = . if ethnicity == .u
{txt}(12,500 real changes made, 12,500 to missing)

{com}. 
. * STP 
. rename stp stp_old
{res}{txt}
{com}. bysort stp_old: gen stp = 1 if _n==1
{txt}(49,998 missing values generated)

{com}. replace stp = sum(stp)
{txt}(49,999 real changes made)

{com}. drop stp_old
{txt}
{com}. 
. /*  IMD  */
. * Group into 5 groups
. rename imd imd_o
{res}{txt}
{com}. egen imd = cut(imd_o), group(5) icodes
{txt}
{com}. 
. * add one to create groups 1 - 5 
. replace imd = imd + 1
{txt}(50,000 real changes made)

{com}. 
. * - 1 is missing, should be excluded from population 
. replace imd = .u if imd_o == -1
{txt}(0 real changes made)

{com}. drop imd_o
{txt}
{com}. 
. * Reverse the order (so high is more deprived)
. recode imd 5 = 1 4 = 2 3 = 3 2 = 4 1 = 5 .u = .u
{txt}(imd: 50000 changes made)

{com}. 
. label define imd 1 "1 least deprived" 2 "2" 3 "3" 4 "4" 5 "5 most deprived" .u "Unknown"
{txt}
{com}. label values imd imd 
{txt}
{com}. 
. /*  Age variables  */ 
. ********works if ages 18 and over
. * Create categorised age
. drop if age<18 & age !=.
{txt}(10,646 observations deleted)

{com}. drop if age>109 & age !=.
{txt}(0 observations deleted)

{com}. 
. recode age 18/39.9999 = 1 /// 
>            40/49.9999 = 2 ///
>                    50/59.9999 = 3 ///
>                60/69.9999 = 4 ///
>                    70/79.9999 = 5 ///
>                    80/max = 6, gen(agegroup) 
{txt}(39354 differences between age and agegroup)

{com}. 
. label define agegroup   1 "18-<40" ///
>                                                 2 "40-<50" ///
>                                                 3 "50-<60" ///
>                                                 4 "60-<70" ///
>                                                 5 "70-<80" ///
>                                                 6 "80+"
{txt}
{com}.                                                 
. label values agegroup agegroup
{txt}
{com}. 
. * Create binary age
. recode age min/69.999 = 0 ///
>            70/max = 1, gen(age70)
{txt}(39354 differences between age and age70)

{com}. 
. * Check there are no missing ages
. assert age < .
{txt}
{com}. assert agegroup < .
{txt}
{com}. assert age70 < .
{txt}
{com}. 
. * Create restricted cubic splines for age
. mkspline age = age, cubic nknots(4)
{txt}
{com}. 
. /*  Body Mass Index  */
. * NB: watch for missingness
. 
. * Recode strange values 
. replace bmi = . if bmi == 0 
{txt}(15,752 real changes made, 15,752 to missing)

{com}. replace bmi = . if !inrange(bmi, 10, 60)
{txt}(290 real changes made, 290 to missing)

{com}. 
. * Restrict to within 10 years of index and aged > 16 
. gen bmi_time = (date("$indexdate", "DMY") - bmi_measured_date)/365.25
{txt}(15,752 missing values generated)

{com}. gen bmi_age = age - bmi_time
{txt}(15,752 missing values generated)

{com}. 
. replace bmi = . if bmi_age < 16 
{txt}(16,895 real changes made, 16,895 to missing)

{com}. replace bmi = . if bmi_time > 10 & bmi_time != . 
{txt}(4,376 real changes made, 4,376 to missing)

{com}. 
. * Set to missing if no date, and vice versa 
. replace bmi = . if bmi_measured_date == . 
{txt}(0 real changes made)

{com}. replace bmi_measured_date = . if bmi == . 
{txt}(21,561 real changes made, 21,561 to missing)

{com}. replace bmi_measured_date = . if bmi == . 
{txt}(0 real changes made)

{com}. 
. gen     bmicat = .
{txt}(39,354 missing values generated)

{com}. recode  bmicat . = 1 if bmi < 18.5
{txt}(bmicat: 87 changes made)

{com}. recode  bmicat . = 2 if bmi < 25
{txt}(bmicat: 226 changes made)

{com}. recode  bmicat . = 3 if bmi < 30
{txt}(bmicat: 320 changes made)

{com}. recode  bmicat . = 4 if bmi < 35
{txt}(bmicat: 400 changes made)

{com}. recode  bmicat . = 5 if bmi < 40
{txt}(bmicat: 379 changes made)

{com}. recode  bmicat . = 6 if bmi < .
{txt}(bmicat: 629 changes made)

{com}. replace bmicat = .u if bmi >= .
{txt}(37,313 real changes made, 37,313 to missing)

{com}. 
. label define bmicat 1 "Underweight (<18.5)"     ///
>                                         2 "Normal (18.5-24.9)"          ///
>                                         3 "Overweight (25-29.9)"        ///
>                                         4 "Obese I (30-34.9)"           ///
>                                         5 "Obese II (35-39.9)"          ///
>                                         6 "Obese III (40+)"                     ///
>                                         .u "Unknown (.u)"
{txt}
{com}.                                         
. label values bmicat bmicat
{txt}
{com}. 
. * Create less  granular categorisation
. recode bmicat 1/3 .u = 1 4 = 2 5 = 3 6 = 4, gen(obese4cat)
{txt}(39267 differences between bmicat and obese4cat)

{com}. 
. label define obese4cat  1 "No record of obesity"        ///
>                                                 2 "Obese I (30-34.9)"           ///
>                                                 3 "Obese II (35-39.9)"          ///
>                                                 4 "Obese III (40+)"             
{txt}
{com}. 
. label values obese4cat obese4cat
{txt}
{com}. order obese4cat, after(bmicat)
{txt}
{com}. 
. /*  Smoking  */
. 
. * Smoking 
. label define smoke 1 "Never" 2 "Former" 3 "Current" .u "Unknown (.u)"
{txt}
{com}. 
. gen     smoke = 1  if smoking_status == "N"
{txt}(38,538 missing values generated)

{com}. replace smoke = 2  if smoking_status == "E"
{txt}(375 real changes made)

{com}. replace smoke = 3  if smoking_status == "S"
{txt}(2,329 real changes made)

{com}. replace smoke = .u if smoking_status == "M"
{txt}(374 real changes made, 374 to missing)

{com}. replace smoke = .u if smoking_status == "" 
{txt}(35,460 real changes made, 35,460 to missing)

{com}. 
. label values smoke smoke
{txt}
{com}. drop smoking_status
{txt}
{com}. 
. * Create non-missing 3-category variable for current smoking
. * Assumes missing smoking is never smoking 
. recode smoke .u = 1, gen(smoke_nomiss)
{txt}(35834 differences between smoke and smoke_nomiss)

{com}. order smoke_nomiss, after(smoke)
{txt}
{com}. label values smoke_nomiss smoke
{txt}
{com}. 
. 
. /* CLINICAL COMORBIDITIES */ 
. 
. /* GP consultation rate */ 
. replace gp_consult_count = 0 if gp_consult_count <1 
{txt}(191 real changes made)

{com}. 
. * those with no count assumed to have no visits 
. replace gp_consult_count = 0 if gp_consult_count == . 
{txt}(0 real changes made)

{com}. gen gp_consult = (gp_consult_count >=1)
{txt}
{com}. 
. 
. /* eGFR */
. 
. * Set implausible creatinine values to missing (Note: zero changed to missing)
. replace creatinine = . if !inrange(creatinine, 20, 3000) 
{txt}(11,882 real changes made, 11,882 to missing)

{com}. 
. * Remove creatinine dates if no measurements, and vice versa 
. 
. replace creatinine = . if creatinine_measured_date == . 
{txt}(0 real changes made)

{com}. replace creatinine_measured_date = . if creatinine == . 
{txt}(9,889 real changes made, 9,889 to missing)

{com}. 
. 
. * Divide by 88.4 (to convert umol/l to mg/dl)
. gen SCr_adj = creatinine/88.4
{txt}(11,882 missing values generated)

{com}. 
. gen min = .
{txt}(39,354 missing values generated)

{com}. replace min = SCr_adj/0.7 if male==0
{txt}(14,009 real changes made)

{com}. replace min = SCr_adj/0.9 if male==1
{txt}(13,463 real changes made)

{com}. replace min = min^-0.329  if male==0
{txt}(14,009 real changes made)

{com}. replace min = min^-0.411  if male==1
{txt}(13,463 real changes made)

{com}. replace min = 1 if min<1
{txt}(24,255 real changes made)

{com}. 
. gen max=.
{txt}(39,354 missing values generated)

{com}. replace max=SCr_adj/0.7 if male==0
{txt}(14,009 real changes made)

{com}. replace max=SCr_adj/0.9 if male==1
{txt}(13,463 real changes made)

{com}. replace max=max^-1.209
{txt}(27,472 real changes made)

{com}. replace max=1 if max>1
{txt}(15,099 real changes made)

{com}. 
. gen egfr=min*max*141
{txt}(11,882 missing values generated)

{com}. replace egfr=egfr*(0.993^age)
{txt}(27,472 real changes made)

{com}. replace egfr=egfr*1.018 if male==0
{txt}(14,009 real changes made)

{com}. label var egfr "egfr calculated using CKD-EPI formula with no eth"
{txt}
{com}. 
. * Categorise into ckd stages
. egen egfr_cat_all = cut(egfr), at(0, 15, 30, 45, 60, 5000)
{txt}(11882 missing values generated)

{com}. recode egfr_cat_all 0 = 5 15 = 4 30 = 3 45 = 2 60 = 0, generate(ckd_egfr)
{txt}(27472 differences between egfr_cat_all and ckd_egfr)

{com}. 
. /* 
> 0 "No CKD, eGFR>60"     or missing -- have been shown reasonable in CPRD
> 2 "stage 3a, eGFR 45-59" 
> 3 "stage 3b, eGFR 30-44" 
> 4 "stage 4, eGFR 15-29" 
> 5 "stage 5, eGFR <15"
> */
. 
. gen egfr_cat = .
{txt}(39,354 missing values generated)

{com}. recode egfr_cat . = 3 if egfr < 30
{txt}(egfr_cat: 15186 changes made)

{com}. recode egfr_cat . = 2 if egfr < 60
{txt}(egfr_cat: 6181 changes made)

{com}. recode egfr_cat . = 1 if egfr < .
{txt}(egfr_cat: 6105 changes made)

{com}. replace egfr_cat = .u if egfr >= .
{txt}(11,882 real changes made, 11,882 to missing)

{com}. 
. label define egfr_cat   1 ">=60"                ///
>                                                 2 "30-59"               ///
>                                                 3 "<30"                 ///
>                                                 .u "Unknown (.u)"
{txt}
{com}.                                         
. label values egfr_cat egfr_cat
{txt}
{com}. 
. *if missing eGFR, assume normal
. 
. gen egfr_cat_nomiss = egfr_cat
{txt}(11,882 missing values generated)

{com}. replace egfr_cat_nomiss = 1 if egfr_cat == .u
{txt}(11,882 real changes made)

{com}. 
. label define egfr_cat_nomiss    1 ">=60/missing"        ///
>                                                                 2 "30-59"                       ///
>                                                                 3 "<30" 
{txt}
{com}. label values egfr_cat_nomiss egfr_cat_nomiss
{txt}
{com}. 
. gen egfr_date = creatinine_measured_date
{txt}(11,882 missing values generated)

{com}. format egfr_date %td
{txt}
{com}. 
. * Add in end stage renal failure and create a single CKD variable 
. * Missing assumed to not have CKD 
. gen ckd = 0
{txt}
{com}. replace ckd = 1 if ckd_egfr != . & ckd_egfr >= 1
{txt}(21,367 real changes made)

{com}. replace ckd = 1 if esrf == 1
{txt}(1,788 real changes made)

{com}. 
. label define ckd 0 "No CKD" 1 "CKD"
{txt}
{com}. label values ckd ckd
{txt}
{com}. label var ckd "CKD stage calc without eth"
{txt}
{com}. 
. * Create date (most recent measure prior to index)
. gen temp1_ckd_date = creatinine_measured_date if ckd_egfr >=1
{txt}(17,987 missing values generated)

{com}. gen temp2_ckd_date = esrf_date if esrf == 1
{txt}(35,445 missing values generated)

{com}. gen ckd_date = max(temp1_ckd_date,temp2_ckd_date) 
{txt}(16,199 missing values generated)

{com}. format ckd_date %td 
{txt}
{com}. 
. /* HbA1c */
. 
. /*  Diabetes severity  */
. 
. * Set zero or negative to missing
. replace hba1c_percentage   = . if hba1c_percentage <= 0
{txt}(2,195 real changes made, 2,195 to missing)

{com}. replace hba1c_mmol_per_mol = . if hba1c_mmol_per_mol <= 0
{txt}(2,810 real changes made, 2,810 to missing)

{com}. 
. * Set most recent values of >15 months prior to index to missing
. replace hba1c_percentage   = . if (date("$indexdate", "DMY") - hba1c_percentage_date) > 15*30 & hba1c_percentage_date != .
{txt}(36,787 real changes made, 36,787 to missing)

{com}. replace hba1c_mmol_per_mol = . if (date("$indexdate", "DMY") - hba1c_mmol_per_mol_date) > 15*30 & hba1c_mmol_per_mol_date != .
{txt}(36,159 real changes made, 36,159 to missing)

{com}. 
. * Clean up dates
. replace hba1c_percentage_date = . if hba1c_percentage == .
{txt}(37,007 real changes made, 37,007 to missing)

{com}. replace hba1c_mmol_per_mol_date = . if hba1c_mmol_per_mol == .
{txt}(37,021 real changes made, 37,021 to missing)

{com}. 
. /* Express  HbA1c as percentage  */ 
. 
. * Express all values as perecentage 
. noi summ hba1c_percentage hba1c_mmol_per_mol 

{txt}    Variable {c |}        Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 57}
hba1c_per~ge {c |}{res}        372    5.140722    1.927376   .1196161   10.53715
{txt}hba1c_mmol~l {c |}{res}        385    42.13012    19.10452   1.610774   94.68166
{txt}
{com}. gen     hba1c_pct = hba1c_percentage 
{txt}(38,982 missing values generated)

{com}. replace hba1c_pct = (hba1c_mmol_per_mol/10.929)+2.15 if hba1c_mmol_per_mol<. 
{txt}(385 real changes made)

{com}. 
. * Valid % range between 0-20  
. replace hba1c_pct = . if !inrange(hba1c_pct, 0, 20) 
{txt}(0 real changes made)

{com}. replace hba1c_pct = round(hba1c_pct, 0.1)
{txt}(752 real changes made)

{com}. 
. /* Categorise hba1c and diabetes  */
. 
. * Group hba1c
. gen     hba1ccat = 0 if hba1c_pct <  6.5
{txt}(38,847 missing values generated)

{com}. replace hba1ccat = 1 if hba1c_pct >= 6.5  & hba1c_pct < 7.5
{txt}(126 real changes made)

{com}. replace hba1ccat = 2 if hba1c_pct >= 7.5  & hba1c_pct < 8
{txt}(39 real changes made)

{com}. replace hba1ccat = 3 if hba1c_pct >= 8    & hba1c_pct < 9
{txt}(45 real changes made)

{com}. replace hba1ccat = 4 if hba1c_pct >= 9    & hba1c_pct !=.
{txt}(35 real changes made)

{com}. label define hba1ccat 0 "<6.5%" 1">=6.5-7.4" 2">=7.5-7.9" 3">=8-8.9" 4">=9"
{txt}
{com}. label values hba1ccat hba1ccat
{txt}
{com}. 
. * Create diabetes, split by control/not
. gen     diabcat = 1 if diabetes==0
{txt}(7,869 missing values generated)

{com}. replace diabcat = 2 if diabetes==1 & inlist(hba1ccat, 0, 1)
{txt}(119 real changes made)

{com}. replace diabcat = 3 if diabetes==1 & inlist(hba1ccat, 2, 3, 4)
{txt}(19 real changes made)

{com}. replace diabcat = 4 if diabetes==1 & !inlist(hba1ccat, 0, 1, 2, 3, 4)
{txt}(7,731 real changes made)

{com}. 
. label define diabcat    1 "No diabetes"                         ///
>                                                 2 "Controlled diabetes"         ///
>                                                 3 "Uncontrolled diabetes"       ///
>                                                 4 "Diabetes, no hba1c measure"
{txt}
{com}. label values diabcat diabcat
{txt}
{com}. 
. * create cancer *variable 'other cancer currently' includes carcinoma of the head and neck - need to confirm if this excludes NMSC
. gen cancer =0
{txt}
{com}. replace cancer =1 if lung_cancer ==1 | haem_cancer ==1 | other_cancer ==1
{txt}(19,143 real changes made)

{com}. 
. *creat other comorbid variables
. gen combined_cv_comorbid =1 if chronic_cardiac_disease ==1 | stroke==1
{txt}(25,174 missing values generated)

{com}. 
. 
. * Delete unneeded variables
. drop hba1c_pct hba1c_percentage hba1c_mmol_per_mol
{txt}
{com}. 
. *************************************************************************************************
. /* POPULATIONS =============================================================*/
. 
. /* Diagnosis =============*/
. *include only most recent diagnosis within each specialty
. *Rheum
. replace rheumatoid_arthritis =0 if psoriatic_arthritis_date > rheumatoid_arthritis_date & psoriatic_arthritis_date !=.
{txt}(806 real changes made)

{com}. replace rheumatoid_arthritis =0 if ankylosing_spondylitis_date > rheumatoid_arthritis_date & ankylosing_spondylitis_date !=.
{txt}(691 real changes made)

{com}. replace psoriatic_arthritis     =0 if rheumatoid_arthritis_date > psoriatic_arthritis_date & rheumatoid_arthritis_date !=.
{txt}(770 real changes made)

{com}. replace psoriatic_arthritis     =0 if ankylosing_spondylitis_date > psoriatic_arthritis_date & ankylosing_spondylitis_date !=.
{txt}(689 real changes made)

{com}. replace ankylosing_spondylitis =0 if psoriatic_arthritis_date > ankylosing_spondylitis_date & psoriatic_arthritis_date !=.
{txt}(812 real changes made)

{com}. replace ankylosing_spondylitis =0 if rheumatoid_arthritis_date > ankylosing_spondylitis_date & rheumatoid_arthritis_date !=.
{txt}(682 real changes made)

{com}. 
.  
. *Derm
. replace psoriasis =0 if hidradenitis_suppurativa_date > psoriasis_date & hidradenitis_suppurativa_date !=.
{txt}(801 real changes made)

{com}. *replace psoriasis =0 if atopic_dermatitis_date > psoriasis_date & atopic_dermatitis_date !=.
. replace hidradenitis_suppurativa =0 if psoriasis_date > hidradenitis_suppurativa_date & psoriasis_date !=.
{txt}(817 real changes made)

{com}. *replace hidradenitis_suppurativa =0 if atopic_dermatitis_date > hidradenitis_suppurativa_date & atopic_dermatitis_date !=.
. * replace atopic_dermatitis =0 if psoriasis_date > atopic_dermatitis_date & psoriasis_date !=.
. * replace atopic_dermatitis =0 if hidradenitis_suppurativa_date > atopic_dermatitis_date & hidradenitis_suppurativa_date !=.
. 
. *Gastro
. replace ibd_uncla =0 if ulcerative_colitis_date > ibd_uncla_date  & ulcerative_colitis_date !=.
{txt}(830 real changes made)

{com}. replace ibd_uncla =0 if crohns_disease_date > ibd_uncla_date  & crohns_disease_date !=.
{txt}(723 real changes made)

{com}. replace ulcerative_colitis =0 if crohns_disease_date > ulcerative_colitis_date & crohns_disease_date !=.
{txt}(814 real changes made)

{com}. replace ulcerative_colitis =0 if ibd_uncla_date > ulcerative_colitis_date & ibd_uncla_date !=.
{txt}(665 real changes made)

{com}. replace crohns_disease =0 if ulcerative_colitis_date > crohns_disease_date & ulcerative_colitis_date !=.
{txt}(807 real changes made)

{com}. replace crohns_disease =0 if ibd_uncla_date > crohns_disease_date & ibd_uncla_date !=.
{txt}(681 real changes made)

{com}. 
. *consider the effect of patients diagnosed with imid post 1st March 2020
. *ignoring this will bias to null
. *diagnoses after 1st March have been culled via python code
. 
. gen imid = .
{txt}(39,354 missing values generated)

{com}. replace imid = 1 if rheumatoid_arthritis ==1 | psoriatic_arthritis ==1 | ankylosing_spondylitis==1 | ibd_uncla ==1 | ulcerative_colitis ==1 | crohns_disease ==1 | psoriasis ==1 | hidradenitis_suppurativa ==1
{txt}(32,719 real changes made)

{com}. replace imid = 0 if rheumatoid_arthritis !=1 & psoriatic_arthritis !=1 & ibd_uncla !=1 & ulcerative_colitis !=1 & crohns_disease !=1 & psoriasis !=1 & hidradenitis_suppurativa !=1 & ankylosing_spondylitis !=1
{txt}(6,635 real changes made)

{com}. 
. label define imid 0 "Gen Pop" 1 "IMID"
{txt}
{com}. label values imid imid
{txt}
{com}. 
. gen bowel =0
{txt}
{com}. replace bowel =1 if crohns_disease ==1 | ibd_uncla ==1 | ulcerative_colitis ==1
{txt}(19,139 real changes made)

{com}. label define bowel 0 "Gen Pop" 1 "Bowel"
{txt}
{com}. label values bowel bowel
{txt}
{com}. 
. gen skin =0
{txt}
{com}. replace skin =1 if psoriasis ==1 | hidradenitis_suppurativa ==1
{txt}(14,149 real changes made)

{com}. label define skin 0 "Gen Pop" 1 "Skin"
{txt}
{com}. label values skin skin
{txt}
{com}. 
. gen joint =0
{txt}
{com}. replace joint =1 if rheumatoid_arthritis ==1 | psoriatic_arthritis ==1 | ankylosing_spondylitis ==1
{txt}(19,158 real changes made)

{com}. label define joint 0 "Gen Pop" 1 "Joint"
{txt}
{com}. label values joint joint
{txt}
{com}. 
. 
. *Loop to replace missing with 0
. foreach var of varlist  oral_prednisolone_3m_0m  ///
>                                                 oral_prednisolone_6m_3m  /// 
>                                                 adalimumab_3m_0m                 ///
>                                                 adalimumab_6m_3m                 ///
>                                                 abatacept_3m_0m                  ///
>                                                 abatacept_6m_3m                  ///
>                                                 certolizumab_3m_0m               ///
>                                                 certolizumab_6m_3m       ///
>                                                 etanercept_3m_0m                 ///
>                                                 etanercept_6m_3m                 ///
>                                                 golimumab_3m_0m                  ///
>                                                 golimumab_6m_3m                  ///
>                                                 infliximab_3m_0m                 ///
>                                                 infliximab_6m_3m                 ///
>                                                 sarilumab_3m_0m                  ///
>                                                 sarilumab_6m_3m                  ///
>                                                 tocilizumab_3m_0m                ///
>                                                 tocilizumab_6m_3m                ///
>                                                 ustekinumab_3m_0m                ///
>                                                 ustekinumab_6m_3m                ///
>                                                 guselkumab_3m_0m                 ///
>                                                 guselkumab_6m_3m                 ///
>                                                 tildrakizumab_3m_0m      ///
>                                                 tildrakizumab_6m_3m      ///
>                                                 risankizumab_3m_0m               ///
>                                                 risankizumab_6m_3m               ///
>                                                 secukinumab_3m_0m                ///
>                                                 secukinumab_6m_3m                ///
>                                                 ixekizumab_3m_0m                 ///
>                                                 ixekizumab_6m_3m                 ///
>                                                 brodalumab_3m_0m                 ///
>                                                 brodalumab_6m_3m                 ///
>                                                 baricitinib_3m_0m                ///
>                                                 baricitinib_6m_3m                ///
>                                                 tofacitinib_3m_0m                ///
>                                                 tofacitinib_6m_3m                ///
>                                                 rituximab_12m_6m                 ///
>                                                 rituximab_6m_3m                  ///
>                                                 rituximab_3m_0m                  ///
>                                                 azathioprine_3m_0m               ///
>                                                 azathioprine_6m_3m               ///
>                                                 ciclosporin_3m_0m                ///
>                                                 ciclosporin_6m_3m                ///
>                                                 gold_3m_0m                               ///
>                                                 gold_6m_3m                               ///
>                                                 leflunomide_3m_0m                ///
>                                                 leflunomide_6m_3m                ///
>                                                 mercaptopurine_3m_0m     ///
>                                                 mercaptopurine_6m_3m     ///
>                                                 methotrexate_3m_0m               ///
>                                                 methotrexate_6m_3m               ///
>                                                 methotrexate_hcd_3m_0m   ///    
>                                                 methotrexate_hcd_6m_3m   ///
>                                                 mycophenolate_3m_0m              ///
>                                                 mycophenolate_6m_3m              ///
>                                                 penicillamine_3m_0m              ///
>                                                 penicillamine_6m_3m              ///
>                                                 sulfasalazine_3m_0m          ///
>                                                 sulfasalazine_6m_3m              ///
>                                                 mesalazine_3m_0m                 ///
>                                                 mesalazine_6m_3m        {c -(}
{txt}  2{com}.                                                 
.                                                 replace `var' =0 if `var' ==.
{txt}  3{com}.                                                 {c )-}
{txt}(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)

{com}. 
. 
. *stand sys drugs data are count, not binary!
. gen standsys =1 if azathioprine_3m_0m >=1 | azathioprine_6m_3m >=1 | ciclosporin_3m_0m >=1 |ciclosporin_6m_3m >=1 | leflunomide_3m_0m >=1 |leflunomide_6m_3m >=1 | mercaptopurine_3m_0m >=1 |mercaptopurine_6m_3m >=1 | methotrexate_3m_0m >=1 | methotrexate_6m_3m >=1 | methotrexate_hcd_3m_0m >=1 | methotrexate_hcd_6m_3m >=1 | mycophenolate_3m_0m >=1 | mycophenolate_6m_3m >=1 | sulfasalazine_3m_0m >=1 |sulfasalazine_6m_3m >=1 | mesalazine_3m_0m >=1 | mesalazine_6m_3m >=1
{txt}(7,844 missing values generated)

{com}. replace standsys =. if imid !=1
{txt}(5,359 real changes made, 5,359 to missing)

{com}. 
. gen standsys3m =1 if azathioprine_3m_0m >=1 | ciclosporin_3m_0m >=1 | leflunomide_3m_0m >=1 | mercaptopurine_3m_0m >=1 | methotrexate_3m_0m >=1 | methotrexate_hcd_3m_0m >=1 | mycophenolate_3m_0m >=1 | sulfasalazine_3m_0m >=1  | mesalazine_3m_0m >=1
{txt}(17,507 missing values generated)

{com}. replace standsys3m =. if imid !=1
{txt}(3,740 real changes made, 3,740 to missing)

{com}. 
. gen tnf =1 if adalimumab_6m_3m !=0 | adalimumab_3m_0m !=0 | certolizumab_6m_3m !=0 | certolizumab_3m_0m !=0 | etanercept_6m_3m !=0 | etanercept_3m_0m !=0 | golimumab_6m_3m !=0 | golimumab_3m_0m !=0 | infliximab_6m_3m !=0 | infliximab_3m_0m !=0
{txt}(13,744 missing values generated)

{com}. replace tnf =. if imid !=1
{txt}(4,277 real changes made, 4,277 to missing)

{com}. 
. gen tnfmono =1 if tnf==1 & standsys !=1
{txt}(35,088 missing values generated)

{com}. recode tnfmono .=0 if tnf==1 & standsys ==1
{txt}(tnfmono: 17067 changes made)

{com}. 
. label define tnfmono    0 "TNF combination"                     ///
>                                                 1 "TNF monotherapy"     
{txt}
{com}. label values tnfmono tnfmono
{txt}
{com}. label var tnfmono "TNF strategy"
{txt}
{com}. 
. *high cost drug data pull through as binary variable, not count
. gen standtnf =1 if tnf ==1
{txt}(18,021 missing values generated)

{com}. replace standtnf =0 if standsys ==1 & tnf !=1
{txt}(9,084 real changes made)

{com}. 
. gen standtnf3m =1 if adalimumab_3m_0m ==1 | certolizumab_3m_0m ==1 | etanercept_3m_0m ==1 | golimumab_3m_0m ==1 | infliximab_3m_0m ==1
{txt}(23,271 missing values generated)

{com}. replace standtnf3m =0 if adalimumab_3m_0m !=1 & certolizumab_3m_0m !=1 & etanercept_3m_0m !=1 & golimumab_3m_0m !=1 & infliximab_3m_0m !=1 & standsys3m ==1
{txt}(10,713 real changes made)

{com}.                                 
. gen il23 =1 if ustekinumab_3m_0m !=0 | ustekinumab_6m_3m !=0 | guselkumab_3m_0m !=0 | guselkumab_6m_3m !=0 | tildrakizumab_3m_0m !=0 | tildrakizumab_6m_3m !=0 | risankizumab_3m_0m !=0 | risankizumab_6m_3m !=0 
{txt}(16,892 missing values generated)

{com}. replace il23 =. if imid !=1
{txt}(3,741 real changes made, 3,741 to missing)

{com}. 
. gen standil23 =1 if il23 ==1
{txt}(20,633 missing values generated)

{com}. replace standil23 =0 if standsys ==1 & il23 !=1
{txt}(11,181 real changes made)

{com}. 
. gen standil233m =1 if ustekinumab_3m_0m ==1 | guselkumab_3m_0m ==1 | tildrakizumab_3m_0m ==1 | risankizumab_3m_0m ==1 
{txt}(25,811 missing values generated)

{com}. replace standil233m =0 if ustekinumab_3m_0m !=1 & guselkumab_3m_0m !=1 & tildrakizumab_3m_0m !=1 & risankizumab_3m_0m !=1 & standsys3m ==1
{txt}(11,806 real changes made)

{com}. 
. gen jaki =1 if baricitinib_3m_0m !=0 | baricitinib_6m_3m !=0 | tofacitinib_3m_0m !=0 | tofacitinib_6m_3m !=0 
{txt}(25,810 missing values generated)

{com}. replace jaki =. if imid !=1
{txt}(2,269 real changes made, 2,269 to missing)

{com}. 
. gen standjaki =1 if jaki ==1
{txt}(28,079 missing values generated)

{com}. replace standjaki =0 if standsys ==1 & jaki !=1
{txt}(17,127 real changes made)

{com}. 
. gen standjaki3m =1 if baricitinib_3m_0m ==1 | tofacitinib_3m_0m ==1 
{txt}(31,872 missing values generated)

{com}. replace standjaki3m =0 if baricitinib_3m_0m !=1 & tofacitinib_3m_0m !=1 & standsys3m ==1
{txt}(14,620 real changes made)

{com}. 
. gen ritux =1 if rituximab_3m_0m !=0 | rituximab_6m_3m !=0 | rituximab_12m_6m !=0
{txt}(28,669 missing values generated)

{com}. replace ritux =. if rheumatoid_arthritis !=1
{txt}(8,960 real changes made, 8,960 to missing)

{com}. 
. gen standritux =1 if ritux ==1
{txt}(37,629 missing values generated)

{com}. replace standritux =0 if standsys ==1 & ritux !=1
{txt}(24,788 real changes made)

{com}. 
. gen standritux3m =1 if rituximab_3m_0m ==1
{txt}(35,367 missing values generated)

{com}. replace standritux3m =0 if rituximab_3m_0m !=1 & standsys3m ==1
{txt}(16,328 real changes made)

{com}. 
. gen il6 =1 if sarilumab_3m_0m !=0 | sarilumab_6m_3m !=0 | tocilizumab_3m_0m !=0 | tocilizumab_6m_3m !=0
{txt}(25,916 missing values generated)

{com}. replace il6 =. if rheumatoid_arthritis !=1
{txt}(11,320 real changes made, 11,320 to missing)

{com}. 
. gen standil6 =1 if il6 ==1
{txt}(37,236 missing values generated)

{com}. replace standil6 =0 if standsys ==1 & il6 !=1
{txt}(24,481 real changes made)

{com}. 
. gen standil63m =1 if sarilumab_3m_0m ==1 | tocilizumab_3m_0m ==1
{txt}(31,874 missing values generated)

{com}. replace standil63m =0 if sarilumab_3m_0m !=1 & tocilizumab_3m_0m !=1 & standsys3m ==1
{txt}(14,601 real changes made)

{com}. 
. gen il17 =1 if secukinumab_3m_0m !=0 | secukinumab_6m_3m !=0 | ixekizumab_3m_0m !=0 | ixekizumab_6m_3m !=0 | brodalumab_3m_0m !=0 | brodalumab_6m_3m !=0 
{txt}(21,003 missing values generated)

{com}. replace il17 =. if psoriatic_arthritis !=1 & ankylosing_spondylitis !=1 & psoriasis !=1
{txt}(10,146 real changes made, 10,146 to missing)

{com}. 
. gen standil17 =1 if il17 ==1
{txt}(31,149 missing values generated)

{com}. replace standil17 =0 if standsys ==1 & il17 !=1
{txt}(19,624 real changes made)

{com}. 
. gen standil173m =1 if secukinumab_3m_0m ==1 | ixekizumab_3m_0m ==1 | brodalumab_3m_0m ==1 
{txt}(28,727 missing values generated)

{com}. replace standil173m =0 if secukinumab_3m_0m !=1 & ixekizumab_3m_0m !=1 & brodalumab_3m_0m !=1 & standsys3m ==1
{txt}(13,299 real changes made)

{com}. 
. gen mesalazine =1 if mesalazine_3m_0m >=1 | mesalazine_6m_3m >=1
{txt}(33,066 missing values generated)

{com}. replace mesalazine =. if imid !=1
{txt}(1,111 real changes made, 1,111 to missing)

{com}. 
. gen standmesalazine =1 if mesalazine >=1
{txt}
{com}. replace standmesalazine =0 if standsys ==1 & mesalazine ==0
{txt}(0 real changes made)

{com}. 
. gen standmesalazine3m =1 if mesalazine_3m_0m >=1
{txt}(36,091 missing values generated)

{com}. replace standmesalazine3m =0 if mesalazine_3m_0m ==0 & standsys3m ==1
{txt}(15,385 real changes made)

{com}. 
. gen steroidcat = 0
{txt}
{com}. replace steroidcat =1 if oral_prednisolone_3m_0m >=1 & oral_prednisolone_3m_0m!=.
{txt}(3,330 real changes made)

{com}. 
. *gen imiddrugcategory = (standard v highcost)
. gen imiddrugcategory = 1 if standtnf ==1 | standil23 ==1 | standjaki ==1 | standritux ==1 | standil6 ==1 | standil17 ==1
{txt}(8,683 missing values generated)

{com}. recode imiddrugcategory .=0 if standsys ==1 
{txt}(imiddrugcategory: 1669 changes made)

{com}. 
. 
. /* OUTCOME AND SURVIVAL TIME==================================================*/
. /*  Cohort entry and censor dates  */
. 
. * Date of cohort entry, 1 Mar 2020
. gen enter_date = date("$indexdate", "DMY")
{txt}
{com}. format enter_date %td
{txt}
{com}. 
. /*   Outcomes   */
. 
. * Outcomes: itu admission, ONS-covid death  
. 
. * Add half-day buffer if outcome on indexdate
. replace died_ons_date=died_ons_date+0.5 if died_ons_date==enter_date
{txt}(0 real changes made)

{com}. replace icu_admitted_date=icu_admitted_date+0.5 if icu_admitted_date==enter_date
{txt}(0 real changes made)

{com}. 
. * Date of Covid death in ONS
. gen died_ons_date_covid = died_ons_date if died_ons_covid_flag_any == 1
{txt}(38,945 missing values generated)

{com}. 
. * Date of non-COVID death in ONS 
. * If missing date of death resulting died_date will also be missing
. gen died_ons_date_noncovid = died_ons_date if died_ons_covid_flag_any != 1 
{txt}(35,773 missing values generated)

{com}. 
. *date of COVID ITU admission ** issue we have is how we define an ITU admission as a COVID one. 
. gen icu_admit_diff = icu_admitted_date - first_pos_test_sgss_date
{txt}(38,989 missing values generated)

{com}. replace icu_admit_diff =. if icu_admit_diff <-5
{txt}(158 real changes made, 158 to missing)

{com}. gen icu_admit_date_covid = icu_admitted_date if icu_admit_diff <28 
{txt}(39,322 missing values generated)

{com}. 
. gen icu_or_death_covid_date = icu_admit_date_covid
{txt}(39,322 missing values generated)

{com}. replace icu_or_death_covid_date = died_ons_date_covid if icu_admit_date_covid ==.
{txt}(409 real changes made)

{com}. gen icu_or_death_covid =1 if icu_or_death_covid_date !=.
{txt}(38,913 missing values generated)

{com}. 
. format died_ons_date_covid died_ons_date_noncovid icu_admit_date_covid icu_or_death_covid_date %td
{txt}
{com}. 
. 
. /* CENSORING */
. /* SET FU DATES===============================================================*/ 
. * Censoring dates for each outcome (largely, last date outcome data available, minus a lag window based on previous graphs)
. *death
. tw histogram died_ons_date, discrete width(2) frequency ytitle(Number of ONS deaths) xtitle(Date) scheme(meta) saving(out_death_freq, replace)
{res}{txt}(note: file out_death_freq.gph not found)
{res}{txt}(file out_death_freq.gph saved)

{com}. graph export "output/figures/out_death_freq.pdf", as(pdf) replace
{txt}(file output/figures/out_death_freq.pdf written in PDF format)

{com}. graph close
{txt}
{com}. /* erase out_death_freq.pdf
> summ died_ons_date, format */
. *gen onscoviddeathcensor_date = r(max)-7
. 
. /*Tables=====================================================================================*/
. *Table 1a - 
. table1_mc, by(imid) total(before) onecol iqrmiddle(",") saving("$projectdir/output/data/tables.csv", cell(A1) sheetmodify keepcellfmt) ///
>         vars(agegroup cat %5.1f \ ///
>                  male bin %5.1f \ ///
>                  bmicat cat %5.1f \ ///
>                  obese4cat cat %5.1f \ ///
>                  ethnicity cat %5.1f \ ///
>                  imd cat %5.1f \ ///
>                  smoke cat %5.1f \ ///
>                  chronic_cardiac_disease bin %5.1f \ /// 
>                  stroke bin %5.1f \ ///
>                  combined_cv_comorbid bin %5.1f \ ///
>                  hypertension bin %5.1f \ ///
>                  diabcat cat %5.1f \ ///
>                  ckd_egfr cat %5.1f \ ///
>                  esrf bin %5.1f \ ///
>                  gp_consult_count contn %5.1f \ ///
>                  steroidcat bin %5.1f \ ///
>                  oral_prednisolone_3m_0m contn %5.1f )
{res}{txt}
  {c TLC}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c TRC}
  {c |} {res}factor                       N_T     N_0      N_1      m_T     m_0      m_1 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of age             39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}male                      39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}bmicat                     2,041     340    1,701   37,313   6,295   31,018 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of bmicat          39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}ethnicity                 29,491   4,940   24,551    9,863   1,695    8,168 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}imd                       39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}smoke                      3,520     572    2,948   35,834   6,063   29,771 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}chronic_cardiac_disease   39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}stroke                    39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}combined_cv_comorbid      14,180   2,345   11,835   25,174   4,290   20,884 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}hypertension              39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}diabcat                   39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of egfr_cat_all    27,472   4,628   22,844   11,882   2,007    9,875 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}esrf                      39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}gp_consult_count          39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}steroidcat                39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}oral_prednisolone_3m_0m   39,354   6,635   32,719        0       0        0 {txt}{c |}
  {c BLC}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c BRC}
   N_ ... #records used below,   m_ ... #records not used
 
  {c TLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c TRC}
  {c |} {res}                                Total             Gen Pop          IMID              p-value {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}                                N=39,354          N=6,635          N=32,719                  {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of age                                                                         0.92   {txt}{c |}
  {c |} {res}   18-<40                       14,379 (36.5%)    2,446 (36.9%)    11,933 (36.5%)            {txt}{c |}
  {c |} {res}   40-<50                       6,427 (16.3%)     1,075 (16.2%)    5,352 (16.4%)             {txt}{c |}
  {c |} {res}   50-<60                       6,712 (17.1%)     1,134 (17.1%)    5,578 (17.0%)             {txt}{c |}
  {c |} {res}   60-<70                       5,298 (13.5%)     872 (13.1%)      4,426 (13.5%)             {txt}{c |}
  {c |} {res}   70-<80                       4,049 (10.3%)     676 (10.2%)      3,373 (10.3%)             {txt}{c |}
  {c |} {res}   80+                          2,489 ( 6.3%)     432 ( 6.5%)      2,057 ( 6.3%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}male                            19,331 (49.1%)    3,261 (49.1%)    16,070 (49.1%)     0.96   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}bmicat                                                                                0.62   {txt}{c |}
  {c |} {res}   Underweight (<18.5)          87 ( 4.3%)        13 ( 3.8%)       74 ( 4.4%)                {txt}{c |}
  {c |} {res}   Normal (18.5-24.9)           226 (11.1%)       34 (10.0%)       192 (11.3%)               {txt}{c |}
  {c |} {res}   Overweight (25-29.9)         320 (15.7%)       46 (13.5%)       274 (16.1%)               {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 (19.6%)       70 (20.6%)       330 (19.4%)               {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 (18.6%)       72 (21.2%)       307 (18.0%)               {txt}{c |}
  {c |} {res}   Obese III (40+)              629 (30.8%)       105 (30.9%)      524 (30.8%)               {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of bmicat                                                                      0.71   {txt}{c |}
  {c |} {res}   No record of obesity         37,946 (96.4%)    6,388 (96.3%)    31,558 (96.5%)            {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 ( 1.0%)       70 ( 1.1%)       330 ( 1.0%)               {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 ( 1.0%)       72 ( 1.1%)       307 ( 0.9%)               {txt}{c |}
  {c |} {res}   Obese III (40+)              629 ( 1.6%)       105 ( 1.6%)      524 ( 1.6%)               {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}ethnicity                                                                             0.92   {txt}{c |}
  {c |} {res}   White                        23,666 (80.2%)    3,963 (80.2%)    19,703 (80.3%)            {txt}{c |}
  {c |} {res}   South Asian                  2,912 ( 9.9%)     494 (10.0%)      2,418 ( 9.8%)             {txt}{c |}
  {c |} {res}   Other                        2,913 ( 9.9%)     483 ( 9.8%)      2,430 ( 9.9%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}imd                                                                                   0.73   {txt}{c |}
  {c |} {res}   1 least deprived             27,603 (70.1%)    4,667 (70.3%)    22,936 (70.1%)            {txt}{c |}
  {c |} {res}   4                            7,856 (20.0%)     1,329 (20.0%)    6,527 (19.9%)             {txt}{c |}
  {c |} {res}   5 most deprived              3,895 ( 9.9%)     639 ( 9.6%)      3,256 (10.0%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}smoke                                                                                 0.52   {txt}{c |}
  {c |} {res}   Never                        816 (23.2%)       123 (21.5%)      693 (23.5%)               {txt}{c |}
  {c |} {res}   Former                       375 (10.7%)       59 (10.3%)       316 (10.7%)               {txt}{c |}
  {c |} {res}   Current                      2,329 (66.2%)     390 (68.2%)      1,939 (65.8%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}chronic_cardiac_disease         7,884 (20.0%)     1,303 (19.6%)    6,581 (20.1%)      0.38   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}stroke                          7,896 (20.1%)     1,347 (20.3%)    6,549 (20.0%)      0.60   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}combined_cv_comorbid            14,180 (100.0%)   2,345 (100.0%)   11,835 (100.0%)           {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}hypertension                    7,844 (19.9%)     1,302 (19.6%)    6,542 (20.0%)      0.49   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}diabcat                                                                               0.90   {txt}{c |}
  {c |} {res}   No diabetes                  31,485 (80.0%)    5,310 (80.0%)    26,175 (80.0%)            {txt}{c |}
  {c |} {res}   Controlled diabetes          119 ( 0.3%)       21 ( 0.3%)       98 ( 0.3%)                {txt}{c |}
  {c |} {res}   Uncontrolled diabetes        19 ( 0.0%)        2 ( 0.0%)        17 ( 0.1%)                {txt}{c |}
  {c |} {res}   Diabetes, no hba1c measure   7,731 (19.6%)     1,302 (19.6%)    6,429 (19.6%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of egfr_cat_all                                                                0.20   {txt}{c |}
  {c |} {res}   0                            6,105 (22.2%)     1,039 (22.5%)    5,066 (22.2%)             {txt}{c |}
  {c |} {res}   2                            2,173 ( 7.9%)     375 ( 8.1%)      1,798 ( 7.9%)             {txt}{c |}
  {c |} {res}   3                            4,008 (14.6%)     695 (15.0%)      3,313 (14.5%)             {txt}{c |}
  {c |} {res}   4                            8,756 (31.9%)     1,499 (32.4%)    7,257 (31.8%)             {txt}{c |}
  {c |} {res}   5                            6,430 (23.4%)     1,020 (22.0%)    5,410 (23.7%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}esrf                            3,909 ( 9.9%)     658 ( 9.9%)      3,251 ( 9.9%)      0.96   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}gp_consult_count                2.5 (2.3)         2.5 (2.3)        2.5 (2.3)          0.93   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}steroidcat                      3,330 ( 8.5%)     570 ( 8.6%)      2,760 ( 8.4%)      0.68   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}oral_prednisolone_3m_0m         0.3 (1.0)         0.3 (1.0)        0.3 (1.0)          0.52   {txt}{c |}
  {c BLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 17}{c -}{hline 9}{c BRC}
Data are presented as mean (SD) for continuous measures, and n (%) for categorical measures.
 
{res}{txt}file /workspace/output/data/tables.csv saved

{com}. 
. 
. *Table 1b - by imid type 
. table1_mc, by(joint) total(before) onecol iqrmiddle(",") saving("$projectdir/output/data/tables.csv", cell(A60) sheetmodify keepcellfmt) ///
>         vars(agegroup cat %5.1f \ ///
>                  male bin %5.1f \ ///
>                  bmicat cat %5.1f \ ///
>                  obese4cat cat %5.1f \ ///
>                  ethnicity cat %5.1f \ ///
>                  imd cat %5.1f \ ///
>                  smoke cat %5.1f \ ///
>                  chronic_cardiac_disease bin %5.1f \ /// 
>                  stroke bin %5.1f \ ///
>                  combined_cv_comorbid bin %5.1f \ ///
>                  hypertension bin %5.1f \ ///
>                  diabcat cat %5.1f \ ///
>                  ckd_egfr cat %5.1f \ ///
>                  esrf bin %5.1f \ ///
>                  gp_consult_count contn %5.1f \ ///
>                  steroidcat bin %5.1f \ ///
>                  oral_prednisolone_3m_0m contn %5.1f \ ///
>                  standtnf bin %5.1f \ ///
>                  standil6 bin %5.1f \ ///
>                  standritux bin %5.1f \ ///
>                  standil17 bin %5.1f \ ///
>                  standjaki bin %5.1f )
{res}{txt}
  {c TLC}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c TRC}
  {c |} {res}factor                       N_T      N_0      N_1      m_T      m_0      m_1 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of age             39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}male                      39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}bmicat                     2,041    1,060      981   37,313   19,136   18,177 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of bmicat          39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}ethnicity                 29,491   15,147   14,344    9,863    5,049    4,814 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}imd                       39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}smoke                      3,520    1,774    1,746   35,834   18,422   17,412 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}chronic_cardiac_disease   39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}stroke                    39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}combined_cv_comorbid      14,180    7,283    6,897   25,174   12,913   12,261 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}hypertension              39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}diabcat                   39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of egfr_cat_all    27,472   14,079   13,393   11,882    6,117    5,765 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}esrf                      39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}gp_consult_count          39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}steroidcat                39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}oral_prednisolone_3m_0m   39,354   20,196   19,158        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standtnf                  30,417   12,665   17,752    8,937    7,531    1,406 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standil6                  26,599   10,905   15,694   12,755    9,291    3,464 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standritux                26,513   10,905   15,608   12,841    9,291    3,550 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standil17                 27,829   11,240   16,589   11,525    8,956    2,569 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standjaki                 28,402   11,840   16,562   10,952    8,356    2,596 {txt}{c |}
  {c BLC}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c BRC}
   N_ ... #records used below,   m_ ... #records not used
 
  {c TLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c TRC}
  {c |} {res}                                Total             Gen Pop          Joint            p-value {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}                                N=39,354          N=20,196         N=19,158                 {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of age                                                                        0.43   {txt}{c |}
  {c |} {res}   18-<40                       14,379 (36.5%)    7,455 (36.9%)    6,924 (36.1%)            {txt}{c |}
  {c |} {res}   40-<50                       6,427 (16.3%)     3,298 (16.3%)    3,129 (16.3%)            {txt}{c |}
  {c |} {res}   50-<60                       6,712 (17.1%)     3,434 (17.0%)    3,278 (17.1%)            {txt}{c |}
  {c |} {res}   60-<70                       5,298 (13.5%)     2,683 (13.3%)    2,615 (13.6%)            {txt}{c |}
  {c |} {res}   70-<80                       4,049 (10.3%)     2,034 (10.1%)    2,015 (10.5%)            {txt}{c |}
  {c |} {res}   80+                          2,489 ( 6.3%)     1,292 ( 6.4%)    1,197 ( 6.2%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}male                            19,331 (49.1%)    9,904 (49.0%)    9,427 (49.2%)     0.74   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}bmicat                                                                               0.88   {txt}{c |}
  {c |} {res}   Underweight (<18.5)          87 ( 4.3%)        50 ( 4.7%)       37 ( 3.8%)               {txt}{c |}
  {c |} {res}   Normal (18.5-24.9)           226 (11.1%)       113 (10.7%)      113 (11.5%)              {txt}{c |}
  {c |} {res}   Overweight (25-29.9)         320 (15.7%)       162 (15.3%)      158 (16.1%)              {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 (19.6%)       211 (19.9%)      189 (19.3%)              {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 (18.6%)       197 (18.6%)      182 (18.6%)              {txt}{c |}
  {c |} {res}   Obese III (40+)              629 (30.8%)       327 (30.8%)      302 (30.8%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of bmicat                                                                     0.91   {txt}{c |}
  {c |} {res}   No record of obesity         37,946 (96.4%)    19,461 (96.4%)   18,485 (96.5%)           {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 ( 1.0%)       211 ( 1.0%)      189 ( 1.0%)              {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 ( 1.0%)       197 ( 1.0%)      182 ( 0.9%)              {txt}{c |}
  {c |} {res}   Obese III (40+)              629 ( 1.6%)       327 ( 1.6%)      302 ( 1.6%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}ethnicity                                                                            0.43   {txt}{c |}
  {c |} {res}   White                        23,666 (80.2%)    12,131 (80.1%)   11,535 (80.4%)           {txt}{c |}
  {c |} {res}   South Asian                  2,912 ( 9.9%)     1,487 ( 9.8%)    1,425 ( 9.9%)            {txt}{c |}
  {c |} {res}   Other                        2,913 ( 9.9%)     1,529 (10.1%)    1,384 ( 9.6%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}imd                                                                                  0.97   {txt}{c |}
  {c |} {res}   1 least deprived             27,603 (70.1%)    14,157 (70.1%)   13,446 (70.2%)           {txt}{c |}
  {c |} {res}   4                            7,856 (20.0%)     4,034 (20.0%)    3,822 (19.9%)            {txt}{c |}
  {c |} {res}   5 most deprived              3,895 ( 9.9%)     2,005 ( 9.9%)    1,890 ( 9.9%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}smoke                                                                                0.91   {txt}{c |}
  {c |} {res}   Never                        816 (23.2%)       413 (23.3%)      403 (23.1%)              {txt}{c |}
  {c |} {res}   Former                       375 (10.7%)       185 (10.4%)      190 (10.9%)              {txt}{c |}
  {c |} {res}   Current                      2,329 (66.2%)     1,176 (66.3%)    1,153 (66.0%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}chronic_cardiac_disease         7,884 (20.0%)     4,053 (20.1%)    3,831 (20.0%)     0.86   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}stroke                          7,896 (20.1%)     4,074 (20.2%)    3,822 (19.9%)     0.58   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}combined_cv_comorbid            14,180 (100.0%)   7,283 (100.0%)   6,897 (100.0%)           {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}hypertension                    7,844 (19.9%)     4,022 (19.9%)    3,822 (19.9%)     0.93   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}diabcat                                                                              0.37   {txt}{c |}
  {c |} {res}   No diabetes                  31,485 (80.0%)    16,096 (79.7%)   15,389 (80.3%)           {txt}{c |}
  {c |} {res}   Controlled diabetes          119 ( 0.3%)       58 ( 0.3%)       61 ( 0.3%)               {txt}{c |}
  {c |} {res}   Uncontrolled diabetes        19 ( 0.0%)        9 ( 0.0%)        10 ( 0.1%)               {txt}{c |}
  {c |} {res}   Diabetes, no hba1c measure   7,731 (19.6%)     4,033 (20.0%)    3,698 (19.3%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of egfr_cat_all                                                               0.14   {txt}{c |}
  {c |} {res}   0                            6,105 (22.2%)     3,170 (22.5%)    2,935 (21.9%)            {txt}{c |}
  {c |} {res}   2                            2,173 ( 7.9%)     1,147 ( 8.1%)    1,026 ( 7.7%)            {txt}{c |}
  {c |} {res}   3                            4,008 (14.6%)     2,071 (14.7%)    1,937 (14.5%)            {txt}{c |}
  {c |} {res}   4                            8,756 (31.9%)     4,468 (31.7%)    4,288 (32.0%)            {txt}{c |}
  {c |} {res}   5                            6,430 (23.4%)     3,223 (22.9%)    3,207 (23.9%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}esrf                            3,909 ( 9.9%)     2,026 (10.0%)    1,883 ( 9.8%)     0.50   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}gp_consult_count                2.5 (2.3)         2.5 (2.3)        2.5 (2.3)         0.22   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}steroidcat                      3,330 ( 8.5%)     1,739 ( 8.6%)    1,591 ( 8.3%)     0.28   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}oral_prednisolone_3m_0m         0.3 (1.0)         0.3 (1.0)        0.3 (1.0)         0.78   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standtnf                        21,333 (70.1%)    8,841 (69.8%)    12,492 (70.4%)    0.29   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standil6                        2,118 ( 8.0%)     0 ( 0.0%)        2,118 (13.5%)    <0.001  {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standritux                      1,725 ( 6.5%)     0 ( 0.0%)        1,725 (11.1%)    <0.001  {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standil17                       8,205 (29.5%)     1,724 (15.3%)    6,481 (39.1%)    <0.001  {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standjaki                       11,275 (39.7%)    4,725 (39.9%)    6,550 (39.5%)     0.54   {txt}{c |}
  {c BLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c BRC}
Data are presented as mean (SD) for continuous measures, and n (%) for categorical measures.
 
{res}{txt}file /workspace/output/data/tables.csv saved

{com}.                  
. table1_mc, by(skin) total(before) onecol iqrmiddle(",") saving("$projectdir/output/data/tables.csv", cell(A120) sheetmodify keepcellfmt) ///
>         vars(agegroup cat %5.1f \ ///
>                  male bin %5.1f \ ///
>                  bmicat cat %5.1f \ ///
>                  obese4cat cat %5.1f \ ///
>                  ethnicity cat %5.1f \ ///
>                  imd cat %5.1f \ ///
>                  smoke cat %5.1f \ ///
>                  chronic_cardiac_disease bin %5.1f \ /// 
>                  stroke bin %5.1f \ ///
>                  combined_cv_comorbid bin %5.1f \ ///
>                  hypertension bin %5.1f \ ///
>                  diabcat cat %5.1f \ ///
>                  ckd_egfr cat %5.1f \ ///
>                  esrf bin %5.1f \ ///
>                  gp_consult_count contn %5.1f \ ///
>                  steroidcat bin %5.1f \ ///
>                  oral_prednisolone_3m_0m contn %5.1f \ ///
>                  standtnf bin %5.1f \ ///
>                  standil23 bin %5.1f \ ///
>                  standil17 bin %5.1f )
{res}{txt}
  {c TLC}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c TRC}
  {c |} {res}factor                       N_T      N_0      N_1      m_T      m_0      m_1 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of age             39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}male                      39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}bmicat                     2,041    1,264      777   37,313   23,941   13,372 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of bmicat          39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}ethnicity                 29,491   18,883   10,608    9,863    6,322    3,541 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}imd                       39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}smoke                      3,520    2,182    1,338   35,834   23,023   12,811 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}chronic_cardiac_disease   39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}stroke                    39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}combined_cv_comorbid      14,180    9,118    5,062   25,174   16,087    9,087 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}hypertension              39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}diabcat                   39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of egfr_cat_all    27,472   17,657    9,815   11,882    7,548    4,334 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}esrf                      39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}gp_consult_count          39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}steroidcat                39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}oral_prednisolone_3m_0m   39,354   25,205   14,149        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standtnf                  30,417   17,232   13,185    8,937    7,973      964 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standil23                 29,902   16,968   12,934    9,452    8,237    1,215 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standil17                 27,829   15,585   12,244   11,525    9,620    1,905 {txt}{c |}
  {c BLC}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c BRC}
   N_ ... #records used below,   m_ ... #records not used
 
  {c TLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c TRC}
  {c |} {res}                                Total             Gen Pop          Skin             p-value {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}                                N=39,354          N=25,205         N=14,149                 {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of age                                                                        0.68   {txt}{c |}
  {c |} {res}   18-<40                       14,379 (36.5%)    9,218 (36.6%)    5,161 (36.5%)            {txt}{c |}
  {c |} {res}   40-<50                       6,427 (16.3%)     4,148 (16.5%)    2,279 (16.1%)            {txt}{c |}
  {c |} {res}   50-<60                       6,712 (17.1%)     4,260 (16.9%)    2,452 (17.3%)            {txt}{c |}
  {c |} {res}   60-<70                       5,298 (13.5%)     3,368 (13.4%)    1,930 (13.6%)            {txt}{c |}
  {c |} {res}   70-<80                       4,049 (10.3%)     2,594 (10.3%)    1,455 (10.3%)            {txt}{c |}
  {c |} {res}   80+                          2,489 ( 6.3%)     1,617 ( 6.4%)    872 ( 6.2%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}male                            19,331 (49.1%)    12,371 (49.1%)   6,960 (49.2%)     0.84   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}bmicat                                                                               0.77   {txt}{c |}
  {c |} {res}   Underweight (<18.5)          87 ( 4.3%)        49 ( 3.9%)       38 ( 4.9%)               {txt}{c |}
  {c |} {res}   Normal (18.5-24.9)           226 (11.1%)       141 (11.2%)      85 (10.9%)               {txt}{c |}
  {c |} {res}   Overweight (25-29.9)         320 (15.7%)       199 (15.7%)      121 (15.6%)              {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 (19.6%)       258 (20.4%)      142 (18.3%)              {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 (18.6%)       232 (18.4%)      147 (18.9%)              {txt}{c |}
  {c |} {res}   Obese III (40+)              629 (30.8%)       385 (30.5%)      244 (31.4%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of bmicat                                                                     0.30   {txt}{c |}
  {c |} {res}   No record of obesity         37,946 (96.4%)    24,330 (96.5%)   13,616 (96.2%)           {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 ( 1.0%)       258 ( 1.0%)      142 ( 1.0%)              {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 ( 1.0%)       232 ( 0.9%)      147 ( 1.0%)              {txt}{c |}
  {c |} {res}   Obese III (40+)              629 ( 1.6%)       385 ( 1.5%)      244 ( 1.7%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}ethnicity                                                                            0.63   {txt}{c |}
  {c |} {res}   White                        23,666 (80.2%)    15,177 (80.4%)   8,489 (80.0%)            {txt}{c |}
  {c |} {res}   South Asian                  2,912 ( 9.9%)     1,841 ( 9.7%)    1,071 (10.1%)            {txt}{c |}
  {c |} {res}   Other                        2,913 ( 9.9%)     1,865 ( 9.9%)    1,048 ( 9.9%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}imd                                                                                  0.90   {txt}{c |}
  {c |} {res}   1 least deprived             27,603 (70.1%)    17,692 (70.2%)   9,911 (70.0%)            {txt}{c |}
  {c |} {res}   4                            7,856 (20.0%)     5,014 (19.9%)    2,842 (20.1%)            {txt}{c |}
  {c |} {res}   5 most deprived              3,895 ( 9.9%)     2,499 ( 9.9%)    1,396 ( 9.9%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}smoke                                                                                0.89   {txt}{c |}
  {c |} {res}   Never                        816 (23.2%)       500 (22.9%)      316 (23.6%)              {txt}{c |}
  {c |} {res}   Former                       375 (10.7%)       233 (10.7%)      142 (10.6%)              {txt}{c |}
  {c |} {res}   Current                      2,329 (66.2%)     1,449 (66.4%)    880 (65.8%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}chronic_cardiac_disease         7,884 (20.0%)     5,090 (20.2%)    2,794 (19.7%)     0.29   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}stroke                          7,896 (20.1%)     5,076 (20.1%)    2,820 (19.9%)     0.62   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}combined_cv_comorbid            14,180 (100.0%)   9,118 (100.0%)   5,062 (100.0%)           {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}hypertension                    7,844 (19.9%)     5,016 (19.9%)    2,828 (20.0%)     0.84   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}diabcat                                                                              1.00   {txt}{c |}
  {c |} {res}   No diabetes                  31,485 (80.0%)    20,158 (80.0%)   11,327 (80.1%)           {txt}{c |}
  {c |} {res}   Controlled diabetes          119 ( 0.3%)       77 ( 0.3%)       42 ( 0.3%)               {txt}{c |}
  {c |} {res}   Uncontrolled diabetes        19 ( 0.0%)        12 ( 0.0%)       7 ( 0.0%)                {txt}{c |}
  {c |} {res}   Diabetes, no hba1c measure   7,731 (19.6%)     4,958 (19.7%)    2,773 (19.6%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of egfr_cat_all                                                               0.37   {txt}{c |}
  {c |} {res}   0                            6,105 (22.2%)     3,899 (22.1%)    2,206 (22.5%)            {txt}{c |}
  {c |} {res}   2                            2,173 ( 7.9%)     1,439 ( 8.1%)    734 ( 7.5%)              {txt}{c |}
  {c |} {res}   3                            4,008 (14.6%)     2,572 (14.6%)    1,436 (14.6%)            {txt}{c |}
  {c |} {res}   4                            8,756 (31.9%)     5,631 (31.9%)    3,125 (31.8%)            {txt}{c |}
  {c |} {res}   5                            6,430 (23.4%)     4,116 (23.3%)    2,314 (23.6%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}esrf                            3,909 ( 9.9%)     2,542 (10.1%)    1,367 ( 9.7%)     0.18   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}gp_consult_count                2.5 (2.3)         2.5 (2.3)        2.5 (2.3)         0.88   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}steroidcat                      3,330 ( 8.5%)     2,116 ( 8.4%)    1,214 ( 8.6%)     0.53   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}oral_prednisolone_3m_0m         0.3 (1.0)         0.3 (1.0)        0.3 (1.0)         0.80   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standtnf                        21,333 (70.1%)    12,154 (70.5%)   9,179 (69.6%)     0.084  {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standil23                       18,721 (62.6%)    10,654 (62.8%)   8,067 (62.4%)     0.46   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standil17                       8,205 (29.5%)     3,805 (24.4%)    4,400 (35.9%)    <0.001  {txt}{c |}
  {c BLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c BRC}
Data are presented as mean (SD) for continuous measures, and n (%) for categorical measures.
 
{res}{txt}file /workspace/output/data/tables.csv saved

{com}.                  
. table1_mc, by(bowel) total(before) onecol iqrmiddle(",") saving("$projectdir/output/data/tables.csv", cell(A180) sheetmodify keepcellfmt) ///
>         vars(agegroup cat %5.1f \ ///
>                  male bin %5.1f \ ///
>                  bmicat cat %5.1f \ ///
>                  obese4cat cat %5.1f \ ///
>                  ethnicity cat %5.1f \ ///
>                  imd cat %5.1f \ ///
>                  smoke cat %5.1f \ ///
>                  chronic_cardiac_disease bin %5.1f \ /// 
>                  stroke bin %5.1f \ ///
>                  combined_cv_comorbid bin %5.1f \ ///
>                  hypertension bin %5.1f \ ///
>                  diabcat cat %5.1f \ ///
>                  ckd_egfr cat %5.1f \ ///
>                  esrf bin %5.1f \ ///
>                  gp_consult_count contn %5.1f \ ///
>                  steroidcat bin %5.1f \ ///
>                  oral_prednisolone_3m_0m contn %5.1f \ ///
>                  standtnf bin %5.1f \ ///
>                  standjaki bin %5.1f )  
{res}{txt}
  {c TLC}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c TRC}
  {c |} {res}factor                       N_T      N_0      N_1      m_T      m_0      m_1 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of age             39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}male                      39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}bmicat                     2,041    1,079      962   37,313   19,136   18,177 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of bmicat          39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}ethnicity                 29,491   15,156   14,335    9,863    5,059    4,804 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}imd                       39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}smoke                      3,520    1,792    1,728   35,834   18,423   17,411 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}chronic_cardiac_disease   39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}stroke                    39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}combined_cv_comorbid      14,180    7,245    6,935   25,174   12,970   12,204 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}hypertension              39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}diabcat                   39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of egfr_cat_all    27,472   14,144   13,328   11,882    6,071    5,811 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}esrf                      39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}gp_consult_count          39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}steroidcat                39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}oral_prednisolone_3m_0m   39,354   20,215   19,139        0        0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standtnf                  30,417   12,626   17,791    8,937    7,589    1,348 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}standjaki                 28,402   11,829   16,573   10,952    8,386    2,566 {txt}{c |}
  {c BLC}{hline 25}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c BRC}
   N_ ... #records used below,   m_ ... #records not used
 
  {c TLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c TRC}
  {c |} {res}                                Total             Gen Pop          Bowel            p-value {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}                                N=39,354          N=20,215         N=19,139                 {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of age                                                                        0.40   {txt}{c |}
  {c |} {res}   18-<40                       14,379 (36.5%)    7,330 (36.3%)    7,049 (36.8%)            {txt}{c |}
  {c |} {res}   40-<50                       6,427 (16.3%)     3,309 (16.4%)    3,118 (16.3%)            {txt}{c |}
  {c |} {res}   50-<60                       6,712 (17.1%)     3,417 (16.9%)    3,295 (17.2%)            {txt}{c |}
  {c |} {res}   60-<70                       5,298 (13.5%)     2,748 (13.6%)    2,550 (13.3%)            {txt}{c |}
  {c |} {res}   70-<80                       4,049 (10.3%)     2,089 (10.3%)    1,960 (10.2%)            {txt}{c |}
  {c |} {res}   80+                          2,489 ( 6.3%)     1,322 ( 6.5%)    1,167 ( 6.1%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}male                            19,331 (49.1%)    9,890 (48.9%)    9,441 (49.3%)     0.42   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}bmicat                                                                               0.058  {txt}{c |}
  {c |} {res}   Underweight (<18.5)          87 ( 4.3%)        51 ( 4.7%)       36 ( 3.7%)               {txt}{c |}
  {c |} {res}   Normal (18.5-24.9)           226 (11.1%)       112 (10.4%)      114 (11.9%)              {txt}{c |}
  {c |} {res}   Overweight (25-29.9)         320 (15.7%)       160 (14.8%)      160 (16.6%)              {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 (19.6%)       217 (20.1%)      183 (19.0%)              {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 (18.6%)       223 (20.7%)      156 (16.2%)              {txt}{c |}
  {c |} {res}   Obese III (40+)              629 (30.8%)       316 (29.3%)      313 (32.5%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of bmicat                                                                     0.017  {txt}{c |}
  {c |} {res}   No record of obesity         37,946 (96.4%)    19,459 (96.3%)   18,487 (96.6%)           {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            400 ( 1.0%)       217 ( 1.1%)      183 ( 1.0%)              {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           379 ( 1.0%)       223 ( 1.1%)      156 ( 0.8%)              {txt}{c |}
  {c |} {res}   Obese III (40+)              629 ( 1.6%)       316 ( 1.6%)      313 ( 1.6%)              {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}ethnicity                                                                            0.52   {txt}{c |}
  {c |} {res}   White                        23,666 (80.2%)    12,150 (80.2%)   11,516 (80.3%)           {txt}{c |}
  {c |} {res}   South Asian                  2,912 ( 9.9%)     1,482 ( 9.8%)    1,430 (10.0%)            {txt}{c |}
  {c |} {res}   Other                        2,913 ( 9.9%)     1,524 (10.1%)    1,389 ( 9.7%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}imd                                                                                  0.67   {txt}{c |}
  {c |} {res}   1 least deprived             27,603 (70.1%)    14,163 (70.1%)   13,440 (70.2%)           {txt}{c |}
  {c |} {res}   4                            7,856 (20.0%)     4,025 (19.9%)    3,831 (20.0%)            {txt}{c |}
  {c |} {res}   5 most deprived              3,895 ( 9.9%)     2,027 (10.0%)    1,868 ( 9.8%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}smoke                                                                                0.63   {txt}{c |}
  {c |} {res}   Never                        816 (23.2%)       410 (22.9%)      406 (23.5%)              {txt}{c |}
  {c |} {res}   Former                       375 (10.7%)       184 (10.3%)      191 (11.1%)              {txt}{c |}
  {c |} {res}   Current                      2,329 (66.2%)     1,198 (66.9%)    1,131 (65.5%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}chronic_cardiac_disease         7,884 (20.0%)     4,052 (20.0%)    3,832 (20.0%)     0.96   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}stroke                          7,896 (20.1%)     4,017 (19.9%)    3,879 (20.3%)     0.33   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}combined_cv_comorbid            14,180 (100.0%)   7,245 (100.0%)   6,935 (100.0%)           {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}hypertension                    7,844 (19.9%)     4,073 (20.1%)    3,771 (19.7%)     0.27   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}diabcat                                                                              0.92   {txt}{c |}
  {c |} {res}   No diabetes                  31,485 (80.0%)    16,182 (80.0%)   15,303 (80.0%)           {txt}{c |}
  {c |} {res}   Controlled diabetes          119 ( 0.3%)       58 ( 0.3%)       61 ( 0.3%)               {txt}{c |}
  {c |} {res}   Uncontrolled diabetes        19 ( 0.0%)        9 ( 0.0%)        10 ( 0.1%)               {txt}{c |}
  {c |} {res}   Diabetes, no hba1c measure   7,731 (19.6%)     3,966 (19.6%)    3,765 (19.7%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of egfr_cat_all                                                               0.41   {txt}{c |}
  {c |} {res}   0                            6,105 (22.2%)     3,129 (22.1%)    2,976 (22.3%)            {txt}{c |}
  {c |} {res}   2                            2,173 ( 7.9%)     1,089 ( 7.7%)    1,084 ( 8.1%)            {txt}{c |}
  {c |} {res}   3                            4,008 (14.6%)     2,049 (14.5%)    1,959 (14.7%)            {txt}{c |}
  {c |} {res}   4                            8,756 (31.9%)     4,510 (31.9%)    4,246 (31.9%)            {txt}{c |}
  {c |} {res}   5                            6,430 (23.4%)     3,367 (23.8%)    3,063 (23.0%)            {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}esrf                            3,909 ( 9.9%)     1,978 ( 9.8%)    1,931 (10.1%)     0.31   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}gp_consult_count                2.5 (2.3)         2.5 (2.3)        2.5 (2.3)         0.28   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}steroidcat                      3,330 ( 8.5%)     1,718 ( 8.5%)    1,612 ( 8.4%)     0.79   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}oral_prednisolone_3m_0m         0.3 (1.0)         0.3 (1.0)        0.3 (1.0)         0.42   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standtnf                        21,333 (70.1%)    8,797 (69.7%)    12,536 (70.5%)    0.14   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c RT}
  {c |} {res}standjaki                       11,275 (39.7%)    4,707 (39.8%)    6,568 (39.6%)     0.78   {txt}{c |}
  {c BLC}{hline 31}{c -}{hline 17}{c -}{hline 16}{c -}{hline 16}{c -}{hline 9}{c BRC}
Data are presented as mean (SD) for continuous measures, and n (%) for categorical measures.
 
{res}{txt}file /workspace/output/data/tables.csv saved

{com}.         
. *Table 2a - high cost drugs (v non-high cost) - single group contribution only
. table1_mc, by(imiddrugcategory) total(before) onecol iqrmiddle(",") saving("$projectdir/output/data/tables.csv", cell(A240) sheetmodify keepcellfmt) ///
>         vars(agegroup cat %5.1f \ ///
>                  male bin %5.1f \ ///
>                  bmicat cat %5.1f \ ///
>                  obese4cat cat %5.1f \ ///
>                  ethnicity cat %5.1f \ ///
>                  imd cat %5.1f \ ///
>                  smoke cat %5.1f \ ///
>                  chronic_cardiac_disease bin %5.1f \ /// 
>                  stroke bin %5.1f \ ///
>                  combined_cv_comorbid bin %5.1f \ ///
>                  hypertension bin %5.1f \ ///
>                  diabcat cat %5.1f \ ///
>                  ckd_egfr cat %5.1f \ ///
>                  esrf bin %5.1f \ ///
>                  gp_consult_count contn %5.1f \ ///
>                  steroidcat bin %5.1f \ ///
>                  oral_prednisolone_3m_0m contn %5.1f )
{res}{txt}
  {c TLC}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c TRC}
  {c |} {res}factor                       N_T     N_0      N_1      m_T     m_0      m_1 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of age             32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}male                      32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}bmicat                     1,682      82    1,600   30,658   1,587   29,071 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of bmicat          32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}ethnicity                 24,257   1,252   23,005    8,083     417    7,666 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}imd                       32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}smoke                      2,914     142    2,772   29,426   1,527   27,899 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}chronic_cardiac_disease   32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}stroke                    32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}combined_cv_comorbid      11,696     596   11,100   20,644   1,073   19,571 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}hypertension              32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}diabcat                   32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}RECODE of egfr_cat_all    22,577   1,170   21,407    9,763     499    9,264 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}esrf                      32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}gp_consult_count          32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}steroidcat                32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c LT}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c RT}
  {c |} {res}oral_prednisolone_3m_0m   32,340   1,669   30,671        0       0        0 {txt}{c |}
  {c BLC}{hline 25}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c -}{hline 8}{c -}{hline 7}{c -}{hline 8}{c BRC}
   N_ ... #records used below,   m_ ... #records not used
 
  {c TLC}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c TRC}
  {c |} {res}                                Total             0               1                 p-value {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}                                N=32,340          N=1,669         N=30,671                  {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of age                                                                        0.075  {txt}{c |}
  {c |} {res}   18-<40                       11,796 (36.5%)    574 (34.4%)     11,222 (36.6%)            {txt}{c |}
  {c |} {res}   40-<50                       5,283 (16.3%)     300 (18.0%)     4,983 (16.2%)             {txt}{c |}
  {c |} {res}   50-<60                       5,516 (17.1%)     278 (16.7%)     5,238 (17.1%)             {txt}{c |}
  {c |} {res}   60-<70                       4,366 (13.5%)     252 (15.1%)     4,114 (13.4%)             {txt}{c |}
  {c |} {res}   70-<80                       3,338 (10.3%)     172 (10.3%)     3,166 (10.3%)             {txt}{c |}
  {c |} {res}   80+                          2,041 ( 6.3%)     93 ( 5.6%)      1,948 ( 6.4%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}male                            15,866 (49.1%)    825 (49.4%)     15,041 (49.0%)     0.76   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}bmicat                                                                               0.81   {txt}{c |}
  {c |} {res}   Underweight (<18.5)          74 ( 4.4%)        4 ( 4.9%)       70 ( 4.4%)                {txt}{c |}
  {c |} {res}   Normal (18.5-24.9)           191 (11.4%)       9 (11.0%)       182 (11.4%)               {txt}{c |}
  {c |} {res}   Overweight (25-29.9)         271 (16.1%)       10 (12.2%)      261 (16.3%)               {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            325 (19.3%)       18 (22.0%)      307 (19.2%)               {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           302 (18.0%)       12 (14.6%)      290 (18.1%)               {txt}{c |}
  {c |} {res}   Obese III (40+)              519 (30.9%)       29 (35.4%)      490 (30.6%)               {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of bmicat                                                                     0.76   {txt}{c |}
  {c |} {res}   No record of obesity         31,194 (96.5%)    1,610 (96.5%)   29,584 (96.5%)            {txt}{c |}
  {c |} {res}   Obese I (30-34.9)            325 ( 1.0%)       18 ( 1.1%)      307 ( 1.0%)               {txt}{c |}
  {c |} {res}   Obese II (35-39.9)           302 ( 0.9%)       12 ( 0.7%)      290 ( 0.9%)               {txt}{c |}
  {c |} {res}   Obese III (40+)              519 ( 1.6%)       29 ( 1.7%)      490 ( 1.6%)               {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}ethnicity                                                                            0.55   {txt}{c |}
  {c |} {res}   White                        19,472 (80.3%)    992 (79.2%)     18,480 (80.3%)            {txt}{c |}
  {c |} {res}   South Asian                  2,390 ( 9.9%)     134 (10.7%)     2,256 ( 9.8%)             {txt}{c |}
  {c |} {res}   Other                        2,395 ( 9.9%)     126 (10.1%)     2,269 ( 9.9%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}imd                                                                                  0.46   {txt}{c |}
  {c |} {res}   1 least deprived             22,691 (70.2%)    1,150 (68.9%)   21,541 (70.2%)            {txt}{c |}
  {c |} {res}   4                            6,445 (19.9%)     342 (20.5%)     6,103 (19.9%)             {txt}{c |}
  {c |} {res}   5 most deprived              3,204 ( 9.9%)     177 (10.6%)     3,027 ( 9.9%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}smoke                                                                                0.45   {txt}{c |}
  {c |} {res}   Never                        687 (23.6%)       37 (26.1%)      650 (23.4%)               {txt}{c |}
  {c |} {res}   Former                       311 (10.7%)       11 ( 7.7%)      300 (10.8%)               {txt}{c |}
  {c |} {res}   Current                      1,916 (65.8%)     94 (66.2%)      1,822 (65.7%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}chronic_cardiac_disease         6,505 (20.1%)     339 (20.3%)     6,166 (20.1%)      0.84   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}stroke                          6,473 (20.0%)     315 (18.9%)     6,158 (20.1%)      0.23   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}combined_cv_comorbid            11,696 (100.0%)   596 (100.0%)    11,100 (100.0%)           {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}hypertension                    6,470 (20.0%)     349 (20.9%)     6,121 (20.0%)      0.34   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}diabcat                                                                              0.63   {txt}{c |}
  {c |} {res}   No diabetes                  25,875 (80.0%)    1,334 (79.9%)   24,541 (80.0%)            {txt}{c |}
  {c |} {res}   Controlled diabetes          97 ( 0.3%)        6 ( 0.4%)       91 ( 0.3%)                {txt}{c |}
  {c |} {res}   Uncontrolled diabetes        17 ( 0.1%)        2 ( 0.1%)       15 ( 0.0%)                {txt}{c |}
  {c |} {res}   Diabetes, no hba1c measure   6,351 (19.6%)     327 (19.6%)     6,024 (19.6%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}RECODE of egfr_cat_all                                                               0.21   {txt}{c |}
  {c |} {res}   0                            5,001 (22.2%)     232 (19.8%)     4,769 (22.3%)             {txt}{c |}
  {c |} {res}   2                            1,776 ( 7.9%)     103 ( 8.8%)     1,673 ( 7.8%)             {txt}{c |}
  {c |} {res}   3                            3,272 (14.5%)     179 (15.3%)     3,093 (14.4%)             {txt}{c |}
  {c |} {res}   4                            7,184 (31.8%)     365 (31.2%)     6,819 (31.9%)             {txt}{c |}
  {c |} {res}   5                            5,344 (23.7%)     291 (24.9%)     5,053 (23.6%)             {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}esrf                            3,209 ( 9.9%)     184 (11.0%)     3,025 ( 9.9%)      0.12   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}gp_consult_count                2.5 (2.3)         2.4 (2.3)       2.5 (2.3)          0.40   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}steroidcat                      2,731 ( 8.4%)     145 ( 8.7%)     2,586 ( 8.4%)      0.71   {txt}{c |}
  {c LT}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c RT}
  {c |} {res}oral_prednisolone_3m_0m         0.3 (1.0)         0.2 (0.9)       0.3 (1.0)          0.56   {txt}{c |}
  {c BLC}{hline 31}{c -}{hline 17}{c -}{hline 15}{c -}{hline 17}{c -}{hline 9}{c BRC}
Data are presented as mean (SD) for continuous measures, and n (%) for categorical measures.
 
{res}{txt}file /workspace/output/data/tables.csv saved

{com}. 
. /*Primary objective 1========================================================================*/
. *generate censor date
. gen diecensor = mdy(10,01,2020)
{txt}
{com}. format diecensor %td
{txt}
{com}. egen stop = rmin(died_ons_date diecensor)
{txt}
{com}. 
. stset stop, id(patient_id) failure(died_ons_covid_flag_any==1) origin(time enter_date) scale(365.25) ///
>                 exit(died_ons_covid_flag_any==1 time stop)

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}died_ons_covid_flag_any == 1
{txt}obs. time interval:  {res}(stop[_n-1], stop]
{txt} exit on or before:  {res}died_ons_covid_flag_any==1 time stop
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}          0{txt}  exclusions
{hline 78}
{res}     39,354{txt}  observations remaining, representing
{res}     39,354{txt}  subjects
{res}      3,937{txt}  failures in single-failure-per-subject data
{res} 22,476.983{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}. 
. strate imid, per(1000) output(imid, replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Estimated rates (per 1000) and lower/upper bounds of 95% confidence intervals
({res}39354{txt} records included in the analysis)

  {c TLC}{hline 9}{c -}{hline 6}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c TRC}
  {c |} {res}   imid      D         Y     Rate    Lower    Upper {txt}{c |}
  {c LT}{hline 9}{c -}{hline 6}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}Gen Pop    666    3.7845   175.98   163.11   189.87 {txt}{c |}
  {c |} {res}   IMID   3271   18.6925   174.99   169.09   181.09 {txt}{c |}
  {c BLC}{hline 9}{c -}{hline 6}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c BRC}


{com}. 
. stcox imid i.agegroup male

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-41444.487
{txt}Iteration 1:   log likelihood = {res}-41441.648
{txt}Iteration 2:   log likelihood = {res}-41441.645
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-41441.645

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      39,354                  {txt}Number of obs    =  {res}    39,354
{txt}No. of failures = {res}       3,937
{txt}Time at risk    = {res} 22476.98289
                                                {txt}LR chi2({res}7{txt})       =  {res}      5.68
{txt}Log likelihood  =   {res}-41441.645                  {txt}Prob > chi2      =  {res}    0.5771

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} .9920223{col 26}{space 2}  .042173{col 37}{space 1}   -0.19{col 46}{space 3}0.851{col 54}{space 4} .9127145{col 67}{space 3} 1.078221
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .9954888{col 26}{space 2} .0469665{col 37}{space 1}   -0.10{col 46}{space 3}0.924{col 54}{space 4}  .907564{col 67}{space 3} 1.091932
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.032788{col 26}{space 2}  .047458{col 37}{space 1}    0.70{col 46}{space 3}0.483{col 54}{space 4} .9438378{col 67}{space 3} 1.130121
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .9526071{col 26}{space 2} .0490347{col 37}{space 1}   -0.94{col 46}{space 3}0.346{col 54}{space 4} .8611898{col 67}{space 3} 1.053729
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .8997246{col 26}{space 2} .0524243{col 37}{space 1}   -1.81{col 46}{space 3}0.070{col 54}{space 4} .8026247{col 67}{space 3} 1.008571
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .9899722{col 26}{space 2} .0678776{col 37}{space 1}   -0.15{col 46}{space 3}0.883{col 54}{space 4} .8654863{col 67}{space 3} 1.132363
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} .9950591{col 26}{space 2} .0317262{col 37}{space 1}   -0.16{col 46}{space 3}0.877{col 54}{space 4}   .93478{col 67}{space 3} 1.059225
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1unadj, replace
{res}{txt}(note: file output/data/primaryobjective1unadj.ster not found)
{txt}file output/data/primaryobjective1unadj.ster saved

{com}. sts graph, by(imid) xtitle("Analysis time (years)") saving(primeob1_nonadj, replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob1_nonadj.gph not found)
{res}{txt}(file primeob1_nonadj.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob1_nonadj.pdf", as(pdf) replace
{txt}(file output/figures/primeob1_nonadj.pdf written in PDF format)

{com}. sts graph, cumhaz by (imid) xtitle("Analysis time (years)") tmax(0.58)  legend(order(1 "Gen Pop" 2 "IMID")) saving(primeob1_NA, replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob1_NA.gph not found)
{res}{txt}(file primeob1_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob1_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob1_NA.pdf written in PDF format)

{com}. 
. ** Testing assumptions of proportional hazard model
. stcox imid

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-41444.487
{txt}Iteration 1:   log likelihood = {res}-41444.469
{txt}Iteration 2:   log likelihood = {res}-41444.469
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-41444.469

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      39,354                  {txt}Number of obs    =  {res}    39,354
{txt}No. of failures = {res}       3,937
{txt}Time at risk    = {res} 22476.98289
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.04
{txt}Log likelihood  =   {res}-41444.469                  {txt}Prob > chi2      =  {res}    0.8481

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} .9918832{col 26}{space 2} .0421663{col 37}{space 1}   -0.19{col 46}{space 3}0.848{col 54}{space 4}  .912588{col 67}{space 3} 1.078068
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. stptime, per (1000) by (imid)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

      {txt}imid{col 12}{c |}{col 15}person-time{col 29}failures{col 45}rate{col 52}[95% Conf. Interval]
{hline 11}{c +}{hline 59}
   Gen Pop{col 12}{c |}{col 16}{res} 3784.5065{col 29}     666{col 39} 175.98067{col 51} 163.1104{col 63} 189.8665
      {txt}IMID{col 12}{c |}{col 16}{res} 18692.476{col 29}    3271{col 39} 174.99019{col 51}  169.095{col 63}  181.091
{txt}{hline 11}{c +}{hline 59}
     total{col 12}{c |}{col 16}{res} 22476.983{col 29}    3937{col 39} 175.15696{col 51} 169.7702{col 63} 180.7146
{txt}
{com}. stphtest, log detail

{txt}      Test of proportional-hazards assumption

      Time:  {res}Log(t)
{txt}      {hline 12}{c TT}{hline 51}
                  {c |}       rho            chi2       df       Prob>chi2
      {hline 12}{c +}{hline 51}
      imid{col 19}{c |}{res}{col 25}-0.01889{col 37}     1.41{col 50}    1{col 64}0.2358
{txt}      {hline 12}{c +}{hline 51}
      global test {c |}{res}{col 37}     1.41{col 50}    1{col 64}0.2358
{txt}      {hline 12}{c BT}{hline 51}

{com}. stphtest, log plot(imid) yline(0) 
{res}{txt}
{com}. 
. *test for TVC significance
. stcox imid, tvc(imid) 

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-41444.487
{txt}Iteration 1:   log likelihood = {res}-41443.818
{txt}Iteration 2:   log likelihood = {res}-41443.814
{txt}Iteration 3:   log likelihood = {res}-41443.814
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-41443.814

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      39,354                  {txt}Number of obs    =  {res}    39,354
{txt}No. of failures = {res}       3,937
{txt}Time at risk    = {res} 22476.98289
                                                {txt}LR chi2({res}2{txt})       =  {res}      1.35
{txt}Log likelihood  =   {res}-41443.814                  {txt}Prob > chi2      =  {res}    0.5103

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2} 1.451405{col 26}{space 2} .5032425{col 37}{space 1}    1.07{col 46}{space 3}0.283{col 54}{space 4} .7356193{col 67}{space 3} 2.863676
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2} .5132039{col 26}{space 2} .3087845{col 37}{space 1}   -1.11{col 46}{space 3}0.268{col 54}{space 4} .1578116{col 67}{space 3} 1.668941
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective1TVCtest, replace 
{res}{txt}(note: file output/data/primaryobjective1TVCtest.ster not found)
{txt}file output/data/primaryobjective1TVCtest.ster saved

{com}. 
. stcox imid i.agegroup male

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-41444.487
{txt}Iteration 1:   log likelihood = {res}-41441.648
{txt}Iteration 2:   log likelihood = {res}-41441.645
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-41441.645

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      39,354                  {txt}Number of obs    =  {res}    39,354
{txt}No. of failures = {res}       3,937
{txt}Time at risk    = {res} 22476.98289
                                                {txt}LR chi2({res}7{txt})       =  {res}      5.68
{txt}Log likelihood  =   {res}-41441.645                  {txt}Prob > chi2      =  {res}    0.5771

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} .9920223{col 26}{space 2}  .042173{col 37}{space 1}   -0.19{col 46}{space 3}0.851{col 54}{space 4} .9127145{col 67}{space 3} 1.078221
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .9954888{col 26}{space 2} .0469665{col 37}{space 1}   -0.10{col 46}{space 3}0.924{col 54}{space 4}  .907564{col 67}{space 3} 1.091932
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.032788{col 26}{space 2}  .047458{col 37}{space 1}    0.70{col 46}{space 3}0.483{col 54}{space 4} .9438378{col 67}{space 3} 1.130121
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .9526071{col 26}{space 2} .0490347{col 37}{space 1}   -0.94{col 46}{space 3}0.346{col 54}{space 4} .8611898{col 67}{space 3} 1.053729
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .8997246{col 26}{space 2} .0524243{col 37}{space 1}   -1.81{col 46}{space 3}0.070{col 54}{space 4} .8026247{col 67}{space 3} 1.008571
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .9899722{col 26}{space 2} .0678776{col 37}{space 1}   -0.15{col 46}{space 3}0.883{col 54}{space 4} .8654863{col 67}{space 3} 1.132363
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} .9950591{col 26}{space 2} .0317262{col 37}{space 1}   -0.16{col 46}{space 3}0.877{col 54}{space 4}   .93478{col 67}{space 3} 1.059225
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1limitedadjusted, replace
{res}{txt}(note: file output/data/primaryobjective1limitedadjusted.ster not found)
{txt}file output/data/primaryobjective1limitedadjusted.ster saved

{com}. 
. stcox imid i.agegroup male i.ethnicity2 i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1111.3218
{txt}Iteration 1:   log likelihood = {res}-1100.0269
{txt}Iteration 2:   log likelihood = {res}-1099.6258
{txt}Iteration 3:   log likelihood = {res}-1099.5726
{txt}Iteration 4:   log likelihood = {res}-1099.5533
{txt}Iteration 5:   log likelihood = {res}-1099.5462
{txt}Iteration 6:   log likelihood = {res}-1099.5436
{txt}Iteration 7:   log likelihood = {res}-1099.5426
{txt}Iteration 8:   log likelihood = {res}-1099.5423
{txt}Iteration 9:   log likelihood = {res}-1099.5421
{txt}Iteration 10:  log likelihood = {res}-1099.5421
{txt}Iteration 11:  log likelihood = {res}-1099.5421
{txt}Iteration 12:  log likelihood = {res}-1099.5421
{txt}Iteration 13:  log likelihood = {res}-1099.5421
{txt}Iteration 14:  log likelihood = {res}-1099.5421
{txt}Iteration 15:  log likelihood = {res}-1099.5421
{txt}Iteration 16:  log likelihood = {res}-1099.5421
{txt}Iteration 17:  log likelihood = {res}-1099.5421
{txt}Iteration 18:  log likelihood = {res}-1099.5421
{txt}Iteration 19:  log likelihood = {res}-1099.5421
{txt}Iteration 20:  log likelihood = {res}-1099.5421
{txt}Iteration 21:  log likelihood = {res}-1099.5421
{txt}Iteration 22:  log likelihood = {res}-1099.5421
{txt}Iteration 23:  log likelihood = {res}-1099.5421
{txt}Iteration 24:  log likelihood = {res}-1099.5421
{txt}Iteration 25:  log likelihood = {res}-1099.5421
{txt}Iteration 26:  log likelihood = {res}-1099.5421
{txt}Iteration 27:  log likelihood = {res}-1099.5421
{txt}Iteration 28:  log likelihood = {res}-1099.5421
{txt}Iteration 29:  log likelihood = {res}-1099.5421
{txt}Iteration 30:  log likelihood = {res}-1099.5421
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1099.5421
{txt}Iteration 1:   log likelihood = {res}-1099.5421

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,509                  {txt}Number of obs    =  {res}     1,509
{txt}No. of failures = {res}         153
{txt}Time at risk    = {res} 862.1163587
                                                {txt}LR chi2({res}22{txt})      =  {res}     23.56
{txt}Log likelihood  =   {res}-1099.5421                  {txt}Prob > chi2      =  {res}    0.3707

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} .8642154{col 26}{space 2} .2640041{col 37}{space 1}   -0.48{col 46}{space 3}0.633{col 54}{space 4} .4748904{col 67}{space 3} 1.572717
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .8753715{col 26}{space 2} .2148044{col 37}{space 1}   -0.54{col 46}{space 3}0.588{col 54}{space 4} .5411517{col 67}{space 3} 1.416008
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.128033{col 26}{space 2}  .254071{col 37}{space 1}    0.53{col 46}{space 3}0.593{col 54}{space 4} .7254417{col 67}{space 3} 1.754046
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.047567{col 26}{space 2}  .261753{col 37}{space 1}    0.19{col 46}{space 3}0.852{col 54}{space 4} .6419393{col 67}{space 3} 1.709501
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .4921155{col 26}{space 2} .1643894{col 37}{space 1}   -2.12{col 46}{space 3}0.034{col 54}{space 4} .2556973{col 67}{space 3} .9471262
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .6938292{col 26}{space 2} .2519751{col 37}{space 1}   -1.01{col 46}{space 3}0.314{col 54}{space 4} .3405063{col 67}{space 3} 1.413774
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.333848{col 26}{space 2} .2184367{col 37}{space 1}    1.76{col 46}{space 3}0.079{col 54}{space 4} .9676313{col 67}{space 3} 1.838666
{txt}{space 12} {c |}
{space 2}ethnicity2 {c |}
{space 10}2  {c |}{col 14}{res}{space 2} 1.088266{col 26}{space 2} .2990662{col 37}{space 1}    0.31{col 46}{space 3}0.758{col 54}{space 4} .6350623{col 67}{space 3} 1.864892
{txt}{space 10}5  {c |}{col 14}{res}{space 2} .8701882{col 26}{space 2} .2472157{col 37}{space 1}   -0.49{col 46}{space 3}0.625{col 54}{space 4} .4986451{col 67}{space 3}  1.51857
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .8453121{col 26}{space 2} .1859713{col 37}{space 1}   -0.76{col 46}{space 3}0.445{col 54}{space 4} .5492248{col 67}{space 3}  1.30102
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.630042{col 26}{space 2} .3719303{col 37}{space 1}    2.14{col 46}{space 3}0.032{col 54}{space 4} 1.042266{col 67}{space 3} 2.549291
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9280361{col 26}{space 2} .0491985{col 37}{space 1}   -1.41{col 46}{space 3}0.159{col 54}{space 4} .8364493{col 67}{space 3} 1.029651
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.028411{col 26}{space 2} .1990112{col 37}{space 1}    0.14{col 46}{space 3}0.885{col 54}{space 4} .7037981{col 67}{space 3} 1.502746
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8902935{col 26}{space 2} .1696424{col 37}{space 1}   -0.61{col 46}{space 3}0.542{col 54}{space 4} .6128294{col 67}{space 3} 1.293382
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.077786{col 26}{space 2} .2112573{col 37}{space 1}    0.38{col 46}{space 3}0.702{col 54}{space 4} .7339864{col 67}{space 3} 1.582621
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8440338{col 26}{space 2} .1804991{col 37}{space 1}   -0.79{col 46}{space 3}0.428{col 54}{space 4} .5550447{col 67}{space 3} 1.283488
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .7613985{col 26}{space 2} .1673865{col 37}{space 1}   -1.24{col 46}{space 3}0.215{col 54}{space 4} .4948608{col 67}{space 3} 1.171496
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.132518{col 26}{space 2} .1846781{col 37}{space 1}    0.76{col 46}{space 3}0.445{col 54}{space 4} .8226989{col 67}{space 3} 1.559012
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 4.30e-14{col 26}{space 2} 3.60e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 3.34e-14{col 26}{space 2} 4.03e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2}  .970972{col 26}{space 2}  .210179{col 37}{space 1}   -0.14{col 46}{space 3}0.892{col 54}{space 4} .6352629{col 67}{space 3} 1.484089
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.082528{col 26}{space 2} .2974695{col 37}{space 1}    0.29{col 46}{space 3}0.773{col 54}{space 4} .6317368{col 67}{space 3} 1.854992
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1adjusted_completecaseethnicity, replace
{res}{txt}(note: file output/data/primaryobjective1adjusted_completecaseethnicity.ster not found)
{txt}file output/data/primaryobjective1adjusted_completecaseethnicity.ster saved

{com}. 
. stcox imid i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer stroke i.diabcat steroidcat

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1111.3218
{txt}Iteration 1:   log likelihood = {res}-1100.0269
{txt}Iteration 2:   log likelihood = {res}-1099.6258
{txt}Iteration 3:   log likelihood = {res}-1099.5726
{txt}Iteration 4:   log likelihood = {res}-1099.5533
{txt}Iteration 5:   log likelihood = {res}-1099.5462
{txt}Iteration 6:   log likelihood = {res}-1099.5436
{txt}Iteration 7:   log likelihood = {res}-1099.5426
{txt}Iteration 8:   log likelihood = {res}-1099.5423
{txt}Iteration 9:   log likelihood = {res}-1099.5421
{txt}Iteration 10:  log likelihood = {res}-1099.5421
{txt}Iteration 11:  log likelihood = {res}-1099.5421
{txt}Iteration 12:  log likelihood = {res}-1099.5421
{txt}Iteration 13:  log likelihood = {res}-1099.5421
{txt}Iteration 14:  log likelihood = {res}-1099.5421
{txt}Iteration 15:  log likelihood = {res}-1099.5421
{txt}Iteration 16:  log likelihood = {res}-1099.5421
{txt}Iteration 17:  log likelihood = {res}-1099.5421
{txt}Iteration 18:  log likelihood = {res}-1099.5421
{txt}Iteration 19:  log likelihood = {res}-1099.5421
{txt}Iteration 20:  log likelihood = {res}-1099.5421
{txt}Iteration 21:  log likelihood = {res}-1099.5421
{txt}Iteration 22:  log likelihood = {res}-1099.5421
{txt}Iteration 23:  log likelihood = {res}-1099.5421
{txt}Iteration 24:  log likelihood = {res}-1099.5421
{txt}Iteration 25:  log likelihood = {res}-1099.5421
{txt}Iteration 26:  log likelihood = {res}-1099.5421
{txt}Iteration 27:  log likelihood = {res}-1099.5421
{txt}Iteration 28:  log likelihood = {res}-1099.5421
{txt}Iteration 29:  log likelihood = {res}-1099.5421
{txt}Iteration 30:  log likelihood = {res}-1099.5421
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1099.5421
{txt}Iteration 1:   log likelihood = {res}-1099.5421

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,509                  {txt}Number of obs    =  {res}     1,509
{txt}No. of failures = {res}         153
{txt}Time at risk    = {res} 862.1163587
                                                {txt}LR chi2({res}22{txt})      =  {res}     23.56
{txt}Log likelihood  =   {res}-1099.5421                  {txt}Prob > chi2      =  {res}    0.3707

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} .8642154{col 26}{space 2} .2640041{col 37}{space 1}   -0.48{col 46}{space 3}0.633{col 54}{space 4} .4748904{col 67}{space 3} 1.572717
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .8753715{col 26}{space 2} .2148044{col 37}{space 1}   -0.54{col 46}{space 3}0.588{col 54}{space 4} .5411517{col 67}{space 3} 1.416008
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.128033{col 26}{space 2}  .254071{col 37}{space 1}    0.53{col 46}{space 3}0.593{col 54}{space 4} .7254417{col 67}{space 3} 1.754046
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.047567{col 26}{space 2}  .261753{col 37}{space 1}    0.19{col 46}{space 3}0.852{col 54}{space 4} .6419393{col 67}{space 3} 1.709501
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .4921155{col 26}{space 2} .1643894{col 37}{space 1}   -2.12{col 46}{space 3}0.034{col 54}{space 4} .2556973{col 67}{space 3} .9471262
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .6938292{col 26}{space 2} .2519751{col 37}{space 1}   -1.01{col 46}{space 3}0.314{col 54}{space 4} .3405063{col 67}{space 3} 1.413774
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.333848{col 26}{space 2} .2184367{col 37}{space 1}    1.76{col 46}{space 3}0.079{col 54}{space 4} .9676313{col 67}{space 3} 1.838666
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} 1.088266{col 26}{space 2} .2990662{col 37}{space 1}    0.31{col 46}{space 3}0.758{col 54}{space 4} .6350623{col 67}{space 3} 1.864892
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} .8701882{col 26}{space 2} .2472157{col 37}{space 1}   -0.49{col 46}{space 3}0.625{col 54}{space 4} .4986451{col 67}{space 3}  1.51857
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .8453121{col 26}{space 2} .1859713{col 37}{space 1}   -0.76{col 46}{space 3}0.445{col 54}{space 4} .5492248{col 67}{space 3}  1.30102
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.630042{col 26}{space 2} .3719303{col 37}{space 1}    2.14{col 46}{space 3}0.032{col 54}{space 4} 1.042266{col 67}{space 3} 2.549291
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9280361{col 26}{space 2} .0491985{col 37}{space 1}   -1.41{col 46}{space 3}0.159{col 54}{space 4} .8364493{col 67}{space 3} 1.029651
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.028411{col 26}{space 2} .1990112{col 37}{space 1}    0.14{col 46}{space 3}0.885{col 54}{space 4} .7037981{col 67}{space 3} 1.502746
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8902935{col 26}{space 2} .1696424{col 37}{space 1}   -0.61{col 46}{space 3}0.542{col 54}{space 4} .6128294{col 67}{space 3} 1.293382
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.077786{col 26}{space 2} .2112573{col 37}{space 1}    0.38{col 46}{space 3}0.702{col 54}{space 4} .7339864{col 67}{space 3} 1.582621
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8440338{col 26}{space 2} .1804991{col 37}{space 1}   -0.79{col 46}{space 3}0.428{col 54}{space 4} .5550447{col 67}{space 3} 1.283488
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.132518{col 26}{space 2} .1846781{col 37}{space 1}    0.76{col 46}{space 3}0.445{col 54}{space 4} .8226989{col 67}{space 3} 1.559012
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .7613985{col 26}{space 2} .1673865{col 37}{space 1}   -1.24{col 46}{space 3}0.215{col 54}{space 4} .4948608{col 67}{space 3} 1.171496
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 4.30e-14{col 26}{space 2} 3.60e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 3.34e-14{col 26}{space 2} 4.03e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2}  .970972{col 26}{space 2}  .210179{col 37}{space 1}   -0.14{col 46}{space 3}0.892{col 54}{space 4} .6352629{col 67}{space 3} 1.484089
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.082528{col 26}{space 2} .2974695{col 37}{space 1}    0.29{col 46}{space 3}0.773{col 54}{space 4} .6317368{col 67}{space 3} 1.854992
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1adjusted, replace
{res}{txt}(note: file output/data/primaryobjective1adjusted.ster not found)
{txt}file output/data/primaryobjective1adjusted.ster saved

{com}. 
. stcox imid i.agegroup male i.imd bmicat bowel skin joint  chronic_cardiac_disease cancer stroke i.diabcat steroidcat

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1512.9743
{txt}Iteration 1:   log likelihood = {res}-1503.7941
{txt}Iteration 2:   log likelihood = {res}-1503.5065
{txt}Iteration 3:   log likelihood = {res}-1503.4291
{txt}Iteration 4:   log likelihood = {res}-1503.4006
{txt}Iteration 5:   log likelihood = {res}-1503.3901
{txt}Iteration 6:   log likelihood = {res}-1503.3863
{txt}Iteration 7:   log likelihood = {res}-1503.3848
{txt}Iteration 8:   log likelihood = {res}-1503.3843
{txt}Iteration 9:   log likelihood = {res}-1503.3841
{txt}Iteration 10:  log likelihood = {res}-1503.3841
{txt}Iteration 11:  log likelihood = {res} -1503.384
{txt}Iteration 12:  log likelihood = {res} -1503.384
{txt}Iteration 13:  log likelihood = {res} -1503.384
{txt}Iteration 14:  log likelihood = {res} -1503.384
{txt}Iteration 15:  log likelihood = {res} -1503.384
{txt}Iteration 16:  log likelihood = {res} -1503.384
{txt}Iteration 17:  log likelihood = {res} -1503.384
{txt}Iteration 18:  log likelihood = {res} -1503.384
{txt}Iteration 19:  log likelihood = {res} -1503.384
{txt}Iteration 20:  log likelihood = {res} -1503.384
{txt}Iteration 21:  log likelihood = {res} -1503.384
{txt}Iteration 22:  log likelihood = {res} -1503.384
{txt}Iteration 23:  log likelihood = {res} -1503.384
{txt}Iteration 24:  log likelihood = {res} -1503.384
{txt}Iteration 25:  log likelihood = {res} -1503.384
{txt}Iteration 26:  log likelihood = {res} -1503.384
{txt}Iteration 27:  log likelihood = {res} -1503.384
{txt}Iteration 28:  log likelihood = {res} -1503.384
{txt}Iteration 29:  log likelihood = {res} -1503.384
{txt}Iteration 30:  log likelihood = {res} -1503.384
{txt}Iteration 31:  log likelihood = {res} -1503.384
{txt}Iteration 32:  log likelihood = {res} -1503.384
{txt}Iteration 33:  log likelihood = {res} -1503.384
{txt}Iteration 34:  log likelihood = {res} -1503.384
{txt}Refining estimates:
Iteration 0:   log likelihood = {res} -1503.384
{txt}Iteration 1:   log likelihood = {res} -1503.384

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       2,041                  {txt}Number of obs    =  {res}     2,041
{txt}No. of failures = {res}         200
{txt}Time at risk    = {res} 1165.891855
                                                {txt}LR chi2({res}20{txt})      =  {res}     19.18
{txt}Log likelihood  =   {res} -1503.384                  {txt}Prob > chi2      =  {res}    0.5101

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} .9726435{col 26}{space 2} .2617955{col 37}{space 1}   -0.10{col 46}{space 3}0.918{col 54}{space 4}  .573912{col 67}{space 3} 1.648398
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .8355631{col 26}{space 2} .1861124{col 37}{space 1}   -0.81{col 46}{space 3}0.420{col 54}{space 4} .5399873{col 67}{space 3}  1.29293
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.203838{col 26}{space 2} .2345573{col 37}{space 1}    0.95{col 46}{space 3}0.341{col 54}{space 4} .8217104{col 67}{space 3} 1.763669
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.058008{col 26}{space 2} .2332707{col 37}{space 1}    0.26{col 46}{space 3}0.798{col 54}{space 4} .6867759{col 67}{space 3} 1.629906
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .6971351{col 26}{space 2} .1856941{col 37}{space 1}   -1.35{col 46}{space 3}0.176{col 54}{space 4} .4136039{col 67}{space 3} 1.175031
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8096397{col 26}{space 2} .2545409{col 37}{space 1}   -0.67{col 46}{space 3}0.502{col 54}{space 4} .4372043{col 67}{space 3} 1.499337
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.287175{col 26}{space 2} .1837283{col 37}{space 1}    1.77{col 46}{space 3}0.077{col 54}{space 4} .9730593{col 67}{space 3} 1.702692
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .9059438{col 26}{space 2}  .170041{col 37}{space 1}   -0.53{col 46}{space 3}0.599{col 54}{space 4} .6270975{col 67}{space 3} 1.308782
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.428421{col 26}{space 2} .2972196{col 37}{space 1}    1.71{col 46}{space 3}0.087{col 54}{space 4} .9500398{col 67}{space 3} 2.147685
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9628146{col 26}{space 2}  .044512{col 37}{space 1}   -0.82{col 46}{space 3}0.412{col 54}{space 4} .8794085{col 67}{space 3} 1.054131
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  1.02854{col 26}{space 2} .1710261{col 37}{space 1}    0.17{col 46}{space 3}0.866{col 54}{space 4} .7424768{col 67}{space 3} 1.424818
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .9277323{col 26}{space 2} .1511158{col 37}{space 1}   -0.46{col 46}{space 3}0.645{col 54}{space 4} .6741752{col 67}{space 3} 1.276652
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.096769{col 26}{space 2}  .183884{col 37}{space 1}    0.55{col 46}{space 3}0.582{col 54}{space 4} .7895927{col 67}{space 3} 1.523448
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8921345{col 26}{space 2} .1652541{col 37}{space 1}   -0.62{col 46}{space 3}0.538{col 54}{space 4} .6205238{col 67}{space 3} 1.282632
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.142886{col 26}{space 2} .1621326{col 37}{space 1}    0.94{col 46}{space 3}0.346{col 54}{space 4} .8654649{col 67}{space 3} 1.509234
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .7476028{col 26}{space 2} .1486787{col 37}{space 1}   -1.46{col 46}{space 3}0.144{col 54}{space 4} .5062781{col 67}{space 3} 1.103958
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 6.79e-16{col 26}{space 2} 3.22e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 5.91e-16{col 26}{space 2} 5.29e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .9585739{col 26}{space 2} .1793527{col 37}{space 1}   -0.23{col 46}{space 3}0.821{col 54}{space 4} .6642976{col 67}{space 3} 1.383211
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.114888{col 26}{space 2} .2648618{col 37}{space 1}    0.46{col 46}{space 3}0.647{col 54}{space 4} .6998628{col 67}{space 3} 1.776027
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1adjusted_noethnicity, replace
{res}{txt}(note: file output/data/primaryobjective1adjusted_noethnicity.ster not found)
{txt}file output/data/primaryobjective1adjusted_noethnicity.ster saved

{com}. 
. *TVC analyses
. 
. stcox imid i.agegroup male i.ethnicity2 i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat, tvc(imid) 

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1111.3218
{txt}Iteration 1:   log likelihood = {res}-1099.9797
{txt}Iteration 2:   log likelihood = {res}-1099.5789
{txt}Iteration 3:   log likelihood = {res}-1099.5257
{txt}Iteration 4:   log likelihood = {res}-1099.5064
{txt}Iteration 5:   log likelihood = {res}-1099.4993
{txt}Iteration 6:   log likelihood = {res}-1099.4967
{txt}Iteration 7:   log likelihood = {res}-1099.4957
{txt}Iteration 8:   log likelihood = {res}-1099.4954
{txt}Iteration 9:   log likelihood = {res}-1099.4952
{txt}Iteration 10:  log likelihood = {res}-1099.4952
{txt}Iteration 11:  log likelihood = {res}-1099.4952
{txt}Iteration 12:  log likelihood = {res}-1099.4952
{txt}Iteration 13:  log likelihood = {res}-1099.4952
{txt}Iteration 14:  log likelihood = {res}-1099.4952
{txt}Iteration 15:  log likelihood = {res}-1099.4952
{txt}Iteration 16:  log likelihood = {res}-1099.4952
{txt}Iteration 17:  log likelihood = {res}-1099.4952
{txt}Iteration 18:  log likelihood = {res}-1099.4952
{txt}Iteration 19:  log likelihood = {res}-1099.4952
{txt}Iteration 20:  log likelihood = {res}-1099.4952
{txt}Iteration 21:  log likelihood = {res}-1099.4952
{txt}Iteration 22:  log likelihood = {res}-1099.4952
{txt}Iteration 23:  log likelihood = {res}-1099.4952
{txt}Iteration 24:  log likelihood = {res}-1099.4952
{txt}Iteration 25:  log likelihood = {res}-1099.4952
{txt}Iteration 26:  log likelihood = {res}-1099.4952
{txt}Iteration 27:  log likelihood = {res}-1099.4952
{txt}Iteration 28:  log likelihood = {res}-1099.4952
{txt}Iteration 29:  log likelihood = {res}-1099.4952
{txt}Iteration 30:  log likelihood = {res}-1099.4952
{txt}Iteration 31:  log likelihood = {res}-1099.4952
{txt}Iteration 32:  log likelihood = {res}-1099.4952
{txt}Iteration 33:  log likelihood = {res}-1099.4952
{txt}Iteration 34:  log likelihood = {res}-1099.4952
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1099.4952
{txt}Iteration 1:   log likelihood = {res}-1099.4952

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,509                  {txt}Number of obs    =  {res}     1,509
{txt}No. of failures = {res}         153
{txt}Time at risk    = {res} 862.1163587
                                                {txt}LR chi2({res}23{txt})      =  {res}     23.65
{txt}Log likelihood  =   {res}-1099.4952                  {txt}Prob > chi2      =  {res}    0.4232

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2}   1.3909{col 26}{space 2} 2.284024{col 37}{space 1}    0.20{col 46}{space 3}0.841{col 54}{space 4} .0556572{col 67}{space 3} 34.75925
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .8753574{col 26}{space 2} .2148008{col 37}{space 1}   -0.54{col 46}{space 3}0.587{col 54}{space 4} .5411431{col 67}{space 3} 1.415985
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.128058{col 26}{space 2} .2540762{col 37}{space 1}    0.53{col 46}{space 3}0.593{col 54}{space 4} .7254586{col 67}{space 3} 1.754084
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.047561{col 26}{space 2} .2617509{col 37}{space 1}    0.19{col 46}{space 3}0.852{col 54}{space 4} .6419369{col 67}{space 3}  1.70949
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .4921174{col 26}{space 2} .1643905{col 37}{space 1}   -2.12{col 46}{space 3}0.034{col 54}{space 4} .2556979{col 67}{space 3} .9471316
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .6938914{col 26}{space 2} .2519976{col 37}{space 1}   -1.01{col 46}{space 3}0.314{col 54}{space 4}  .340537{col 67}{space 3}   1.4139
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.333775{col 26}{space 2} .2184239{col 37}{space 1}    1.76{col 46}{space 3}0.079{col 54}{space 4} .9675798{col 67}{space 3} 1.838563
{txt}{space 12} {c |}
{space 2}ethnicity2 {c |}
{space 10}2  {c |}{col 14}{res}{space 2} 1.088319{col 26}{space 2} .2990795{col 37}{space 1}    0.31{col 46}{space 3}0.758{col 54}{space 4} .6350948{col 67}{space 3} 1.864978
{txt}{space 10}5  {c |}{col 14}{res}{space 2} .8701527{col 26}{space 2} .2472064{col 37}{space 1}   -0.49{col 46}{space 3}0.624{col 54}{space 4} .4986238{col 67}{space 3} 1.518511
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .8453293{col 26}{space 2}  .185975{col 37}{space 1}   -0.76{col 46}{space 3}0.445{col 54}{space 4}  .549236{col 67}{space 3} 1.301046
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.629967{col 26}{space 2} .3719128{col 37}{space 1}    2.14{col 46}{space 3}0.032{col 54}{space 4} 1.042217{col 67}{space 3} 2.549172
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9280274{col 26}{space 2} .0491974{col 37}{space 1}   -1.41{col 46}{space 3}0.159{col 54}{space 4} .8364426{col 67}{space 3}  1.02964
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.028491{col 26}{space 2} .1990257{col 37}{space 1}    0.15{col 46}{space 3}0.885{col 54}{space 4} .7038537{col 67}{space 3}  1.50286
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8902419{col 26}{space 2} .1696328{col 37}{space 1}   -0.61{col 46}{space 3}0.542{col 54}{space 4} .6127937{col 67}{space 3} 1.293308
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.077804{col 26}{space 2} .2112605{col 37}{space 1}    0.38{col 46}{space 3}0.702{col 54}{space 4} .7339995{col 67}{space 3} 1.582647
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8441431{col 26}{space 2} .1805235{col 37}{space 1}   -0.79{col 46}{space 3}0.428{col 54}{space 4} .5551152{col 67}{space 3} 1.283657
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .7614404{col 26}{space 2} .1673948{col 37}{space 1}   -1.24{col 46}{space 3}0.215{col 54}{space 4} .4948894{col 67}{space 3} 1.171558
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.132485{col 26}{space 2} .1846729{col 37}{space 1}    0.76{col 46}{space 3}0.445{col 54}{space 4} .8226745{col 67}{space 3} 1.558966
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 7.87e-16{col 26}{space 2} 4.86e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 6.11e-16{col 26}{space 2} 5.45e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .9711156{col 26}{space 2} .2102099{col 37}{space 1}   -0.14{col 46}{space 3}0.892{col 54}{space 4} .6353571{col 67}{space 3} 1.484308
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.082587{col 26}{space 2} .2974865{col 37}{space 1}    0.29{col 46}{space 3}0.773{col 54}{space 4} .6317703{col 67}{space 3} 1.855096
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2} .4324701{col 26}{space 2}  1.22544{col 37}{space 1}   -0.30{col 46}{space 3}0.767{col 54}{space 4}  .001675{col 67}{space 3} 111.6622
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective1adjusted_completecaseethnicityTVC, replace
{res}{txt}(note: file output/data/primaryobjective1adjusted_completecaseethnicityTVC.ster not found)
{txt}file output/data/primaryobjective1adjusted_completecaseethnicityTVC.ster saved

{com}. 
. stcox imid i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer stroke i.diabcat steroidcat, tvc(imid) 

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1111.3218
{txt}Iteration 1:   log likelihood = {res}-1099.9797
{txt}Iteration 2:   log likelihood = {res}-1099.5789
{txt}Iteration 3:   log likelihood = {res}-1099.5257
{txt}Iteration 4:   log likelihood = {res}-1099.5064
{txt}Iteration 5:   log likelihood = {res}-1099.4993
{txt}Iteration 6:   log likelihood = {res}-1099.4967
{txt}Iteration 7:   log likelihood = {res}-1099.4957
{txt}Iteration 8:   log likelihood = {res}-1099.4954
{txt}Iteration 9:   log likelihood = {res}-1099.4952
{txt}Iteration 10:  log likelihood = {res}-1099.4952
{txt}Iteration 11:  log likelihood = {res}-1099.4952
{txt}Iteration 12:  log likelihood = {res}-1099.4952
{txt}Iteration 13:  log likelihood = {res}-1099.4952
{txt}Iteration 14:  log likelihood = {res}-1099.4952
{txt}Iteration 15:  log likelihood = {res}-1099.4952
{txt}Iteration 16:  log likelihood = {res}-1099.4952
{txt}Iteration 17:  log likelihood = {res}-1099.4952
{txt}Iteration 18:  log likelihood = {res}-1099.4952
{txt}Iteration 19:  log likelihood = {res}-1099.4952
{txt}Iteration 20:  log likelihood = {res}-1099.4952
{txt}Iteration 21:  log likelihood = {res}-1099.4952
{txt}Iteration 22:  log likelihood = {res}-1099.4952
{txt}Iteration 23:  log likelihood = {res}-1099.4952
{txt}Iteration 24:  log likelihood = {res}-1099.4952
{txt}Iteration 25:  log likelihood = {res}-1099.4952
{txt}Iteration 26:  log likelihood = {res}-1099.4952
{txt}Iteration 27:  log likelihood = {res}-1099.4952
{txt}Iteration 28:  log likelihood = {res}-1099.4952
{txt}Iteration 29:  log likelihood = {res}-1099.4952
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1099.4952
{txt}Iteration 1:   log likelihood = {res}-1099.4952

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,509                  {txt}Number of obs    =  {res}     1,509
{txt}No. of failures = {res}         153
{txt}Time at risk    = {res} 862.1163587
                                                {txt}LR chi2({res}23{txt})      =  {res}     23.65
{txt}Log likelihood  =   {res}-1099.4952                  {txt}Prob > chi2      =  {res}    0.4232

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2}   1.3909{col 26}{space 2} 2.284024{col 37}{space 1}    0.20{col 46}{space 3}0.841{col 54}{space 4} .0556572{col 67}{space 3} 34.75925
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .8753574{col 26}{space 2} .2148008{col 37}{space 1}   -0.54{col 46}{space 3}0.587{col 54}{space 4} .5411431{col 67}{space 3} 1.415985
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.128058{col 26}{space 2} .2540762{col 37}{space 1}    0.53{col 46}{space 3}0.593{col 54}{space 4} .7254586{col 67}{space 3} 1.754084
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.047561{col 26}{space 2} .2617509{col 37}{space 1}    0.19{col 46}{space 3}0.852{col 54}{space 4} .6419369{col 67}{space 3}  1.70949
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .4921174{col 26}{space 2} .1643905{col 37}{space 1}   -2.12{col 46}{space 3}0.034{col 54}{space 4} .2556979{col 67}{space 3} .9471316
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .6938914{col 26}{space 2} .2519976{col 37}{space 1}   -1.01{col 46}{space 3}0.314{col 54}{space 4}  .340537{col 67}{space 3}   1.4139
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.333775{col 26}{space 2} .2184239{col 37}{space 1}    1.76{col 46}{space 3}0.079{col 54}{space 4} .9675798{col 67}{space 3} 1.838563
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} 1.088319{col 26}{space 2} .2990795{col 37}{space 1}    0.31{col 46}{space 3}0.758{col 54}{space 4} .6350948{col 67}{space 3} 1.864978
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} .8701527{col 26}{space 2} .2472064{col 37}{space 1}   -0.49{col 46}{space 3}0.624{col 54}{space 4} .4986238{col 67}{space 3} 1.518511
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .8453293{col 26}{space 2}  .185975{col 37}{space 1}   -0.76{col 46}{space 3}0.445{col 54}{space 4}  .549236{col 67}{space 3} 1.301046
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.629967{col 26}{space 2} .3719128{col 37}{space 1}    2.14{col 46}{space 3}0.032{col 54}{space 4} 1.042217{col 67}{space 3} 2.549172
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9280274{col 26}{space 2} .0491974{col 37}{space 1}   -1.41{col 46}{space 3}0.159{col 54}{space 4} .8364426{col 67}{space 3}  1.02964
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.028491{col 26}{space 2} .1990257{col 37}{space 1}    0.15{col 46}{space 3}0.885{col 54}{space 4} .7038537{col 67}{space 3}  1.50286
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8902419{col 26}{space 2} .1696328{col 37}{space 1}   -0.61{col 46}{space 3}0.542{col 54}{space 4} .6127937{col 67}{space 3} 1.293308
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.077804{col 26}{space 2} .2112605{col 37}{space 1}    0.38{col 46}{space 3}0.702{col 54}{space 4} .7339995{col 67}{space 3} 1.582647
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8441431{col 26}{space 2} .1805235{col 37}{space 1}   -0.79{col 46}{space 3}0.428{col 54}{space 4} .5551152{col 67}{space 3} 1.283657
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.132485{col 26}{space 2} .1846729{col 37}{space 1}    0.76{col 46}{space 3}0.445{col 54}{space 4} .8226745{col 67}{space 3} 1.558966
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .7614404{col 26}{space 2} .1673948{col 37}{space 1}   -1.24{col 46}{space 3}0.215{col 54}{space 4} .4948894{col 67}{space 3} 1.171558
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 1.17e-13{col 26}{space 2} 5.93e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 9.07e-14{col 26}{space 2} 6.64e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .9711156{col 26}{space 2} .2102099{col 37}{space 1}   -0.14{col 46}{space 3}0.892{col 54}{space 4} .6353571{col 67}{space 3} 1.484308
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.082587{col 26}{space 2} .2974865{col 37}{space 1}    0.29{col 46}{space 3}0.773{col 54}{space 4} .6317703{col 67}{space 3} 1.855096
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2} .4324701{col 26}{space 2}  1.22544{col 37}{space 1}   -0.30{col 46}{space 3}0.767{col 54}{space 4}  .001675{col 67}{space 3} 111.6622
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective1adjustedTVC, replace
{res}{txt}(note: file output/data/primaryobjective1adjustedTVC.ster not found)
{txt}file output/data/primaryobjective1adjustedTVC.ster saved

{com}. 
. stcox imid i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease cancer stroke i.diabcat steroidcat, tvc(imid) 

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1512.9743
{txt}Iteration 1:   log likelihood = {res}-1503.6927
{txt}Iteration 2:   log likelihood = {res}-1503.4032
{txt}Iteration 3:   log likelihood = {res}-1503.3258
{txt}Iteration 4:   log likelihood = {res}-1503.2973
{txt}Iteration 5:   log likelihood = {res}-1503.2868
{txt}Iteration 6:   log likelihood = {res} -1503.283
{txt}Iteration 7:   log likelihood = {res}-1503.2816
{txt}Iteration 8:   log likelihood = {res}-1503.2811
{txt}Iteration 9:   log likelihood = {res}-1503.2809
{txt}Iteration 10:  log likelihood = {res}-1503.2808
{txt}Iteration 11:  log likelihood = {res}-1503.2808
{txt}Iteration 12:  log likelihood = {res}-1503.2808
{txt}Iteration 13:  log likelihood = {res}-1503.2808
{txt}Iteration 14:  log likelihood = {res}-1503.2808
{txt}Iteration 15:  log likelihood = {res}-1503.2808
{txt}Iteration 16:  log likelihood = {res}-1503.2808
{txt}Iteration 17:  log likelihood = {res}-1503.2808
{txt}Iteration 18:  log likelihood = {res}-1503.2808
{txt}Iteration 19:  log likelihood = {res}-1503.2808
{txt}Iteration 20:  log likelihood = {res}-1503.2808
{txt}Iteration 21:  log likelihood = {res}-1503.2808
{txt}Iteration 22:  log likelihood = {res}-1503.2808
{txt}Iteration 23:  log likelihood = {res}-1503.2808
{txt}Iteration 24:  log likelihood = {res}-1503.2808
{txt}Iteration 25:  log likelihood = {res}-1503.2808
{txt}Iteration 26:  log likelihood = {res}-1503.2808
{txt}Iteration 27:  log likelihood = {res}-1503.2808
{txt}Iteration 28:  log likelihood = {res}-1503.2808
{txt}Iteration 29:  log likelihood = {res}-1503.2808
{txt}Iteration 30:  log likelihood = {res}-1503.2808
{txt}Iteration 31:  log likelihood = {res}-1503.2808
{txt}Iteration 32:  log likelihood = {res}-1503.2808
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1503.2808
{txt}Iteration 1:   log likelihood = {res}-1503.2808

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       2,041                  {txt}Number of obs    =  {res}     2,041
{txt}No. of failures = {res}         200
{txt}Time at risk    = {res} 1165.891855
                                                {txt}LR chi2({res}21{txt})      =  {res}     19.39
{txt}Log likelihood  =   {res}-1503.2808                  {txt}Prob > chi2      =  {res}    0.5603

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2} 1.939347{col 26}{space 2} 3.167008{col 37}{space 1}    0.41{col 46}{space 3}0.685{col 54}{space 4} .0789986{col 67}{space 3} 47.60926
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .8355306{col 26}{space 2} .1861054{col 37}{space 1}   -0.81{col 46}{space 3}0.420{col 54}{space 4}  .539966{col 67}{space 3}  1.29288
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.203874{col 26}{space 2} .2345642{col 37}{space 1}    0.95{col 46}{space 3}0.341{col 54}{space 4} .8217357{col 67}{space 3} 1.763722
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.058057{col 26}{space 2} .2332808{col 37}{space 1}    0.26{col 46}{space 3}0.798{col 54}{space 4} .6868088{col 67}{space 3}  1.62998
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .6971209{col 26}{space 2} .1856908{col 37}{space 1}   -1.35{col 46}{space 3}0.176{col 54}{space 4} .4135949{col 67}{space 3} 1.175009
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8097376{col 26}{space 2} .2545718{col 37}{space 1}   -0.67{col 46}{space 3}0.502{col 54}{space 4}  .437257{col 67}{space 3} 1.499519
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.287139{col 26}{space 2} .1837228{col 37}{space 1}    1.77{col 46}{space 3}0.077{col 54}{space 4} .9730324{col 67}{space 3} 1.702644
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .9059657{col 26}{space 2}  .170045{col 37}{space 1}   -0.53{col 46}{space 3}0.599{col 54}{space 4} .6271129{col 67}{space 3} 1.308814
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.428339{col 26}{space 2} .2972021{col 37}{space 1}    1.71{col 46}{space 3}0.087{col 54}{space 4} .9499858{col 67}{space 3}  2.14756
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9628008{col 26}{space 2} .0445104{col 37}{space 1}   -0.82{col 46}{space 3}0.412{col 54}{space 4} .8793976{col 67}{space 3} 1.054114
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.028598{col 26}{space 2}  .171035{col 37}{space 1}    0.17{col 46}{space 3}0.865{col 54}{space 4} .7425197{col 67}{space 3} 1.424896
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .9277052{col 26}{space 2} .1511113{col 37}{space 1}   -0.46{col 46}{space 3}0.645{col 54}{space 4} .6741556{col 67}{space 3} 1.276615
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.096801{col 26}{space 2} .1838893{col 37}{space 1}    0.55{col 46}{space 3}0.582{col 54}{space 4} .7896157{col 67}{space 3} 1.523492
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8922532{col 26}{space 2} .1652768{col 37}{space 1}   -0.62{col 46}{space 3}0.538{col 54}{space 4} .6206055{col 67}{space 3} 1.282805
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.142798{col 26}{space 2} .1621199{col 37}{space 1}    0.94{col 46}{space 3}0.347{col 54}{space 4} .8653979{col 67}{space 3} 1.509116
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .7476242{col 26}{space 2} .1486822{col 37}{space 1}   -1.46{col 46}{space 3}0.144{col 54}{space 4} .5062936{col 67}{space 3} 1.103988
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 5.01e-15{col 26}{space 2} 8.74e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 4.37e-15{col 26}{space 2} 1.44e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .9586909{col 26}{space 2} .1793746{col 37}{space 1}   -0.23{col 46}{space 3}0.822{col 54}{space 4} .6643786{col 67}{space 3}  1.38338
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.114916{col 26}{space 2} .2648685{col 37}{space 1}    0.46{col 46}{space 3}0.647{col 54}{space 4} .6998807{col 67}{space 3} 1.776072
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 8}imid {c |}{col 14}{res}{space 2} .2976567{col 26}{space 2} .8385206{col 37}{space 1}   -0.43{col 46}{space 3}0.667{col 54}{space 4} .0011907{col 67}{space 3} 74.40671
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective1adjusted_noethnicityTVC, replace
{res}{txt}(note: file output/data/primaryobjective1adjusted_noethnicityTVC.ster not found)
{txt}file output/data/primaryobjective1adjusted_noethnicityTVC.ster saved

{com}. 
. /*Primary objective 1- Sensitivity analysis 1 ===========================*/
. stcox imid i.agegroup male i.ethnicity i.imd bmicat bowel skin joint  chronic_cardiac_disease cancer i.diabcat steroidcat if gp_consult ==1

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-680.02496
{txt}Iteration 1:   log likelihood = {res}-669.51016
{txt}Iteration 2:   log likelihood = {res}-668.91286
{txt}Iteration 3:   log likelihood = {res}-668.86267
{txt}Iteration 4:   log likelihood = {res}-668.84597
{txt}Iteration 5:   log likelihood = {res}-668.83983
{txt}Iteration 6:   log likelihood = {res}-668.83757
{txt}Iteration 7:   log likelihood = {res}-668.83674
{txt}Iteration 8:   log likelihood = {res}-668.83643
{txt}Iteration 9:   log likelihood = {res}-668.83632
{txt}Iteration 10:  log likelihood = {res}-668.83628
{txt}Iteration 11:  log likelihood = {res}-668.83627
{txt}Iteration 12:  log likelihood = {res}-668.83626
{txt}Iteration 13:  log likelihood = {res}-668.83626
{txt}Iteration 14:  log likelihood = {res}-668.83626
{txt}Iteration 15:  log likelihood = {res}-668.83626
{txt}Iteration 16:  log likelihood = {res}-668.83626
{txt}Iteration 17:  log likelihood = {res}-668.83626
{txt}Iteration 18:  log likelihood = {res}-668.83626
{txt}Iteration 19:  log likelihood = {res}-668.83626
{txt}Iteration 20:  log likelihood = {res}-668.83626
{txt}Iteration 21:  log likelihood = {res}-668.83626
{txt}Iteration 22:  log likelihood = {res}-668.83626
{txt}Iteration 23:  log likelihood = {res}-668.83626
{txt}Iteration 24:  log likelihood = {res}-668.83626
{txt}Iteration 25:  log likelihood = {res}-668.83626
{txt}Iteration 26:  log likelihood = {res}-668.83626
{txt}Iteration 27:  log likelihood = {res}-668.83626
{txt}Iteration 28:  log likelihood = {res}-668.83626
{txt}Iteration 29:  log likelihood = {res}-668.83626
{txt}Iteration 30:  log likelihood = {res}-668.83626
{txt}Iteration 31:  log likelihood = {res}-668.83626
{txt}Iteration 32:  log likelihood = {res}-668.83626
{txt}Iteration 33:  log likelihood = {res}-668.83626
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-668.83626
{txt}Iteration 1:   log likelihood = {res}-668.83626
{txt}Iteration 2:   log likelihood = {res}-668.83626

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         948                  {txt}Number of obs    =  {res}       948
{txt}No. of failures = {res}         100
{txt}Time at risk    = {res} 542.0424367
                                                {txt}LR chi2({res}21{txt})      =  {res}     22.38
{txt}Log likelihood  =   {res}-668.83626                  {txt}Prob > chi2      =  {res}    0.3780

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2}  .872603{col 26}{space 2} .3330408{col 37}{space 1}   -0.36{col 46}{space 3}0.721{col 54}{space 4} .4129943{col 67}{space 3} 1.843696
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .9393627{col 26}{space 2} .2757984{col 37}{space 1}   -0.21{col 46}{space 3}0.831{col 54}{space 4} .5283468{col 67}{space 3} 1.670119
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.123896{col 26}{space 2} .3151652{col 37}{space 1}    0.42{col 46}{space 3}0.677{col 54}{space 4} .6486803{col 67}{space 3} 1.947251
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.175448{col 26}{space 2} .3511263{col 37}{space 1}    0.54{col 46}{space 3}0.588{col 54}{space 4} .6545384{col 67}{space 3}  2.11092
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .3509648{col 26}{space 2} .1685404{col 37}{space 1}   -2.18{col 46}{space 3}0.029{col 54}{space 4} .1369302{col 67}{space 3}  .899555
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .5551608{col 26}{space 2} .2948531{col 37}{space 1}   -1.11{col 46}{space 3}0.268{col 54}{space 4} .1960355{col 67}{space 3} 1.572182
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.285818{col 26}{space 2} .2605351{col 37}{space 1}    1.24{col 46}{space 3}0.215{col 54}{space 4} .8643846{col 67}{space 3} 1.912721
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} 1.369253{col 26}{space 2} .4152978{col 37}{space 1}    1.04{col 46}{space 3}0.300{col 54}{space 4} .7556352{col 67}{space 3} 2.481163
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} .7182342{col 26}{space 2} .2686294{col 37}{space 1}   -0.88{col 46}{space 3}0.376{col 54}{space 4} .3450683{col 67}{space 3} 1.494952
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .8779002{col 26}{space 2} .2349338{col 37}{space 1}   -0.49{col 46}{space 3}0.627{col 54}{space 4} .5195844{col 67}{space 3} 1.483318
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.774837{col 26}{space 2} .5288341{col 37}{space 1}    1.93{col 46}{space 3}0.054{col 54}{space 4} .9897662{col 67}{space 3} 3.182616
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9277802{col 26}{space 2}  .061103{col 37}{space 1}   -1.14{col 46}{space 3}0.255{col 54}{space 4} .8154278{col 67}{space 3} 1.055613
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.070505{col 26}{space 2} .2544779{col 37}{space 1}    0.29{col 46}{space 3}0.774{col 54}{space 4} .6718047{col 67}{space 3} 1.705824
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .9516914{col 26}{space 2} .2249069{col 37}{space 1}   -0.21{col 46}{space 3}0.834{col 54}{space 4} .5988766{col 67}{space 3} 1.512359
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.188957{col 26}{space 2} .2857963{col 37}{space 1}    0.72{col 46}{space 3}0.472{col 54}{space 4} .7422637{col 67}{space 3} 1.904471
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8886602{col 26}{space 2} .2356782{col 37}{space 1}   -0.45{col 46}{space 3}0.656{col 54}{space 4} .5284353{col 67}{space 3} 1.494444
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.162106{col 26}{space 2} .2359979{col 37}{space 1}    0.74{col 46}{space 3}0.459{col 54}{space 4} .7805229{col 67}{space 3} 1.730238
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 7.48e-16{col 26}{space 2} 4.54e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 5.27e-16{col 26}{space 2} 6.64e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .7778602{col 26}{space 2} .2203375{col 37}{space 1}   -0.89{col 46}{space 3}0.375{col 54}{space 4} .4464669{col 67}{space 3} 1.355232
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.275277{col 26}{space 2} .4015958{col 37}{space 1}    0.77{col 46}{space 3}0.440{col 54}{space 4} .6879453{col 67}{space 3} 2.364043
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1sensitivity1, replace
{res}{txt}(note: file output/data/primaryobjective1sensitivity1.ster not found)
{txt}file output/data/primaryobjective1sensitivity1.ster saved

{com}. sts graph if gp_consult ==1, by(imid) xtitle("Analysis time (years)") saving(primeob1sens1, replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob1sens1.gph not found)
{res}{txt}(file primeob1sens1.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob1sens1.pdf", as(pdf) replace
{txt}(file output/figures/primeob1sens1.pdf written in PDF format)

{com}. sts graph if gp_consult ==1, cumhaz by (imid) xtitle("Analysis time (years)") tmax(0.58)  legend(order(1 "Gen Pop" 2 "IMID")) saving(primob1sens1_NA, replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primob1sens1_NA.gph not found)
{res}{txt}(file primob1sens1_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob1sens1_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob1sens1_NA.pdf written in PDF format)

{com}. 
. /*Primary objective 1- Sensitivity analysis 2 ===========================*/
. stcox imid i.agegroup male i.ethnicity i.imd bmicat bowel skin joint  chronic_cardiac_disease stroke cancer i.diabcat steroidcat i.ckd chronic_liver_disease chronic_respiratory_disease

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1111.3218
{txt}Iteration 1:   log likelihood = {res}-1099.1296
{txt}Iteration 2:   log likelihood = {res}-1098.7234
{txt}Iteration 3:   log likelihood = {res}-1098.6705
{txt}Iteration 4:   log likelihood = {res}-1098.6513
{txt}Iteration 5:   log likelihood = {res}-1098.6442
{txt}Iteration 6:   log likelihood = {res}-1098.6416
{txt}Iteration 7:   log likelihood = {res}-1098.6407
{txt}Iteration 8:   log likelihood = {res}-1098.6403
{txt}Iteration 9:   log likelihood = {res}-1098.6402
{txt}Iteration 10:  log likelihood = {res}-1098.6401
{txt}Iteration 11:  log likelihood = {res}-1098.6401
{txt}Iteration 12:  log likelihood = {res}-1098.6401
{txt}Iteration 13:  log likelihood = {res}-1098.6401
{txt}Iteration 14:  log likelihood = {res}-1098.6401
{txt}Iteration 15:  log likelihood = {res}-1098.6401
{txt}Iteration 16:  log likelihood = {res}-1098.6401
{txt}Iteration 17:  log likelihood = {res}-1098.6401
{txt}Iteration 18:  log likelihood = {res}-1098.6401
{txt}Iteration 19:  log likelihood = {res}-1098.6401
{txt}Iteration 20:  log likelihood = {res}-1098.6401
{txt}Iteration 21:  log likelihood = {res}-1098.6401
{txt}Iteration 22:  log likelihood = {res}-1098.6401
{txt}Iteration 23:  log likelihood = {res}-1098.6401
{txt}Iteration 24:  log likelihood = {res}-1098.6401
{txt}Iteration 25:  log likelihood = {res}-1098.6401
{txt}Iteration 26:  log likelihood = {res}-1098.6401
{txt}Iteration 27:  log likelihood = {res}-1098.6401
{txt}Iteration 28:  log likelihood = {res}-1098.6401
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1098.6401
{txt}Iteration 1:   log likelihood = {res}-1098.6401
{txt}Iteration 2:   log likelihood = {res}-1098.6401
{txt}Iteration 3:   log likelihood = {res}-1098.6401

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,509                  {txt}Number of obs    =  {res}     1,509
{txt}No. of failures = {res}         153
{txt}Time at risk    = {res} 862.1163587
                                                {txt}LR chi2({res}25{txt})      =  {res}     25.36
{txt}Log likelihood  =   {res}-1098.6401                  {txt}Prob > chi2      =  {res}    0.4422

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} .8511591{col 26}{space 2} .2599632{col 37}{space 1}   -0.53{col 46}{space 3}0.598{col 54}{space 4} .4677724{col 67}{space 3}  1.54877
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .8695976{col 26}{space 2}  .213422{col 37}{space 1}   -0.57{col 46}{space 3}0.569{col 54}{space 4} .5375405{col 67}{space 3} 1.406778
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.153981{col 26}{space 2} .2607269{col 37}{space 1}    0.63{col 46}{space 3}0.526{col 54}{space 4} .7411064{col 67}{space 3} 1.796869
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.047444{col 26}{space 2}  .262388{col 37}{space 1}    0.19{col 46}{space 3}0.853{col 54}{space 4}  .641065{col 67}{space 3} 1.711431
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .4839413{col 26}{space 2} .1618237{col 37}{space 1}   -2.17{col 46}{space 3}0.030{col 54}{space 4} .2512824{col 67}{space 3} .9320161
{txt}{space 8}80+  {c |}{col 14}{res}{space 2}  .687171{col 26}{space 2} .2498071{col 37}{space 1}   -1.03{col 46}{space 3}0.302{col 54}{space 4} .3369983{col 67}{space 3} 1.401206
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.320227{col 26}{space 2} .2169737{col 37}{space 1}    1.69{col 46}{space 3}0.091{col 54}{space 4} .9566592{col 67}{space 3} 1.821965
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} 1.077745{col 26}{space 2} .2963568{col 37}{space 1}    0.27{col 46}{space 3}0.785{col 54}{space 4} .6287146{col 67}{space 3} 1.847473
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} .8647873{col 26}{space 2} .2459951{col 37}{space 1}   -0.51{col 46}{space 3}0.610{col 54}{space 4} .4951978{col 67}{space 3} 1.510219
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .8399952{col 26}{space 2} .1848752{col 37}{space 1}   -0.79{col 46}{space 3}0.428{col 54}{space 4} .5456764{col 67}{space 3} 1.293059
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.612365{col 26}{space 2} .3683836{col 37}{space 1}    2.09{col 46}{space 3}0.037{col 54}{space 4} 1.030353{col 67}{space 3} 2.523137
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9271888{col 26}{space 2} .0491626{col 37}{space 1}   -1.43{col 46}{space 3}0.154{col 54}{space 4} .8356698{col 67}{space 3} 1.028731
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.040073{col 26}{space 2} .2014144{col 37}{space 1}    0.20{col 46}{space 3}0.839{col 54}{space 4} .7115823{col 67}{space 3} 1.520206
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8910338{col 26}{space 2} .1701175{col 37}{space 1}   -0.60{col 46}{space 3}0.546{col 54}{space 4} .6128886{col 67}{space 3} 1.295409
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.083295{col 26}{space 2} .2120462{col 37}{space 1}    0.41{col 46}{space 3}0.683{col 54}{space 4} .7381264{col 67}{space 3} 1.589873
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8445747{col 26}{space 2} .1808435{col 37}{space 1}   -0.79{col 46}{space 3}0.430{col 54}{space 4} .5551056{col 67}{space 3} 1.284992
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .7640747{col 26}{space 2} .1680131{col 37}{space 1}   -1.22{col 46}{space 3}0.221{col 54}{space 4} .4965515{col 67}{space 3} 1.175729
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.126234{col 26}{space 2} .1840479{col 37}{space 1}    0.73{col 46}{space 3}0.467{col 54}{space 4} .8175724{col 67}{space 3} 1.551426
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 4.02e-14{col 26}{space 2} 3.38e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 3.14e-14{col 26}{space 2} 3.81e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .9695458{col 26}{space 2} .2099266{col 37}{space 1}   -0.14{col 46}{space 3}0.886{col 54}{space 4} .6342577{col 67}{space 3} 1.482078
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.082956{col 26}{space 2} .2979337{col 37}{space 1}    0.29{col 46}{space 3}0.772{col 54}{space 4} .6315904{col 67}{space 3}  1.85689
{txt}{space 12} {c |}
{space 9}ckd {c |}
{space 8}CKD  {c |}{col 14}{res}{space 2} .9367708{col 26}{space 2} .1548937{col 37}{space 1}   -0.40{col 46}{space 3}0.693{col 54}{space 4} .6774673{col 67}{space 3} 1.295324
{txt}chronic_l~se {c |}{col 14}{res}{space 2} .9762631{col 26}{space 2} .2003263{col 37}{space 1}   -0.12{col 46}{space 3}0.907{col 54}{space 4} .6529845{col 67}{space 3}  1.45959
{txt}chronic_r~se {c |}{col 14}{res}{space 2} .7609262{col 26}{space 2} .1679041{col 37}{space 1}   -1.24{col 46}{space 3}0.216{col 54}{space 4}  .493763{col 67}{space 3} 1.172645
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1sensitivity2, replace
{res}{txt}(note: file output/data/primaryobjective1sensitivity2.ster not found)
{txt}file output/data/primaryobjective1sensitivity2.ster saved

{com}. 
. 
. /*Primary objective 1 Using death or ITU========================================================================*/ 
. egen stopicu = rmin(icu_or_death_covid_date diecensor)
{txt}
{com}. 
. stset stopicu, id(patient_id) failure(icu_or_death_covid==1) origin(time enter_date) scale(365.25) ///
>                 exit(icu_or_death_covid==1 time stop)

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}icu_or_death_covid == 1
{txt}obs. time interval:  {res}(stopicu[_n-1], stopicu]
{txt} exit on or before:  {res}icu_or_death_covid==1 time stop
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}          0{txt}  exclusions
{hline 78}
{res}     39,354{txt}  observations remaining, representing
{res}     39,354{txt}  subjects
{res}        441{txt}  failures in single-failure-per-subject data
{res} 22,473.153{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}. 
. strate imid, per(1000) output(imid, replace)

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Estimated rates (per 1000) and lower/upper bounds of 95% confidence intervals
({res}39354{txt} records included in the analysis)

  {c TLC}{hline 9}{c -}{hline 5}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c TRC}
  {c |} {res}   imid     D         Y     Rate    Lower    Upper {txt}{c |}
  {c LT}{hline 9}{c -}{hline 5}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}Gen Pop    69    3.7836   18.236   14.403   23.089 {txt}{c |}
  {c |} {res}   IMID   372   18.6895   19.904   17.981   22.033 {txt}{c |}
  {c BLC}{hline 9}{c -}{hline 5}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c BRC}


{com}. stcox imid i.agegroup male

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-4648.5027
{txt}Iteration 1:   log likelihood = {res}-4647.3076
{txt}Iteration 2:   log likelihood = {res}-4647.3071
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-4647.3071

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      39,354                  {txt}Number of obs    =  {res}    39,354
{txt}No. of failures = {res}         441
{txt}Time at risk    = {res} 22473.15264
                                                {txt}LR chi2({res}7{txt})       =  {res}      2.39
{txt}Log likelihood  =   {res}-4647.3071                  {txt}Prob > chi2      =  {res}    0.9351

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2}  1.08986{col 26}{space 2} .1428571{col 37}{space 1}    0.66{col 46}{space 3}0.512{col 54}{space 4} .8429399{col 67}{space 3}  1.40911
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.002279{col 26}{space 2} .1462298{col 37}{space 1}    0.02{col 46}{space 3}0.988{col 54}{space 4} .7530099{col 67}{space 3} 1.334064
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.159447{col 26}{space 2} .1588678{col 37}{space 1}    1.08{col 46}{space 3}0.280{col 54}{space 4} .8863779{col 67}{space 3} 1.516641
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.147887{col 26}{space 2} .1710477{col 37}{space 1}    0.93{col 46}{space 3}0.355{col 54}{space 4} .8571584{col 67}{space 3} 1.537225
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.076306{col 26}{space 2} .1811233{col 37}{space 1}    0.44{col 46}{space 3}0.662{col 54}{space 4} .7739158{col 67}{space 3} 1.496849
{txt}{space 8}80+  {c |}{col 14}{res}{space 2}  1.10866{col 26}{space 2} .2246595{col 37}{space 1}    0.51{col 46}{space 3}0.611{col 54}{space 4} .7452643{col 67}{space 3}  1.64925
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.030102{col 26}{space 2}  .098114{col 37}{space 1}    0.31{col 46}{space 3}0.756{col 54}{space 4} .8546845{col 67}{space 3} 1.241522
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1limitedadjitudeath, replace
{res}{txt}(note: file output/data/primaryobjective1limitedadjitudeath.ster not found)
{txt}file output/data/primaryobjective1limitedadjitudeath.ster saved

{com}. 
. sts graph, by(imid) xtitle("Analysis time (years)") saving(primeob1_nonadjitudeath, replace)

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob1_nonadjitudeath.gph not found)
{res}{txt}(file primeob1_nonadjitudeath.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob1_nonadjitudeath.pdf", as(pdf) replace
{txt}(file output/figures/primeob1_nonadjitudeath.pdf written in PDF format)

{com}. sts graph, cumhaz by (imid) xtitle("Analysis time (years)") tmax(0.58) legend(order(1 "Gen Pop" 2 "IMID")) saving(primeob1_nonadjitudeath_NA, replace)

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob1_nonadjitudeath_NA.gph not found)
{res}{txt}(file primeob1_nonadjitudeath_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob1_nonadjitudeath_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob1_nonadjitudeath_NA.pdf written in PDF format)

{com}. 
. stcox imid i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-181.94237
{txt}Iteration 1:   log likelihood = {res}-171.54625
{txt}Iteration 2:   log likelihood = {res}-170.89977
{txt}Iteration 3:   log likelihood = {res}-170.87392
{txt}Iteration 4:   log likelihood = {res}-170.87119
{txt}Iteration 5:   log likelihood = {res}-170.87021
{txt}Iteration 6:   log likelihood = {res}-170.86985
{txt}Iteration 7:   log likelihood = {res}-170.86971
{txt}Iteration 8:   log likelihood = {res}-170.86966
{txt}Iteration 9:   log likelihood = {res}-170.86965
{txt}Iteration 10:  log likelihood = {res}-170.86964
{txt}Iteration 11:  log likelihood = {res}-170.86964
{txt}Iteration 12:  log likelihood = {res}-170.86964
{txt}Iteration 13:  log likelihood = {res}-170.86964
{txt}Iteration 14:  log likelihood = {res}-170.86964
{txt}Iteration 15:  log likelihood = {res}-170.86964
{txt}Iteration 16:  log likelihood = {res}-170.86964
{txt}Iteration 17:  log likelihood = {res}-170.86964
{txt}Iteration 18:  log likelihood = {res}-170.86964
{txt}Iteration 19:  log likelihood = {res}-170.86964
{txt}Iteration 20:  log likelihood = {res}-170.86964
{txt}Iteration 21:  log likelihood = {res}-170.86964
{txt}Iteration 22:  log likelihood = {res}-170.86964
{txt}Iteration 23:  log likelihood = {res}-170.86964
{txt}Iteration 24:  log likelihood = {res}-170.86964
{txt}Iteration 25:  log likelihood = {res}-170.86964
{txt}Iteration 26:  log likelihood = {res}-170.86964
{txt}Iteration 27:  log likelihood = {res}-170.86964
{txt}Iteration 28:  log likelihood = {res}-170.86964
{txt}Iteration 29:  log likelihood = {res}-170.86964
{txt}Iteration 30:  log likelihood = {res}-170.86964
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-170.86964
{txt}Iteration 1:   log likelihood = {res}-170.86964

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       2,041                  {txt}Number of obs    =  {res}     2,041
{txt}No. of failures = {res}          24
{txt}Time at risk    = {res} 1165.891855
                                                {txt}LR chi2({res}20{txt})      =  {res}     22.15
{txt}Log likelihood  =   {res}-170.86964                  {txt}Prob > chi2      =  {res}    0.3327

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2}  6.47881{col 26}{space 2} 7.398444{col 37}{space 1}    1.64{col 46}{space 3}0.102{col 54}{space 4} .6909872{col 67}{space 3}  60.7464
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .5065426{col 26}{space 2} .3315909{col 37}{space 1}   -1.04{col 46}{space 3}0.299{col 54}{space 4} .1404125{col 67}{space 3} 1.827368
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .1767498{col 26}{space 2} .1850919{col 37}{space 1}   -1.65{col 46}{space 3}0.098{col 54}{space 4} .0226978{col 67}{space 3} 1.376368
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2}  1.03106{col 26}{space 2} .5640474{col 37}{space 1}    0.06{col 46}{space 3}0.955{col 54}{space 4}  .352882{col 67}{space 3} 3.012581
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .5053953{col 26}{space 2} .3899935{col 37}{space 1}   -0.88{col 46}{space 3}0.377{col 54}{space 4} .1113763{col 67}{space 3} 2.293347
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8117429{col 26}{space 2} .6261168{col 37}{space 1}   -0.27{col 46}{space 3}0.787{col 54}{space 4} .1790055{col 67}{space 3} 3.681042
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2}  1.34756{col 26}{space 2} .5573245{col 37}{space 1}    0.72{col 46}{space 3}0.471{col 54}{space 4} .5991116{col 67}{space 3} 3.031018
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .3532746{col 26}{space 2}  .263413{col 37}{space 1}   -1.40{col 46}{space 3}0.163{col 54}{space 4} .0819273{col 67}{space 3} 1.523337
{txt}5 most de..  {c |}{col 14}{res}{space 2} .9476035{col 26}{space 2} .5926674{col 37}{space 1}   -0.09{col 46}{space 3}0.931{col 54}{space 4} .2781331{col 67}{space 3} 3.228499
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.315079{col 26}{space 2}  .204682{col 37}{space 1}    1.76{col 46}{space 3}0.078{col 54}{space 4} .9693241{col 67}{space 3} 1.784165
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} .8821434{col 26}{space 2}  .402426{col 37}{space 1}   -0.27{col 46}{space 3}0.783{col 54}{space 4} .3607685{col 67}{space 3} 2.156998
{txt}{space 8}skin {c |}{col 14}{res}{space 2}  .744399{col 26}{space 2} .3378117{col 37}{space 1}   -0.65{col 46}{space 3}0.515{col 54}{space 4} .3058627{col 67}{space 3} 1.811694
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .8361064{col 26}{space 2}  .384484{col 37}{space 1}   -0.39{col 46}{space 3}0.697{col 54}{space 4}  .339497{col 67}{space 3} 2.059146
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6161592{col 26}{space 2} .3828389{col 37}{space 1}   -0.78{col 46}{space 3}0.436{col 54}{space 4} .1823119{col 67}{space 3} 2.082432
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} 2.342454{col 26}{space 2} 1.027807{col 37}{space 1}    1.94{col 46}{space 3}0.052{col 54}{space 4} .9912566{col 67}{space 3} 5.535489
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.184016{col 26}{space 2} .4901578{col 37}{space 1}    0.41{col 46}{space 3}0.683{col 54}{space 4} .5259902{col 67}{space 3} 2.665245
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 3.24e-14{col 26}{space 2} 6.86e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 2.49e-14{col 26}{space 2} 9.52e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.285468{col 26}{space 2} .6121025{col 37}{space 1}    0.53{col 46}{space 3}0.598{col 54}{space 4} .5055264{col 67}{space 3} 3.268727
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2}  .483616{col 26}{space 2} .4959835{col 37}{space 1}   -0.71{col 46}{space 3}0.479{col 54}{space 4} .0647935{col 67}{space 3} 3.609691
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1adjusteditudeath, replace
{res}{txt}(note: file output/data/primaryobjective1adjusteditudeath.ster not found)
{txt}file output/data/primaryobjective1adjusteditudeath.ster saved

{com}.  
. stcox imid i.agegroup male i.imd i.ethnicity2 bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-138.31765
{txt}Iteration 1:   log likelihood = {res}-125.22097
{txt}Iteration 2:   log likelihood = {res}  -124.329
{txt}Iteration 3:   log likelihood = {res}-124.16021
{txt}Iteration 4:   log likelihood = {res}-124.09989
{txt}Iteration 5:   log likelihood = {res}-124.07779
{txt}Iteration 6:   log likelihood = {res}-124.06968
{txt}Iteration 7:   log likelihood = {res}-124.06669
{txt}Iteration 8:   log likelihood = {res}-124.06559
{txt}Iteration 9:   log likelihood = {res}-124.06519
{txt}Iteration 10:  log likelihood = {res}-124.06504
{txt}Iteration 11:  log likelihood = {res}-124.06499
{txt}Iteration 12:  log likelihood = {res}-124.06497
{txt}Iteration 13:  log likelihood = {res}-124.06496
{txt}Iteration 14:  log likelihood = {res}-124.06496
{txt}Iteration 15:  log likelihood = {res}-124.06496
{txt}Iteration 16:  log likelihood = {res}-124.06496
{txt}Iteration 17:  log likelihood = {res}-124.06496
{txt}Iteration 18:  log likelihood = {res}-124.06496
{txt}Iteration 19:  log likelihood = {res}-124.06496
{txt}Iteration 20:  log likelihood = {res}-124.06496
{txt}Iteration 21:  log likelihood = {res}-124.06496
{txt}Iteration 22:  log likelihood = {res}-124.06496
{txt}Iteration 23:  log likelihood = {res}-124.06496
{txt}Iteration 24:  log likelihood = {res}-124.06496
{txt}Iteration 25:  log likelihood = {res}-124.06496
{txt}Iteration 26:  log likelihood = {res}-124.06496
{txt}Iteration 27:  log likelihood = {res}-124.06496
{txt}Iteration 28:  log likelihood = {res}-124.06496
{txt}Iteration 29:  log likelihood = {res}-124.06496
{txt}Iteration 30:  log likelihood = {res}-124.06496
{txt}Iteration 31:  log likelihood = {res}-124.06496
{txt}Iteration 32:  log likelihood = {res}-124.06496
{txt}Iteration 33:  log likelihood = {res}-124.06496
{txt}Iteration 34:  log likelihood = {res}-124.06496
{txt}Iteration 35:  log likelihood = {res}-124.06496
{txt}Iteration 36:  log likelihood = {res}-124.06496
{txt}Iteration 37:  log likelihood = {res}-124.06496
{txt}Iteration 38:  log likelihood = {res}-124.06496
{txt}Iteration 39:  log likelihood = {res}-124.06496
{txt}Iteration 40:  log likelihood = {res}-124.06496
{txt}Iteration 41:  log likelihood = {res}-124.06496
{txt}Iteration 42:  log likelihood = {res}-124.06496
{txt}Iteration 43:  log likelihood = {res}-124.06496
{txt}Iteration 44:  log likelihood = {res}-124.06496
{txt}Iteration 45:  log likelihood = {res}-124.06496
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-124.06496

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,509                  {txt}Number of obs    =  {res}     1,509
{txt}No. of failures = {res}          19
{txt}Time at risk    = {res} 862.1163587
                                                {txt}LR chi2({res}19{txt})      =  {res}     28.51
{txt}Log likelihood  =   {res}-124.06496                  {txt}Prob > chi2      =  {res}    0.0742

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} 7.010496{col 26}{space 2} 8.277648{col 37}{space 1}    1.65{col 46}{space 3}0.099{col 54}{space 4} .6929339{col 67}{space 3} 70.92602
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .3815451{col 26}{space 2} .2993314{col 37}{space 1}   -1.23{col 46}{space 3}0.219{col 54}{space 4} .0819894{col 67}{space 3} 1.775555
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .2003869{col 26}{space 2} .2128105{col 37}{space 1}   -1.51{col 46}{space 3}0.130{col 54}{space 4} .0249974{col 67}{space 3} 1.606363
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.314901{col 26}{space 2} .7581202{col 37}{space 1}    0.47{col 46}{space 3}0.635{col 54}{space 4} .4247406{col 67}{space 3} 4.070637
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.65e-20{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8658287{col 26}{space 2} .6827426{col 37}{space 1}   -0.18{col 46}{space 3}0.855{col 54}{space 4} .1845965{col 67}{space 3}  4.06107
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 2.082333{col 26}{space 2} 1.012861{col 37}{space 1}    1.51{col 46}{space 3}0.132{col 54}{space 4}  .802639{col 67}{space 3}  5.40232
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .4521638{col 26}{space 2} .3443556{col 37}{space 1}   -1.04{col 46}{space 3}0.297{col 54}{space 4} .1016352{col 67}{space 3} 2.011628
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.388018{col 26}{space 2} .9053861{col 37}{space 1}    0.50{col 46}{space 3}0.615{col 54}{space 4}  .386516{col 67}{space 3} 4.984514
{txt}{space 12} {c |}
{space 2}ethnicity2 {c |}
{space 10}2  {c |}{col 14}{res}{space 2} 2.000973{col 26}{space 2} 1.300616{col 37}{space 1}    1.07{col 46}{space 3}0.286{col 54}{space 4} .5597155{col 67}{space 3} 7.153442
{txt}{space 10}5  {c |}{col 14}{res}{space 2} .4663306{col 26}{space 2} .4861078{col 37}{space 1}   -0.73{col 46}{space 3}0.464{col 54}{space 4} .0604495{col 67}{space 3} 3.597454
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.349186{col 26}{space 2}  .248513{col 37}{space 1}    1.63{col 46}{space 3}0.104{col 54}{space 4} .9403403{col 67}{space 3} 1.935792
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  .508671{col 26}{space 2}  .270619{col 37}{space 1}   -1.27{col 46}{space 3}0.204{col 54}{space 4} .1793031{col 67}{space 3} 1.443066
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8535437{col 26}{space 2} .4478023{col 37}{space 1}   -0.30{col 46}{space 3}0.763{col 54}{space 4} .3052476{col 67}{space 3} 2.386708
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .6889247{col 26}{space 2} .3700852{col 37}{space 1}   -0.69{col 46}{space 3}0.488{col 54}{space 4}  .240388{col 67}{space 3}  1.97438
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5608685{col 26}{space 2} .4235045{col 37}{space 1}   -0.77{col 46}{space 3}0.444{col 54}{space 4}  .127682{col 67}{space 3} 2.463726
{txt}{space 6}stroke {c |}{col 14}{res}{space 2}   2.4397{col 26}{space 2} 1.177883{col 37}{space 1}    1.85{col 46}{space 3}0.065{col 54}{space 4} .9470605{col 67}{space 3} 6.284852
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.265988{col 26}{space 2} .5943615{col 37}{space 1}    0.50{col 46}{space 3}0.615{col 54}{space 4}  .504433{col 67}{space 3} 3.177279
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.36e-18{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 3.17e-18{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.411974{col 26}{space 2} .7456625{col 37}{space 1}    0.65{col 46}{space 3}0.514{col 54}{space 4} .5015422{col 67}{space 3} 3.975078
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} .7516662{col 26}{space 2}  .777916{col 37}{space 1}   -0.28{col 46}{space 3}0.783{col 54}{space 4} .0988776{col 67}{space 3} 5.714159
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1adjusteditudeath_ethnicity, replace
{res}{txt}(note: file output/data/primaryobjective1adjusteditudeath_ethnicity.ster not found)
{txt}file output/data/primaryobjective1adjusteditudeath_ethnicity.ster saved

{com}. 
. stcox imid i.agegroup male i.imd i.ethnicity bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-138.31765
{txt}Iteration 1:   log likelihood = {res}-125.22097
{txt}Iteration 2:   log likelihood = {res}  -124.329
{txt}Iteration 3:   log likelihood = {res}-124.16021
{txt}Iteration 4:   log likelihood = {res}-124.09989
{txt}Iteration 5:   log likelihood = {res}-124.07779
{txt}Iteration 6:   log likelihood = {res}-124.06968
{txt}Iteration 7:   log likelihood = {res}-124.06669
{txt}Iteration 8:   log likelihood = {res}-124.06559
{txt}Iteration 9:   log likelihood = {res}-124.06519
{txt}Iteration 10:  log likelihood = {res}-124.06504
{txt}Iteration 11:  log likelihood = {res}-124.06499
{txt}Iteration 12:  log likelihood = {res}-124.06497
{txt}Iteration 13:  log likelihood = {res}-124.06496
{txt}Iteration 14:  log likelihood = {res}-124.06496
{txt}Iteration 15:  log likelihood = {res}-124.06496
{txt}Iteration 16:  log likelihood = {res}-124.06496
{txt}Iteration 17:  log likelihood = {res}-124.06496
{txt}Iteration 18:  log likelihood = {res}-124.06496
{txt}Iteration 19:  log likelihood = {res}-124.06496
{txt}Iteration 20:  log likelihood = {res}-124.06496
{txt}Iteration 21:  log likelihood = {res}-124.06496
{txt}Iteration 22:  log likelihood = {res}-124.06496
{txt}Iteration 23:  log likelihood = {res}-124.06496
{txt}Iteration 24:  log likelihood = {res}-124.06496
{txt}Iteration 25:  log likelihood = {res}-124.06496
{txt}Iteration 26:  log likelihood = {res}-124.06496
{txt}Iteration 27:  log likelihood = {res}-124.06496
{txt}Iteration 28:  log likelihood = {res}-124.06496
{txt}Iteration 29:  log likelihood = {res}-124.06496
{txt}Iteration 30:  log likelihood = {res}-124.06496
{txt}Iteration 31:  log likelihood = {res}-124.06496
{txt}Iteration 32:  log likelihood = {res}-124.06496
{txt}Iteration 33:  log likelihood = {res}-124.06496
{txt}Iteration 34:  log likelihood = {res}-124.06496
{txt}Iteration 35:  log likelihood = {res}-124.06496
{txt}Iteration 36:  log likelihood = {res}-124.06496
{txt}Iteration 37:  log likelihood = {res}-124.06496
{txt}Iteration 38:  log likelihood = {res}-124.06496
{txt}Iteration 39:  log likelihood = {res}-124.06496
{txt}Iteration 40:  log likelihood = {res}-124.06496
{txt}Iteration 41:  log likelihood = {res}-124.06496
{txt}Iteration 42:  log likelihood = {res}-124.06496
{txt}Iteration 43:  log likelihood = {res}-124.06496
{txt}Iteration 44:  log likelihood = {res}-124.06496
{txt}Iteration 45:  log likelihood = {res}-124.06496
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-124.06496

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,509                  {txt}Number of obs    =  {res}     1,509
{txt}No. of failures = {res}          19
{txt}Time at risk    = {res} 862.1163587
                                                {txt}LR chi2({res}19{txt})      =  {res}     28.51
{txt}Log likelihood  =   {res}-124.06496                  {txt}Prob > chi2      =  {res}    0.0742

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 8}imid {c |}{col 14}{res}{space 2} 7.010496{col 26}{space 2} 8.277648{col 37}{space 1}    1.65{col 46}{space 3}0.099{col 54}{space 4} .6929339{col 67}{space 3} 70.92602
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .3815451{col 26}{space 2} .2993314{col 37}{space 1}   -1.23{col 46}{space 3}0.219{col 54}{space 4} .0819894{col 67}{space 3} 1.775555
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .2003869{col 26}{space 2} .2128105{col 37}{space 1}   -1.51{col 46}{space 3}0.130{col 54}{space 4} .0249974{col 67}{space 3} 1.606363
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.314901{col 26}{space 2} .7581202{col 37}{space 1}    0.47{col 46}{space 3}0.635{col 54}{space 4} .4247406{col 67}{space 3} 4.070637
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.65e-20{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8658287{col 26}{space 2} .6827426{col 37}{space 1}   -0.18{col 46}{space 3}0.855{col 54}{space 4} .1845965{col 67}{space 3}  4.06107
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 2.082333{col 26}{space 2} 1.012861{col 37}{space 1}    1.51{col 46}{space 3}0.132{col 54}{space 4}  .802639{col 67}{space 3}  5.40232
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .4521638{col 26}{space 2} .3443556{col 37}{space 1}   -1.04{col 46}{space 3}0.297{col 54}{space 4} .1016352{col 67}{space 3} 2.011628
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.388018{col 26}{space 2} .9053861{col 37}{space 1}    0.50{col 46}{space 3}0.615{col 54}{space 4}  .386516{col 67}{space 3} 4.984514
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} 2.000973{col 26}{space 2} 1.300616{col 37}{space 1}    1.07{col 46}{space 3}0.286{col 54}{space 4} .5597155{col 67}{space 3} 7.153442
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} .4663306{col 26}{space 2} .4861078{col 37}{space 1}   -0.73{col 46}{space 3}0.464{col 54}{space 4} .0604495{col 67}{space 3} 3.597454
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.349186{col 26}{space 2}  .248513{col 37}{space 1}    1.63{col 46}{space 3}0.104{col 54}{space 4} .9403403{col 67}{space 3} 1.935792
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  .508671{col 26}{space 2}  .270619{col 37}{space 1}   -1.27{col 46}{space 3}0.204{col 54}{space 4} .1793031{col 67}{space 3} 1.443066
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8535437{col 26}{space 2} .4478023{col 37}{space 1}   -0.30{col 46}{space 3}0.763{col 54}{space 4} .3052476{col 67}{space 3} 2.386708
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .6889247{col 26}{space 2} .3700852{col 37}{space 1}   -0.69{col 46}{space 3}0.488{col 54}{space 4}  .240388{col 67}{space 3}  1.97438
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5608685{col 26}{space 2} .4235045{col 37}{space 1}   -0.77{col 46}{space 3}0.444{col 54}{space 4}  .127682{col 67}{space 3} 2.463726
{txt}{space 6}stroke {c |}{col 14}{res}{space 2}   2.4397{col 26}{space 2} 1.177883{col 37}{space 1}    1.85{col 46}{space 3}0.065{col 54}{space 4} .9470605{col 67}{space 3} 6.284852
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.265988{col 26}{space 2} .5943615{col 37}{space 1}    0.50{col 46}{space 3}0.615{col 54}{space 4}  .504433{col 67}{space 3} 3.177279
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.36e-18{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 3.17e-18{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.411974{col 26}{space 2} .7456625{col 37}{space 1}    0.65{col 46}{space 3}0.514{col 54}{space 4} .5015422{col 67}{space 3} 3.975078
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} .7516662{col 26}{space 2}  .777916{col 37}{space 1}   -0.28{col 46}{space 3}0.783{col 54}{space 4} .0988776{col 67}{space 3} 5.714159
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective1adjusteditudeath_ethnicity_nomiss, replace
{res}{txt}(note: file output/data/primaryobjective1adjusteditudeath_ethnicity_nomiss.ster not found)
{txt}file output/data/primaryobjective1adjusteditudeath_ethnicity_nomiss.ster saved

{com}.  
. /*Primary objective 2========================================================================*/
. stset stop, id(patient_id) failure(died_ons_covid_flag_any==1) origin(time enter_date) scale(365.25) ///
>                 exit(died_ons_covid_flag_any==1 time stop)

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}died_ons_covid_flag_any == 1
{txt}obs. time interval:  {res}(stop[_n-1], stop]
{txt} exit on or before:  {res}died_ons_covid_flag_any==1 time stop
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}          0{txt}  exclusions
{hline 78}
{res}     39,354{txt}  observations remaining, representing
{res}     39,354{txt}  subjects
{res}      3,937{txt}  failures in single-failure-per-subject data
{res} 22,476.983{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}.                 
. *2a: TNF vs standard systemics
. 
. strate standtnf, per(1000) output(standtnf,replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Estimated rates (per 1000) and lower/upper bounds of 95% confidence intervals
({res}30417{txt} records included in the analysis)

  {c TLC}{hline 10}{c -}{hline 6}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c TRC}
  {c |} {res}standtnf      D         Y     Rate    Lower    Upper {txt}{c |}
  {c LT}{hline 10}{c -}{hline 6}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}       0    935    5.1940   180.02   168.84   191.93 {txt}{c |}
  {c |} {res}       1   2109   12.1796   173.16   165.92   180.71 {txt}{c |}
  {c BLC}{hline 10}{c -}{hline 6}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c BRC}


{com}. 
. stcox standtnf

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-31261.041
{txt}Iteration 1:   log likelihood = {res}-31260.584
{txt}Iteration 2:   log likelihood = {res}-31260.584
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-31260.584

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      30,417                  {txt}Number of obs    =  {res}    30,417
{txt}No. of failures = {res}       3,044
{txt}Time at risk    = {res} 17373.56879
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.91
{txt}Log likelihood  =   {res}-31260.584                  {txt}Prob > chi2      =  {res}    0.3390

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} .9630455{col 26}{space 2} .0378377{col 37}{space 1}   -0.96{col 46}{space 3}0.338{col 54}{space 4} .8916684{col 67}{space 3} 1.040136
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2aunadj, replace
{res}{txt}(note: file output/data/primaryobjective2aunadj.ster not found)
{txt}file output/data/primaryobjective2aunadj.ster saved

{com}. 
. sts graph, by(standtnf) xtitle("Analysis time (years)") saving(primeob2a, replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2a.gph not found)
{res}{txt}(file primeob2a.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2a.pdf", as(pdf) replace
{txt}(file output/figures/primeob2a.pdf written in PDF format)

{com}. sts graph, cumhaz by(standtnf) xtitle("Analysis time (years)") tmax(0.58) legend(order(1 "Standard Systemic" 2 "TNF")) saving(primeob2a_NA, replace)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2a_NA.gph not found)
{res}{txt}(file primeob2a_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2a_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob2a_NA.pdf written in PDF format)

{com}. 
. ** Testing assumptions of proportional hazard model
. stcox standtnf

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-31261.041
{txt}Iteration 1:   log likelihood = {res}-31260.584
{txt}Iteration 2:   log likelihood = {res}-31260.584
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-31260.584

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      30,417                  {txt}Number of obs    =  {res}    30,417
{txt}No. of failures = {res}       3,044
{txt}Time at risk    = {res} 17373.56879
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.91
{txt}Log likelihood  =   {res}-31260.584                  {txt}Prob > chi2      =  {res}    0.3390

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} .9630455{col 26}{space 2} .0378377{col 37}{space 1}   -0.96{col 46}{space 3}0.338{col 54}{space 4} .8916684{col 67}{space 3} 1.040136
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. stptime, per (1000) by (standtnf)

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id
{txt}(8937 missing values generated)

  standtnf{col 12}{c |}{col 15}person-time{col 29}failures{col 45}rate{col 52}[95% Conf. Interval]
{hline 11}{c +}{hline 59}
         0{col 12}{c |}{col 16}{res} 5193.9795{col 29}     935{col 39} 180.01611{col 51} 168.8395{col 63} 191.9326
         {txt}1{col 12}{c |}{col 16}{res} 12179.589{col 29}    2109{col 39} 173.15855{col 51} 165.9239{col 63} 180.7087
{txt}{hline 11}{c +}{hline 59}
     total{col 12}{c |}{col 16}{res} 17373.569{col 29}    3044{col 39} 175.20868{col 51} 169.0938{col 63} 181.5447
{txt}
{com}. stphtest, log detail

{txt}      Test of proportional-hazards assumption

      Time:  {res}Log(t)
{txt}      {hline 12}{c TT}{hline 51}
                  {c |}       rho            chi2       df       Prob>chi2
      {hline 12}{c +}{hline 51}
      standtnf{col 19}{c |}{res}{col 25} 0.00513{col 37}     0.08{col 50}    1{col 64}0.7771
{txt}      {hline 12}{c +}{hline 51}
      global test {c |}{res}{col 37}     0.08{col 50}    1{col 64}0.7771
{txt}      {hline 12}{c BT}{hline 51}

{com}. stphtest, log plot(standtnf) yline(0) 
{res}{txt}
{com}. 
. *if TVC significant, need to use models with tvc
. stcox standtnf, tvc(standtnf) 

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-31261.041
{txt}Iteration 1:   log likelihood = {res}-31260.582
{txt}Iteration 2:   log likelihood = {res}-31260.582
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-31260.582

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      30,417                  {txt}Number of obs    =  {res}    30,417
{txt}No. of failures = {res}       3,044
{txt}Time at risk    = {res} 17373.56879
                                                {txt}LR chi2({res}2{txt})       =  {res}      0.92
{txt}Log likelihood  =   {res}-31260.582                  {txt}Prob > chi2      =  {res}    0.6317

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 4}standtnf {c |}{col 14}{res}{space 2} .9440966{col 26}{space 2} .2736675{col 37}{space 1}   -0.20{col 46}{space 3}0.843{col 54}{space 4}  .534905{col 67}{space 3} 1.666311
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.035523{col 26}{space 2} .5224386{col 37}{space 1}    0.07{col 46}{space 3}0.945{col 54}{space 4}  .385225{col 67}{space 3} 2.783589
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2aTVCtest, replace 
{res}{txt}(note: file output/data/primaryobjective2aTVCtest.ster not found)
{txt}file output/data/primaryobjective2aTVCtest.ster saved

{com}. 
. stcox standtnf i.agegroup male

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-31261.041
{txt}Iteration 1:   log likelihood = {res}-31257.113
{txt}Iteration 2:   log likelihood = {res}-31257.108
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-31257.108

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      30,417                  {txt}Number of obs    =  {res}    30,417
{txt}No. of failures = {res}       3,044
{txt}Time at risk    = {res} 17373.56879
                                                {txt}LR chi2({res}7{txt})       =  {res}      7.87
{txt}Log likelihood  =   {res}-31257.108                  {txt}Prob > chi2      =  {res}    0.3446

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} .9622839{col 26}{space 2} .0378099{col 37}{space 1}   -0.98{col 46}{space 3}0.328{col 54}{space 4} .8909596{col 67}{space 3} 1.039318
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .9881736{col 26}{space 2} .0528155{col 37}{space 1}   -0.22{col 46}{space 3}0.824{col 54}{space 4} .8898946{col 67}{space 3} 1.097307
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .9968277{col 26}{space 2} .0524365{col 37}{space 1}   -0.06{col 46}{space 3}0.952{col 54}{space 4} .8991746{col 67}{space 3} 1.105086
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .9287545{col 26}{space 2} .0546878{col 37}{space 1}   -1.26{col 46}{space 3}0.209{col 54}{space 4} .8275222{col 67}{space 3} 1.042371
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .8728108{col 26}{space 2} .0582956{col 37}{space 1}   -2.04{col 46}{space 3}0.042{col 54}{space 4} .7657161{col 67}{space 3} .9948839
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.035523{col 26}{space 2} .0787172{col 37}{space 1}    0.46{col 46}{space 3}0.646{col 54}{space 4} .8921834{col 67}{space 3} 1.201892
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} .9699034{col 26}{space 2} .0351787{col 37}{space 1}   -0.84{col 46}{space 3}0.399{col 54}{space 4}  .903348{col 67}{space 3} 1.041362
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2alimitedadj, replace
{res}{txt}(note: file output/data/primaryobjective2alimitedadj.ster not found)
{txt}file output/data/primaryobjective2alimitedadj.ster saved

{com}. 
. stcox standtnf i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1109.5798
{txt}Iteration 1:   log likelihood = {res}-1102.3071
{txt}Iteration 2:   log likelihood = {res}-1101.9972
{txt}Iteration 3:   log likelihood = {res}-1101.9213
{txt}Iteration 4:   log likelihood = {res}-1101.8934
{txt}Iteration 5:   log likelihood = {res}-1101.8832
{txt}Iteration 6:   log likelihood = {res}-1101.8794
{txt}Iteration 7:   log likelihood = {res} -1101.878
{txt}Iteration 8:   log likelihood = {res}-1101.8775
{txt}Iteration 9:   log likelihood = {res}-1101.8773
{txt}Iteration 10:  log likelihood = {res}-1101.8773
{txt}Iteration 11:  log likelihood = {res}-1101.8772
{txt}Iteration 12:  log likelihood = {res}-1101.8772
{txt}Iteration 13:  log likelihood = {res}-1101.8772
{txt}Iteration 14:  log likelihood = {res}-1101.8772
{txt}Iteration 15:  log likelihood = {res}-1101.8772
{txt}Iteration 16:  log likelihood = {res}-1101.8772
{txt}Iteration 17:  log likelihood = {res}-1101.8772
{txt}Iteration 18:  log likelihood = {res}-1101.8772
{txt}Iteration 19:  log likelihood = {res}-1101.8772
{txt}Iteration 20:  log likelihood = {res}-1101.8772
{txt}Iteration 21:  log likelihood = {res}-1101.8772
{txt}Iteration 22:  log likelihood = {res}-1101.8772
{txt}Iteration 23:  log likelihood = {res}-1101.8772
{txt}Iteration 24:  log likelihood = {res}-1101.8772
{txt}Iteration 25:  log likelihood = {res}-1101.8772
{txt}Iteration 26:  log likelihood = {res}-1101.8772
{txt}Iteration 27:  log likelihood = {res}-1101.8772
{txt}Iteration 28:  log likelihood = {res}-1101.8772
{txt}Iteration 29:  log likelihood = {res}-1101.8772
{txt}Iteration 30:  log likelihood = {res}-1101.8772
{txt}Iteration 31:  log likelihood = {res}-1101.8772
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1101.8772
{txt}Iteration 1:   log likelihood = {res}-1101.8772

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,571                  {txt}Number of obs    =  {res}     1,571
{txt}No. of failures = {res}         152
{txt}Time at risk    = {res}  896.164271
                                                {txt}LR chi2({res}20{txt})      =  {res}     15.41
{txt}Log likelihood  =   {res}-1101.8772                  {txt}Prob > chi2      =  {res}    0.7528

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.079831{col 26}{space 2} .1960434{col 37}{space 1}    0.42{col 46}{space 3}0.672{col 54}{space 4} .7565196{col 67}{space 3} 1.541316
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .9545644{col 26}{space 2}  .239774{col 37}{space 1}   -0.19{col 46}{space 3}0.853{col 54}{space 4} .5834379{col 67}{space 3} 1.561766
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.420835{col 26}{space 2} .3186764{col 37}{space 1}    1.57{col 46}{space 3}0.117{col 54}{space 4} .9154389{col 67}{space 3} 2.205251
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.091732{col 26}{space 2} .2874756{col 37}{space 1}    0.33{col 46}{space 3}0.739{col 54}{space 4}  .651594{col 67}{space 3} 1.829174
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .9322355{col 26}{space 2} .2706862{col 37}{space 1}   -0.24{col 46}{space 3}0.809{col 54}{space 4} .5276776{col 67}{space 3} 1.646958
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8388809{col 26}{space 2}  .306698{col 37}{space 1}   -0.48{col 46}{space 3}0.631{col 54}{space 4} .4097301{col 67}{space 3} 1.717524
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.270284{col 26}{space 2} .2081132{col 37}{space 1}    1.46{col 46}{space 3}0.144{col 54}{space 4} .9213974{col 67}{space 3} 1.751278
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .9948668{col 26}{space 2} .2075422{col 37}{space 1}   -0.02{col 46}{space 3}0.980{col 54}{space 4} .6609874{col 67}{space 3} 1.497396
{txt}5 most de..  {c |}{col 14}{res}{space 2}  1.55233{col 26}{space 2} .3670781{col 37}{space 1}    1.86{col 46}{space 3}0.063{col 54}{space 4} .9765648{col 67}{space 3} 2.467555
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9520731{col 26}{space 2} .0498136{col 37}{space 1}   -0.94{col 46}{space 3}0.348{col 54}{space 4} .8592794{col 67}{space 3} 1.054888
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} .9616893{col 26}{space 2} .1680137{col 37}{space 1}   -0.22{col 46}{space 3}0.823{col 54}{space 4} .6828481{col 67}{space 3} 1.354396
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .9061396{col 26}{space 2} .1559671{col 37}{space 1}   -0.57{col 46}{space 3}0.567{col 54}{space 4} .6466721{col 67}{space 3} 1.269715
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.053933{col 26}{space 2} .1846612{col 37}{space 1}    0.30{col 46}{space 3}0.764{col 54}{space 4} .7476054{col 67}{space 3} 1.485775
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .7720035{col 26}{space 2}  .170274{col 37}{space 1}   -1.17{col 46}{space 3}0.241{col 54}{space 4} .5010456{col 67}{space 3} 1.189491
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .8470134{col 26}{space 2} .1889417{col 37}{space 1}   -0.74{col 46}{space 3}0.457{col 54}{space 4}  .547034{col 67}{space 3} 1.311494
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.142969{col 26}{space 2} .1860346{col 37}{space 1}    0.82{col 46}{space 3}0.412{col 54}{space 4} .8307864{col 67}{space 3} 1.572461
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 1.36e-14{col 26}{space 2} 1.46e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.30e-14{col 26}{space 2} 2.62e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .9054607{col 26}{space 2} .1994994{col 37}{space 1}   -0.45{col 46}{space 3}0.652{col 54}{space 4} .5879292{col 67}{space 3} 1.394486
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.032309{col 26}{space 2} .2922724{col 37}{space 1}    0.11{col 46}{space 3}0.911{col 54}{space 4} .5926704{col 67}{space 3} 1.798068
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2aadjusted, replace
{res}{txt}(note: file output/data/primaryobjective2aadjusted.ster not found)
{txt}file output/data/primaryobjective2aadjusted.ster saved

{com}. 
. *TVC analyses
. stcox standtnf i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat, tvc(standtnf) 

         {txt}failure _d:  {res}died_ons_covid_flag_any == 1
   {txt}analysis time _t:  {res}(stop-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}died_ons_covid_flag_any==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-1109.5798
{txt}Iteration 1:   log likelihood = {res}-1102.2936
{txt}Iteration 2:   log likelihood = {res}-1101.9837
{txt}Iteration 3:   log likelihood = {res}-1101.9079
{txt}Iteration 4:   log likelihood = {res}  -1101.88
{txt}Iteration 5:   log likelihood = {res}-1101.8697
{txt}Iteration 6:   log likelihood = {res}-1101.8659
{txt}Iteration 7:   log likelihood = {res}-1101.8646
{txt}Iteration 8:   log likelihood = {res}-1101.8641
{txt}Iteration 9:   log likelihood = {res}-1101.8639
{txt}Iteration 10:  log likelihood = {res}-1101.8638
{txt}Iteration 11:  log likelihood = {res}-1101.8638
{txt}Iteration 12:  log likelihood = {res}-1101.8638
{txt}Iteration 13:  log likelihood = {res}-1101.8638
{txt}Iteration 14:  log likelihood = {res}-1101.8638
{txt}Iteration 15:  log likelihood = {res}-1101.8638
{txt}Iteration 16:  log likelihood = {res}-1101.8638
{txt}Iteration 17:  log likelihood = {res}-1101.8638
{txt}Iteration 18:  log likelihood = {res}-1101.8638
{txt}Iteration 19:  log likelihood = {res}-1101.8638
{txt}Iteration 20:  log likelihood = {res}-1101.8638
{txt}Iteration 21:  log likelihood = {res}-1101.8638
{txt}Iteration 22:  log likelihood = {res}-1101.8638
{txt}Iteration 23:  log likelihood = {res}-1101.8638
{txt}Iteration 24:  log likelihood = {res}-1101.8638
{txt}Iteration 25:  log likelihood = {res}-1101.8638
{txt}Iteration 26:  log likelihood = {res}-1101.8638
{txt}Iteration 27:  log likelihood = {res}-1101.8638
{txt}Iteration 28:  log likelihood = {res}-1101.8638
{txt}Iteration 29:  log likelihood = {res}-1101.8638
{txt}Iteration 30:  log likelihood = {res}-1101.8638
{txt}Iteration 31:  log likelihood = {res}-1101.8638
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-1101.8638
{txt}Iteration 1:   log likelihood = {res}-1101.8638

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,571                  {txt}Number of obs    =  {res}     1,571
{txt}No. of failures = {res}         152
{txt}Time at risk    = {res}  896.164271
                                                {txt}LR chi2({res}21{txt})      =  {res}     15.43
{txt}Log likelihood  =   {res}-1101.8638                  {txt}Prob > chi2      =  {res}    0.8007

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.323999{col 26}{space 2} 1.679004{col 37}{space 1}    0.22{col 46}{space 3}0.825{col 54}{space 4} .1102689{col 67}{space 3} 15.89726
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .9546096{col 26}{space 2} .2397855{col 37}{space 1}   -0.18{col 46}{space 3}0.853{col 54}{space 4} .5834654{col 67}{space 3}  1.56184
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.420925{col 26}{space 2} .3186969{col 37}{space 1}    1.57{col 46}{space 3}0.117{col 54}{space 4} .9154966{col 67}{space 3} 2.205392
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.091805{col 26}{space 2} .2874954{col 37}{space 1}    0.33{col 46}{space 3}0.739{col 54}{space 4} .6516372{col 67}{space 3} 1.829298
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .9322755{col 26}{space 2} .2706985{col 37}{space 1}   -0.24{col 46}{space 3}0.809{col 54}{space 4} .5276994{col 67}{space 3} 1.647031
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8389238{col 26}{space 2} .3067138{col 37}{space 1}   -0.48{col 46}{space 3}0.631{col 54}{space 4} .4097509{col 67}{space 3} 1.717612
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.270283{col 26}{space 2} .2081135{col 37}{space 1}    1.46{col 46}{space 3}0.144{col 54}{space 4} .9213955{col 67}{space 3} 1.751277
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .9949097{col 26}{space 2} .2075511{col 37}{space 1}   -0.02{col 46}{space 3}0.980{col 54}{space 4} .6610159{col 67}{space 3} 1.497461
{txt}5 most de..  {c |}{col 14}{res}{space 2}  1.55239{col 26}{space 2} .3670923{col 37}{space 1}    1.86{col 46}{space 3}0.063{col 54}{space 4} .9766025{col 67}{space 3} 2.467651
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9520596{col 26}{space 2}  .049813{col 37}{space 1}   -0.94{col 46}{space 3}0.348{col 54}{space 4}  .859267{col 67}{space 3} 1.054873
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} .9616609{col 26}{space 2} .1680096{col 37}{space 1}   -0.22{col 46}{space 3}0.823{col 54}{space 4} .6828267{col 67}{space 3} 1.354358
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .9061229{col 26}{space 2} .1559646{col 37}{space 1}   -0.57{col 46}{space 3}0.567{col 54}{space 4} .6466595{col 67}{space 3} 1.269692
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.053951{col 26}{space 2} .1846651{col 37}{space 1}    0.30{col 46}{space 3}0.764{col 54}{space 4} .7476175{col 67}{space 3} 1.485803
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .7719959{col 26}{space 2} .1702721{col 37}{space 1}   -1.17{col 46}{space 3}0.241{col 54}{space 4} .5010409{col 67}{space 3} 1.189479
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} .8470161{col 26}{space 2} .1889426{col 37}{space 1}   -0.74{col 46}{space 3}0.457{col 54}{space 4} .5470354{col 67}{space 3} 1.311499
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.142968{col 26}{space 2} .1860345{col 37}{space 1}    0.82{col 46}{space 3}0.412{col 54}{space 4} .8307856{col 67}{space 3} 1.572459
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 1.36e-14{col 26}{space 2} 1.46e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.30e-14{col 26}{space 2} 2.62e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} .9053886{col 26}{space 2} .1994841{col 37}{space 1}   -0.45{col 46}{space 3}0.652{col 54}{space 4} .5878817{col 67}{space 3} 1.394377
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 1.032241{col 26}{space 2} .2922525{col 37}{space 1}    0.11{col 46}{space 3}0.911{col 54}{space 4} .5926324{col 67}{space 3} 1.797947
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 4}standtnf {c |}{col 14}{res}{space 2} .6968755{col 26}{space 2} 1.547957{col 37}{space 1}   -0.16{col 46}{space 3}0.871{col 54}{space 4} .0089618{col 67}{space 3}  54.1893
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2aadjustedTVC, replace
{res}{txt}(note: file output/data/primaryobjective2aadjustedTVC.ster not found)
{txt}file output/data/primaryobjective2aadjustedTVC.ster saved

{com}. 
. *include ICU in composite now for 2a
. 
. stset stopicu, id(patient_id) failure(icu_or_death_covid==1) origin(time enter_date) scale(365.25) ///
>                 exit(icu_or_death_covid==1 time stop)

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}icu_or_death_covid == 1
{txt}obs. time interval:  {res}(stopicu[_n-1], stopicu]
{txt} exit on or before:  {res}icu_or_death_covid==1 time stop
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}          0{txt}  exclusions
{hline 78}
{res}     39,354{txt}  observations remaining, representing
{res}     39,354{txt}  subjects
{res}        441{txt}  failures in single-failure-per-subject data
{res} 22,473.153{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}.                 
. strate standtnf, per(1000) output(standtnf,replace)

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Estimated rates (per 1000) and lower/upper bounds of 95% confidence intervals
({res}30417{txt} records included in the analysis)

  {c TLC}{hline 10}{c -}{hline 5}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c TRC}
  {c |} {res}standtnf     D         Y     Rate    Lower    Upper {txt}{c |}
  {c LT}{hline 10}{c -}{hline 5}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c RT}
  {c |} {res}       0   116    5.1933   22.336   18.620   26.795 {txt}{c |}
  {c |} {res}       1   230   12.1773   18.888   16.598   21.493 {txt}{c |}
  {c BLC}{hline 10}{c -}{hline 5}{c -}{hline 9}{c -}{hline 8}{c -}{hline 8}{c -}{hline 8}{c BRC}


{com}. stcox standtnf

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-3558.0182
{txt}Iteration 1:   log likelihood = {res}-3556.9628
{txt}Iteration 2:   log likelihood = {res}-3556.9617
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-3556.9617

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      30,417                  {txt}Number of obs    =  {res}    30,417
{txt}No. of failures = {res}         346
{txt}Time at risk    = {res} 17370.61465
                                                {txt}LR chi2({res}1{txt})       =  {res}      2.11
{txt}Log likelihood  =   {res}-3556.9617                  {txt}Prob > chi2      =  {res}    0.1461

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} .8460819{col 26}{space 2} .0963513{col 37}{space 1}   -1.47{col 46}{space 3}0.142{col 54}{space 4} .6768276{col 67}{space 3} 1.057662
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2aunadj_inc_icu, replace
{res}{txt}(note: file output/data/primaryobjective2aunadj_inc_icu.ster not found)
{txt}file output/data/primaryobjective2aunadj_inc_icu.ster saved

{com}. 
. sts graph, by(standtnf) xtitle("Analysis time (years)") saving(primeob2a_inc_icu, replace)

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2a_inc_icu.gph not found)
{res}{txt}(file primeob2a_inc_icu.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2a_inc_icu.pdf", as(pdf) replace
{txt}(file output/figures/primeob2a_inc_icu.pdf written in PDF format)

{com}. sts graph, cumhaz by(standtnf) xtitle("Analysis time (years)") tmax(0.58) legend(order(1 "Standard Systemic" 2 "TNF")) saving(primeob2a_inc_icu_NA, replace)

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2a_inc_icu_NA.gph not found)
{res}{txt}(file primeob2a_inc_icu_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2a_inc_icu_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob2a_inc_icu_NA.pdf written in PDF format)

{com}. 
. stcox standtnf i.agegroup male

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-3558.0182
{txt}Iteration 1:   log likelihood = {res}-3556.2442
{txt}Iteration 2:   log likelihood = {res}-3556.2421
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-3556.2421

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      30,417                  {txt}Number of obs    =  {res}    30,417
{txt}No. of failures = {res}         346
{txt}Time at risk    = {res} 17370.61465
                                                {txt}LR chi2({res}7{txt})       =  {res}      3.55
{txt}Log likelihood  =   {res}-3556.2421                  {txt}Prob > chi2      =  {res}    0.8297

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} .8462802{col 26}{space 2} .0963793{col 37}{space 1}   -1.47{col 46}{space 3}0.143{col 54}{space 4} .6769778{col 67}{space 3} 1.057923
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2}   .89793{col 26}{space 2} .1488571{col 37}{space 1}   -0.65{col 46}{space 3}0.516{col 54}{space 4} .6488316{col 67}{space 3} 1.242662
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .9798475{col 26}{space 2} .1552936{col 37}{space 1}   -0.13{col 46}{space 3}0.898{col 54}{space 4} .7182137{col 67}{space 3} 1.336791
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.099015{col 26}{space 2} .1821931{col 37}{space 1}    0.57{col 46}{space 3}0.569{col 54}{space 4} .7941323{col 67}{space 3} 1.520949
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .9815489{col 26}{space 2} .1873914{col 37}{space 1}   -0.10{col 46}{space 3}0.922{col 54}{space 4} .6751583{col 67}{space 3} 1.426981
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.095116{col 26}{space 2} .2437506{col 37}{space 1}    0.41{col 46}{space 3}0.683{col 54}{space 4} .7079458{col 67}{space 3} 1.694027
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.042977{col 26}{space 2}  .112154{col 37}{space 1}    0.39{col 46}{space 3}0.696{col 54}{space 4} .8447781{col 67}{space 3} 1.287676
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2limitedadj_inc_icu, replace
{res}{txt}(note: file output/data/primaryobjective2limitedadj_inc_icu.ster not found)
{txt}file output/data/primaryobjective2limitedadj_inc_icu.ster saved

{com}. 
. stcox standtnf i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-160.95798
{txt}Iteration 1:   log likelihood = {res}-151.59942
{txt}Iteration 2:   log likelihood = {res}-151.12417
{txt}Iteration 3:   log likelihood = {res} -151.1082
{txt}Iteration 4:   log likelihood = {res}-151.10493
{txt}Iteration 5:   log likelihood = {res}-151.10373
{txt}Iteration 6:   log likelihood = {res}-151.10329
{txt}Iteration 7:   log likelihood = {res}-151.10313
{txt}Iteration 8:   log likelihood = {res}-151.10307
{txt}Iteration 9:   log likelihood = {res}-151.10305
{txt}Iteration 10:  log likelihood = {res}-151.10304
{txt}Iteration 11:  log likelihood = {res}-151.10303
{txt}Iteration 12:  log likelihood = {res}-151.10303
{txt}Iteration 13:  log likelihood = {res}-151.10303
{txt}Iteration 14:  log likelihood = {res}-151.10303
{txt}Iteration 15:  log likelihood = {res}-151.10303
{txt}Iteration 16:  log likelihood = {res}-151.10303
{txt}Iteration 17:  log likelihood = {res}-151.10303
{txt}Iteration 18:  log likelihood = {res}-151.10303
{txt}Iteration 19:  log likelihood = {res}-151.10303
{txt}Iteration 20:  log likelihood = {res}-151.10303
{txt}Iteration 21:  log likelihood = {res}-151.10303
{txt}Iteration 22:  log likelihood = {res}-151.10303
{txt}Iteration 23:  log likelihood = {res}-151.10303
{txt}Iteration 24:  log likelihood = {res}-151.10303
{txt}Iteration 25:  log likelihood = {res}-151.10303
{txt}Iteration 26:  log likelihood = {res}-151.10303
{txt}Iteration 27:  log likelihood = {res}-151.10303
{txt}Iteration 28:  log likelihood = {res}-151.10303
{txt}Iteration 29:  log likelihood = {res}-151.10303
{txt}Iteration 30:  log likelihood = {res}-151.10303
{txt}Iteration 31:  log likelihood = {res}-151.10303
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-151.10303
{txt}Iteration 1:   log likelihood = {res}-151.10303

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,571                  {txt}Number of obs    =  {res}     1,571
{txt}No. of failures = {res}          22
{txt}Time at risk    = {res}  896.164271
                                                {txt}LR chi2({res}20{txt})      =  {res}     19.71
{txt}Log likelihood  =   {res}-151.10303                  {txt}Prob > chi2      =  {res}    0.4762

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.890105{col 26}{space 2} 1.052463{col 37}{space 1}    1.14{col 46}{space 3}0.253{col 54}{space 4} .6346194{col 67}{space 3} 5.629354
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2}  .480455{col 26}{space 2} .3155578{col 37}{space 1}   -1.12{col 46}{space 3}0.264{col 54}{space 4}  .132615{col 67}{space 3} 1.740656
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .1761416{col 26}{space 2} .1848256{col 37}{space 1}   -1.65{col 46}{space 3}0.098{col 54}{space 4} .0225266{col 67}{space 3} 1.377302
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .6064137{col 26}{space 2} .3998831{col 37}{space 1}   -0.76{col 46}{space 3}0.448{col 54}{space 4} .1665203{col 67}{space 3} 2.208365
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .5163969{col 26}{space 2} .3998535{col 37}{space 1}   -0.85{col 46}{space 3}0.393{col 54}{space 4} .1132103{col 67}{space 3} 2.355489
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .7113182{col 26}{space 2} .5487176{col 37}{space 1}   -0.44{col 46}{space 3}0.659{col 54}{space 4} .1568336{col 67}{space 3} 3.226182
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.155513{col 26}{space 2} .4987313{col 37}{space 1}    0.33{col 46}{space 3}0.738{col 54}{space 4} .4958925{col 67}{space 3}  2.69254
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .3931306{col 26}{space 2} .2948046{col 37}{space 1}   -1.25{col 46}{space 3}0.213{col 54}{space 4} .0904127{col 67}{space 3} 1.709402
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.080491{col 26}{space 2} .6808566{col 37}{space 1}    0.12{col 46}{space 3}0.902{col 54}{space 4} .3142303{col 67}{space 3} 3.715302
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.344695{col 26}{space 2} .2216569{col 37}{space 1}    1.80{col 46}{space 3}0.072{col 54}{space 4} .9734495{col 67}{space 3} 1.857523
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} .7927014{col 26}{space 2} .3745538{col 37}{space 1}   -0.49{col 46}{space 3}0.623{col 54}{space 4}  .313989{col 67}{space 3} 2.001266
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6646887{col 26}{space 2} .3166357{col 37}{space 1}   -0.86{col 46}{space 3}0.391{col 54}{space 4} .2612968{col 67}{space 3}  1.69084
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .7196003{col 26}{space 2} .3443644{col 37}{space 1}   -0.69{col 46}{space 3}0.492{col 54}{space 4} .2816756{col 67}{space 3} 1.838372
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .4146504{col 26}{space 2} .3098267{col 37}{space 1}   -1.18{col 46}{space 3}0.239{col 54}{space 4}  .095866{col 67}{space 3} 1.793493
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} 2.377864{col 26}{space 2} 1.106332{col 37}{space 1}    1.86{col 46}{space 3}0.063{col 54}{space 4} .9553327{col 67}{space 3} 5.918607
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.016807{col 26}{space 2} .4377891{col 37}{space 1}    0.04{col 46}{space 3}0.969{col 54}{space 4} .4372715{col 67}{space 3} 2.364426
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 1.45e-14{col 26}{space 2} 4.54e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 9.33e-15{col 26}{space 2} 5.46e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.502825{col 26}{space 2} .7293953{col 37}{space 1}    0.84{col 46}{space 3}0.401{col 54}{space 4} .5804679{col 67}{space 3} 3.890797
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} .4931803{col 26}{space 2} .5072872{col 37}{space 1}   -0.69{col 46}{space 3}0.492{col 54}{space 4} .0656835{col 67}{space 3} 3.703011
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2aadjusted_inc_icu, replace
{res}{txt}(note: file output/data/primaryobjective2aadjusted_inc_icu.ster not found)
{txt}file output/data/primaryobjective2aadjusted_inc_icu.ster saved

{com}. 
. *2a sensitivity 1: TNF combo v monotherapy (keep to just death or icu)
. stcox tnfmono i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-125.37994
{txt}Iteration 1:   log likelihood = {res}-113.86771
{txt}Iteration 2:   log likelihood = {res} -112.5598
{txt}Iteration 3:   log likelihood = {res}-112.32347
{txt}Iteration 4:   log likelihood = {res}-112.23912
{txt}Iteration 5:   log likelihood = {res}-112.20828
{txt}Iteration 6:   log likelihood = {res}-112.19695
{txt}Iteration 7:   log likelihood = {res}-112.19279
{txt}Iteration 8:   log likelihood = {res}-112.19126
{txt}Iteration 9:   log likelihood = {res} -112.1907
{txt}Iteration 10:  log likelihood = {res}-112.19049
{txt}Iteration 11:  log likelihood = {res}-112.19042
{txt}Iteration 12:  log likelihood = {res}-112.19039
{txt}Iteration 13:  log likelihood = {res}-112.19038
{txt}Iteration 14:  log likelihood = {res}-112.19037
{txt}Iteration 15:  log likelihood = {res}-112.19037
{txt}Iteration 16:  log likelihood = {res}-112.19037
{txt}Iteration 17:  log likelihood = {res}-112.19037
{txt}Iteration 18:  log likelihood = {res}-112.19037
{txt}Iteration 19:  log likelihood = {res}-112.19037
{txt}Iteration 20:  log likelihood = {res}-112.19037
{txt}Iteration 21:  log likelihood = {res}-112.19037
{txt}Iteration 22:  log likelihood = {res}-112.19037
{txt}Iteration 23:  log likelihood = {res}-112.19037
{txt}Iteration 24:  log likelihood = {res}-112.19037
{txt}Iteration 25:  log likelihood = {res}-112.19037
{txt}Iteration 26:  log likelihood = {res}-112.19037
{txt}Iteration 27:  log likelihood = {res}-112.19037
{txt}Iteration 28:  log likelihood = {res}-112.19037
{txt}Iteration 29:  log likelihood = {res}-112.19037
{txt}Iteration 30:  log likelihood = {res}-112.19037
{txt}Iteration 31:  log likelihood = {res}-112.19037
{txt}Iteration 32:  log likelihood = {res}-112.19037
{txt}Iteration 33:  log likelihood = {res}-112.19037
{txt}Iteration 34:  log likelihood = {res}-112.19037
{txt}Iteration 35:  log likelihood = {res}-112.19037
{txt}Iteration 36:  log likelihood = {res}-112.19037
{txt}Iteration 37:  log likelihood = {res}-112.19037
{txt}Iteration 38:  log likelihood = {res}-112.19037
{txt}Iteration 39:  log likelihood = {res}-112.19037
{txt}Iteration 40:  log likelihood = {res}-112.19037
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-112.19037
{txt}Iteration 1:   log likelihood = {res}-112.19037

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,109                  {txt}Number of obs    =  {res}     1,109
{txt}No. of failures = {res}          18
{txt}Time at risk    = {res} 632.3778234
                                                {txt}LR chi2({res}18{txt})      =  {res}     26.38
{txt}Log likelihood  =   {res}-112.19037                  {txt}Prob > chi2      =  {res}    0.0914

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 5}tnfmono {c |}{col 14}{res}{space 2} .4226148{col 26}{space 2} .3195067{col 37}{space 1}   -1.14{col 46}{space 3}0.255{col 54}{space 4}  .096032{col 67}{space 3} 1.859829
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .3508347{col 26}{space 2} .2802695{col 37}{space 1}   -1.31{col 46}{space 3}0.190{col 54}{space 4} .0733006{col 67}{space 3} 1.679181
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 7.96e-19{col 26}{space 2} 3.97e-10{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .6674937{col 26}{space 2} .4579985{col 37}{space 1}   -0.59{col 46}{space 3}0.556{col 54}{space 4} .1739395{col 67}{space 3} 2.561511
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .6013075{col 26}{space 2} .4797446{col 37}{space 1}   -0.64{col 46}{space 3}0.524{col 54}{space 4}  .125886{col 67}{space 3} 2.872206
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8232591{col 26}{space 2} .6491376{col 37}{space 1}   -0.25{col 46}{space 3}0.805{col 54}{space 4} .1755361{col 67}{space 3} 3.861061
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.016592{col 26}{space 2} .4962461{col 37}{space 1}    0.03{col 46}{space 3}0.973{col 54}{space 4} .3905129{col 67}{space 3} 2.646415
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .5278656{col 26}{space 2} .4046773{col 37}{space 1}   -0.83{col 46}{space 3}0.405{col 54}{space 4} .1174809{col 67}{space 3} 2.371808
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.210158{col 26}{space 2} .7968407{col 37}{space 1}    0.29{col 46}{space 3}0.772{col 54}{space 4} .3329351{col 67}{space 3}   4.3987
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.654162{col 26}{space 2} .3493024{col 37}{space 1}    2.38{col 46}{space 3}0.017{col 54}{space 4} 1.093536{col 67}{space 3} 2.502203
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.056387{col 26}{space 2} .5708661{col 37}{space 1}    0.10{col 46}{space 3}0.919{col 54}{space 4} .3663013{col 67}{space 3} 3.046547
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .5935779{col 26}{space 2} .3152422{col 37}{space 1}   -0.98{col 46}{space 3}0.326{col 54}{space 4} .2096113{col 67}{space 3} 1.680896
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .6500051{col 26}{space 2} .3498239{col 37}{space 1}   -0.80{col 46}{space 3}0.423{col 54}{space 4} .2263663{col 67}{space 3} 1.866474
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5160663{col 26}{space 2} .3923617{col 37}{space 1}   -0.87{col 46}{space 3}0.384{col 54}{space 4} .1162901{col 67}{space 3} 2.290173
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} 2.916514{col 26}{space 2} 1.534888{col 37}{space 1}    2.03{col 46}{space 3}0.042{col 54}{space 4} 1.039676{col 67}{space 3} 8.181448
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.020386{col 26}{space 2} .4908153{col 37}{space 1}    0.04{col 46}{space 3}0.967{col 54}{space 4} .3974918{col 67}{space 3} 2.619392
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.00e-18{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 2.58e-18{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 2.103942{col 26}{space 2} 1.077378{col 37}{space 1}    1.45{col 46}{space 3}0.146{col 54}{space 4}  .771177{col 67}{space 3} 5.740022
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} .5766733{col 26}{space 2} .5987593{col 37}{space 1}   -0.53{col 46}{space 3}0.596{col 54}{space 4} .0753578{col 67}{space 3} 4.412975
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2asensitivity1, replace
{res}{txt}(note: file output/data/primaryobjective2asensitivity1.ster not found)
{txt}file output/data/primaryobjective2asensitivity1.ster saved

{com}. 
. *2a sensitivity 2: exclude GP non attenders
. stcox standtnf i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat if gp_consult ==1

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-95.899852
{txt}Iteration 1:   log likelihood = {res}-89.657574
{txt}Iteration 2:   log likelihood = {res}-88.552043
{txt}Iteration 3:   log likelihood = {res}-88.214594
{txt}Iteration 4:   log likelihood = {res}-88.092892
{txt}Iteration 5:   log likelihood = {res}-88.048364
{txt}Iteration 6:   log likelihood = {res}-88.032015
{txt}Iteration 7:   log likelihood = {res}-88.026005
{txt}Iteration 8:   log likelihood = {res}-88.023794
{txt}Iteration 9:   log likelihood = {res}-88.022981
{txt}Iteration 10:  log likelihood = {res}-88.022682
{txt}Iteration 11:  log likelihood = {res}-88.022572
{txt}Iteration 12:  log likelihood = {res}-88.022531
{txt}Iteration 13:  log likelihood = {res}-88.022516
{txt}Iteration 14:  log likelihood = {res}-88.022511
{txt}Iteration 15:  log likelihood = {res}-88.022509
{txt}Iteration 16:  log likelihood = {res}-88.022508
{txt}Iteration 17:  log likelihood = {res}-88.022508
{txt}Iteration 18:  log likelihood = {res}-88.022508
{txt}Iteration 19:  log likelihood = {res}-88.022508
{txt}Iteration 20:  log likelihood = {res}-88.022508
{txt}Iteration 21:  log likelihood = {res}-88.022508
{txt}Iteration 22:  log likelihood = {res}-88.022508
{txt}Iteration 23:  log likelihood = {res}-88.022508
{txt}Iteration 24:  log likelihood = {res}-88.022508
{txt}Iteration 25:  log likelihood = {res}-88.022508
{txt}Iteration 26:  log likelihood = {res}-88.022508
{txt}Iteration 27:  log likelihood = {res}-88.022508
{txt}Iteration 28:  log likelihood = {res}-88.022508
{txt}Iteration 29:  log likelihood = {res}-88.022508
{txt}Iteration 30:  log likelihood = {res}-88.022508
{txt}Iteration 31:  log likelihood = {res}-88.022508
{txt}Iteration 32:  log likelihood = {res}-88.022508
{txt}Iteration 33:  log likelihood = {res}-88.022508
{txt}Iteration 34:  log likelihood = {res}-88.022508
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-88.022508
{txt}Iteration 1:   log likelihood = {res}-88.022508

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         986                  {txt}Number of obs    =  {res}       986
{txt}No. of failures = {res}          14
{txt}Time at risk    = {res} 562.5160849
                                                {txt}LR chi2({res}20{txt})      =  {res}     15.75
{txt}Log likelihood  =   {res}-88.022508                  {txt}Prob > chi2      =  {res}    0.7317

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.048085{col 26}{space 2} .6317802{col 37}{space 1}    0.08{col 46}{space 3}0.938{col 54}{space 4} .3215857{col 67}{space 3} 3.415831
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .6444851{col 26}{space 2} .5348806{col 37}{space 1}   -0.53{col 46}{space 3}0.597{col 54}{space 4} .1266984{col 67}{space 3} 3.278344
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2}  .389307{col 26}{space 2} .4230466{col 37}{space 1}   -0.87{col 46}{space 3}0.385{col 54}{space 4} .0462723{col 67}{space 3} 3.275395
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .6798436{col 26}{space 2} .5675321{col 37}{space 1}   -0.46{col 46}{space 3}0.644{col 54}{space 4} .1323816{col 67}{space 3} 3.491325
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.199399{col 26}{space 2}  .994564{col 37}{space 1}    0.22{col 46}{space 3}0.826{col 54}{space 4} .2361192{col 67}{space 3} 6.092505
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .9023966{col 26}{space 2} .9832806{col 37}{space 1}   -0.09{col 46}{space 3}0.925{col 54}{space 4} .1066352{col 67}{space 3} 7.636498
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 2.037886{col 26}{space 2} 1.156937{col 37}{space 1}    1.25{col 46}{space 3}0.210{col 54}{space 4} .6697936{col 67}{space 3} 6.200389
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 4.33e-16{col 26}{space 2} 1.09e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.318038{col 26}{space 2} 1.018776{col 37}{space 1}    0.36{col 46}{space 3}0.721{col 54}{space 4} .2897296{col 67}{space 3} 5.996021
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.028728{col 26}{space 2} .1873226{col 37}{space 1}    0.16{col 46}{space 3}0.876{col 54}{space 4} .7199531{col 67}{space 3} 1.469932
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  .971385{col 26}{space 2} .5688419{col 37}{space 1}   -0.05{col 46}{space 3}0.960{col 54}{space 4} .3082682{col 67}{space 3} 3.060934
{txt}{space 8}skin {c |}{col 14}{res}{space 2} 1.015465{col 26}{space 2} .5852399{col 37}{space 1}    0.03{col 46}{space 3}0.979{col 54}{space 4} .3281665{col 67}{space 3} 3.142212
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .8176866{col 26}{space 2} .4795171{col 37}{space 1}   -0.34{col 46}{space 3}0.731{col 54}{space 4} .2590691{col 67}{space 3} 2.580823
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .3164556{col 26}{space 2} .3318862{col 37}{space 1}   -1.10{col 46}{space 3}0.273{col 54}{space 4} .0405141{col 67}{space 3} 2.471835
{txt}{space 6}stroke {c |}{col 14}{res}{space 2}  2.13032{col 26}{space 2} 1.290865{col 37}{space 1}    1.25{col 46}{space 3}0.212{col 54}{space 4} .6496211{col 67}{space 3} 6.986012
{txt}{space 6}cancer {c |}{col 14}{res}{space 2}  .984069{col 26}{space 2} .5410046{col 37}{space 1}   -0.03{col 46}{space 3}0.977{col 54}{space 4} .3350168{col 67}{space 3} 2.890577
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 1.08e-15{col 26}{space 2} 1.54e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.91e-16{col 26}{space 2} 7.74e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.115652{col 26}{space 2} .7424925{col 37}{space 1}    0.16{col 46}{space 3}0.869{col 54}{space 4} .3027149{col 67}{space 3} 4.111718
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} 5.07e-16{col 26}{space 2} 1.81e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2asensitivity2, replace
{res}{txt}(note: file output/data/primaryobjective2asensitivity2.ster not found)
{txt}file output/data/primaryobjective2asensitivity2.ster saved

{com}. 
. *2a sensitivity 3: Additional confounders
. stcox standtnf i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat i.ckd chronic_liver_disease chronic_respiratory_disease

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-160.95798
{txt}Iteration 1:   log likelihood = {res}-150.37008
{txt}Iteration 2:   log likelihood = {res}-149.79708
{txt}Iteration 3:   log likelihood = {res}-149.77824
{txt}Iteration 4:   log likelihood = {res}-149.77491
{txt}Iteration 5:   log likelihood = {res}-149.77369
{txt}Iteration 6:   log likelihood = {res}-149.77324
{txt}Iteration 7:   log likelihood = {res}-149.77308
{txt}Iteration 8:   log likelihood = {res}-149.77302
{txt}Iteration 9:   log likelihood = {res}  -149.773
{txt}Iteration 10:  log likelihood = {res}-149.77299
{txt}Iteration 11:  log likelihood = {res}-149.77298
{txt}Iteration 12:  log likelihood = {res}-149.77298
{txt}Iteration 13:  log likelihood = {res}-149.77298
{txt}Iteration 14:  log likelihood = {res}-149.77298
{txt}Iteration 15:  log likelihood = {res}-149.77298
{txt}Iteration 16:  log likelihood = {res}-149.77298
{txt}Iteration 17:  log likelihood = {res}-149.77298
{txt}Iteration 18:  log likelihood = {res}-149.77298
{txt}Iteration 19:  log likelihood = {res}-149.77298
{txt}Iteration 20:  log likelihood = {res}-149.77298
{txt}Iteration 21:  log likelihood = {res}-149.77298
{txt}Iteration 22:  log likelihood = {res}-149.77298
{txt}Iteration 23:  log likelihood = {res}-149.77298
{txt}Iteration 24:  log likelihood = {res}-149.77298
{txt}Iteration 25:  log likelihood = {res}-149.77298
{txt}Iteration 26:  log likelihood = {res}-149.77298
{txt}Iteration 27:  log likelihood = {res}-149.77298
{txt}Iteration 28:  log likelihood = {res}-149.77298
{txt}Iteration 29:  log likelihood = {res}-149.77298
{txt}Iteration 30:  log likelihood = {res}-149.77298
{txt}Iteration 31:  log likelihood = {res}-149.77298
{txt}Iteration 32:  log likelihood = {res}-149.77298
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-149.77298
{txt}Iteration 1:   log likelihood = {res}-149.77298
{txt}Iteration 2:   log likelihood = {res}-149.77298

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,571                  {txt}Number of obs    =  {res}     1,571
{txt}No. of failures = {res}          22
{txt}Time at risk    = {res}  896.164271
                                                {txt}LR chi2({res}23{txt})      =  {res}     22.37
{txt}Log likelihood  =   {res}-149.77298                  {txt}Prob > chi2      =  {res}    0.4980

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.908583{col 26}{space 2} 1.063798{col 37}{space 1}    1.16{col 46}{space 3}0.246{col 54}{space 4} .6401353{col 67}{space 3} 5.690498
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .4631068{col 26}{space 2} .3051784{col 37}{space 1}   -1.17{col 46}{space 3}0.243{col 54}{space 4} .1272788{col 67}{space 3} 1.685025
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .1783262{col 26}{space 2} .1873117{col 37}{space 1}   -1.64{col 46}{space 3}0.101{col 54}{space 4} .0227574{col 67}{space 3} 1.397356
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2}  .612549{col 26}{space 2} .4047065{col 37}{space 1}   -0.74{col 46}{space 3}0.458{col 54}{space 4}  .167787{col 67}{space 3} 2.236265
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .4858567{col 26}{space 2} .3774816{col 37}{space 1}   -0.93{col 46}{space 3}0.353{col 54}{space 4} .1059682{col 67}{space 3} 2.227619
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .6653013{col 26}{space 2} .5153395{col 37}{space 1}   -0.53{col 46}{space 3}0.599{col 54}{space 4} .1457744{col 67}{space 3} 3.036375
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.118946{col 26}{space 2} .4861372{col 37}{space 1}    0.26{col 46}{space 3}0.796{col 54}{space 4} .4775249{col 67}{space 3} 2.621936
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .4033171{col 26}{space 2} .3026369{col 37}{space 1}   -1.21{col 46}{space 3}0.226{col 54}{space 4} .0926682{col 67}{space 3} 1.755344
{txt}5 most de..  {c |}{col 14}{res}{space 2}  1.07125{col 26}{space 2} .6758631{col 37}{space 1}    0.11{col 46}{space 3}0.913{col 54}{space 4} .3110704{col 67}{space 3} 3.689122
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.354367{col 26}{space 2} .2240758{col 37}{space 1}    1.83{col 46}{space 3}0.067{col 54}{space 4}  .979282{col 67}{space 3} 1.873118
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} .8004233{col 26}{space 2} .3778687{col 37}{space 1}   -0.47{col 46}{space 3}0.637{col 54}{space 4} .3173068{col 67}{space 3} 2.019111
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6401595{col 26}{space 2} .3075352{col 37}{space 1}   -0.93{col 46}{space 3}0.353{col 54}{space 4} .2496707{col 67}{space 3} 1.641379
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .7119025{col 26}{space 2} .3400743{col 37}{space 1}   -0.71{col 46}{space 3}0.477{col 54}{space 4}  .279128{col 67}{space 3} 1.815673
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .4085191{col 26}{space 2}  .305261{col 37}{space 1}   -1.20{col 46}{space 3}0.231{col 54}{space 4} .0944414{col 67}{space 3} 1.767106
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} 2.473027{col 26}{space 2} 1.156233{col 37}{space 1}    1.94{col 46}{space 3}0.053{col 54}{space 4} .9891455{col 67}{space 3} 6.182974
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.003795{col 26}{space 2} .4330125{col 37}{space 1}    0.01{col 46}{space 3}0.993{col 54}{space 4} .4309803{col 67}{space 3} 2.337935
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 1.84e-15{col 26}{space 2} 1.54e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.12e-15{col 26}{space 2} 1.81e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.547596{col 26}{space 2}   .75178{col 37}{space 1}    0.90{col 46}{space 3}0.369{col 54}{space 4} .5972652{col 67}{space 3} 4.010035
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} .4666226{col 26}{space 2}  .480524{col 37}{space 1}   -0.74{col 46}{space 3}0.459{col 54}{space 4}  .062002{col 67}{space 3} 3.511768
{txt}{space 12} {c |}
{space 9}ckd {c |}
{space 8}CKD  {c |}{col 14}{res}{space 2} .8503799{col 26}{space 2} .3684946{col 37}{space 1}   -0.37{col 46}{space 3}0.708{col 54}{space 4}  .363716{col 67}{space 3} 1.988216
{txt}chronic_l~se {c |}{col 14}{res}{space 2} .8479159{col 26}{space 2} .4730465{col 37}{space 1}   -0.30{col 46}{space 3}0.767{col 54}{space 4} .2841013{col 67}{space 3} 2.530651
{txt}chronic_r~se {c |}{col 14}{res}{space 2} .3540909{col 26}{space 2} .2650838{col 37}{space 1}   -1.39{col 46}{space 3}0.166{col 54}{space 4} .0816353{col 67}{space 3} 1.535859
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2asensitivity3, replace
{res}{txt}(note: file output/data/primaryobjective2asensitivity3.ster not found)
{txt}file output/data/primaryobjective2asensitivity3.ster saved

{com}. 
. *2a sensitivity 4: restricted exposure window
. stcox standtnf3m i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-129.62533
{txt}Iteration 1:   log likelihood = {res}-116.39027
{txt}Iteration 2:   log likelihood = {res}-114.84792
{txt}Iteration 3:   log likelihood = {res}-114.60695
{txt}Iteration 4:   log likelihood = {res}-114.52396
{txt}Iteration 5:   log likelihood = {res}-114.49361
{txt}Iteration 6:   log likelihood = {res}-114.48247
{txt}Iteration 7:   log likelihood = {res}-114.47837
{txt}Iteration 8:   log likelihood = {res}-114.47687
{txt}Iteration 9:   log likelihood = {res}-114.47631
{txt}Iteration 10:  log likelihood = {res}-114.47611
{txt}Iteration 11:  log likelihood = {res}-114.47604
{txt}Iteration 12:  log likelihood = {res}-114.47601
{txt}Iteration 13:  log likelihood = {res}  -114.476
{txt}Iteration 14:  log likelihood = {res}-114.47599
{txt}Iteration 15:  log likelihood = {res}-114.47599
{txt}Iteration 16:  log likelihood = {res}-114.47599
{txt}Iteration 17:  log likelihood = {res}-114.47599
{txt}Iteration 18:  log likelihood = {res}-114.47599
{txt}Iteration 19:  log likelihood = {res}-114.47599
{txt}Iteration 20:  log likelihood = {res}-114.47599
{txt}Iteration 21:  log likelihood = {res}-114.47599
{txt}Iteration 22:  log likelihood = {res}-114.47599
{txt}Iteration 23:  log likelihood = {res}-114.47599
{txt}Iteration 24:  log likelihood = {res}-114.47599
{txt}Iteration 25:  log likelihood = {res}-114.47599
{txt}Iteration 26:  log likelihood = {res}-114.47599
{txt}Iteration 27:  log likelihood = {res}-114.47599
{txt}Iteration 28:  log likelihood = {res}-114.47599
{txt}Iteration 29:  log likelihood = {res}-114.47599
{txt}Iteration 30:  log likelihood = {res}-114.47599
{txt}Iteration 31:  log likelihood = {res}-114.47599
{txt}Iteration 32:  log likelihood = {res}-114.47599
{txt}Iteration 33:  log likelihood = {res}-114.47599
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-114.47599
{txt}Iteration 1:   log likelihood = {res}-114.47599
{txt}Iteration 2:   log likelihood = {res}-114.47599

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,400                  {txt}Number of obs    =  {res}     1,400
{txt}No. of failures = {res}          18
{txt}Time at risk    = {res} 800.6926762
                                                {txt}LR chi2({res}20{txt})      =  {res}     30.30
{txt}Log likelihood  =   {res}-114.47599                  {txt}Prob > chi2      =  {res}    0.0652

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 2}standtnf3m {c |}{col 14}{res}{space 2} 1.183506{col 26}{space 2} .6129261{col 37}{space 1}    0.33{col 46}{space 3}0.745{col 54}{space 4} .4288861{col 67}{space 3} 3.265873
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .1772772{col 26}{space 2} .1877337{col 37}{space 1}   -1.63{col 46}{space 3}0.102{col 54}{space 4} .0222456{col 67}{space 3} 1.412738
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 3.08e-16{col 26}{space 2} 7.69e-09{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .6008638{col 26}{space 2} .4060916{col 37}{space 1}   -0.75{col 46}{space 3}0.451{col 54}{space 4} .1597698{col 67}{space 3} 2.259735
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .4956974{col 26}{space 2} .3859405{col 37}{space 1}   -0.90{col 46}{space 3}0.367{col 54}{space 4} .1077674{col 67}{space 3} 2.280058
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .9100225{col 26}{space 2} .7173425{col 37}{space 1}   -0.12{col 46}{space 3}0.905{col 54}{space 4} .1941227{col 67}{space 3} 4.266069
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} .9464033{col 26}{space 2} .4637275{col 37}{space 1}   -0.11{col 46}{space 3}0.910{col 54}{space 4} .3622402{col 67}{space 3} 2.472611
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .4932804{col 26}{space 2} .3785705{col 37}{space 1}   -0.92{col 46}{space 3}0.357{col 54}{space 4} .1096062{col 67}{space 3} 2.219999
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.149319{col 26}{space 2} .7535976{col 37}{space 1}    0.21{col 46}{space 3}0.832{col 54}{space 4} .3179187{col 67}{space 3} 4.154946
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.838544{col 26}{space 2}  .436857{col 37}{space 1}    2.56{col 46}{space 3}0.010{col 54}{space 4} 1.154037{col 67}{space 3}  2.92906
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.284832{col 26}{space 2} .6271685{col 37}{space 1}    0.51{col 46}{space 3}0.608{col 54}{space 4} .4935682{col 67}{space 3} 3.344611
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6403933{col 26}{space 2} .3403124{col 37}{space 1}   -0.84{col 46}{space 3}0.402{col 54}{space 4}     .226{col 67}{space 3} 1.814618
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.101971{col 26}{space 2}  .543428{col 37}{space 1}    0.20{col 46}{space 3}0.844{col 54}{space 4}  .419186{col 67}{space 3} 2.896898
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .3009491{col 26}{space 2} .3117647{col 37}{space 1}   -1.16{col 46}{space 3}0.246{col 54}{space 4} .0395094{col 67}{space 3} 2.292373
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} 2.667085{col 26}{space 2} 1.385686{col 37}{space 1}    1.89{col 46}{space 3}0.059{col 54}{space 4} .9633735{col 67}{space 3} 7.383787
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.013218{col 26}{space 2} .4849338{col 37}{space 1}    0.03{col 46}{space 3}0.978{col 54}{space 4} .3965624{col 67}{space 3} 2.588775
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 1.05e-15{col 26}{space 2} 1.86e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 2.46e-16{col 26}{space 2} 7.70e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.764526{col 26}{space 2} .9037819{col 37}{space 1}    1.11{col 46}{space 3}0.268{col 54}{space 4} .6466163{col 67}{space 3} 4.815146
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} .5981295{col 26}{space 2} .6239016{col 37}{space 1}   -0.49{col 46}{space 3}0.622{col 54}{space 4} .0774314{col 67}{space 3} 4.620332
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2asensitivity4, replace
{res}{txt}(note: file output/data/primaryobjective2asensitivity4.ster not found)
{txt}file output/data/primaryobjective2asensitivity4.ster saved

{com}. 
. *2a sensitivity 5: exclusion of infliximab 
. stcox standtnf i.agegroup male i.imd bmicat bowel skin joint chronic_cardiac_disease stroke cancer i.diabcat steroidcat if infliximab_3m_0m !=1 & infliximab_6m_3m !=1

         {txt}failure _d:  {res}icu_or_death_covid == 1
   {txt}analysis time _t:  {res}(stopicu-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}icu_or_death_covid==1 time stop
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-120.33843
{txt}Iteration 1:   log likelihood = {res}-113.52008
{txt}Iteration 2:   log likelihood = {res}-113.19121
{txt}Iteration 3:   log likelihood = {res}-113.17885
{txt}Iteration 4:   log likelihood = {res}-113.17673
{txt}Iteration 5:   log likelihood = {res}-113.17596
{txt}Iteration 6:   log likelihood = {res}-113.17567
{txt}Iteration 7:   log likelihood = {res}-113.17557
{txt}Iteration 8:   log likelihood = {res}-113.17553
{txt}Iteration 9:   log likelihood = {res}-113.17552
{txt}Iteration 10:  log likelihood = {res}-113.17551
{txt}Iteration 11:  log likelihood = {res}-113.17551
{txt}Iteration 12:  log likelihood = {res}-113.17551
{txt}Iteration 13:  log likelihood = {res}-113.17551
{txt}Iteration 14:  log likelihood = {res}-113.17551
{txt}Iteration 15:  log likelihood = {res}-113.17551
{txt}Iteration 16:  log likelihood = {res}-113.17551
{txt}Iteration 17:  log likelihood = {res}-113.17551
{txt}Iteration 18:  log likelihood = {res}-113.17551
{txt}Iteration 19:  log likelihood = {res}-113.17551
{txt}Iteration 20:  log likelihood = {res}-113.17551
{txt}Iteration 21:  log likelihood = {res}-113.17551
{txt}Iteration 22:  log likelihood = {res}-113.17551
{txt}Iteration 23:  log likelihood = {res}-113.17551
{txt}Iteration 24:  log likelihood = {res}-113.17551
{txt}Iteration 25:  log likelihood = {res}-113.17551
{txt}Iteration 26:  log likelihood = {res}-113.17551
{txt}Iteration 27:  log likelihood = {res}-113.17551
{txt}Iteration 28:  log likelihood = {res}-113.17551
{txt}Iteration 29:  log likelihood = {res}-113.17551
{txt}Iteration 30:  log likelihood = {res}-113.17551
{txt}Iteration 31:  log likelihood = {res}-113.17551
{txt}Iteration 32:  log likelihood = {res}-113.17551
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-113.17551
{txt}Iteration 1:   log likelihood = {res}-113.17551
{txt}Iteration 2:   log likelihood = {res}-113.17551

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,237                  {txt}Number of obs    =  {res}     1,237
{txt}No. of failures = {res}          17
{txt}Time at risk    = {res} 705.7713895
                                                {txt}LR chi2({res}20{txt})      =  {res}     14.33
{txt}Log likelihood  =   {res}-113.17551                  {txt}Prob > chi2      =  {res}    0.8136

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.914485{col 26}{space 2} 1.105816{col 37}{space 1}    1.12{col 46}{space 3}0.261{col 54}{space 4} .6171544{col 67}{space 3} 5.938958
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} .5954779{col 26}{space 2} .4001959{col 37}{space 1}   -0.77{col 46}{space 3}0.441{col 54}{space 4} .1595176{col 67}{space 3} 2.222914
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2}  .221701{col 26}{space 2} .2347311{col 37}{space 1}   -1.42{col 46}{space 3}0.155{col 54}{space 4} .0278316{col 67}{space 3} 1.766027
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .2613127{col 26}{space 2} .2764681{col 37}{space 1}   -1.27{col 46}{space 3}0.205{col 54}{space 4} .0328542{col 67}{space 3} 2.078402
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .3084214{col 26}{space 2} .3268593{col 37}{space 1}   -1.11{col 46}{space 3}0.267{col 54}{space 4} .0386417{col 67}{space 3} 2.461683
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} .8367475{col 26}{space 2} .6626881{col 37}{space 1}   -0.23{col 46}{space 3}0.822{col 54}{space 4} .1771981{col 67}{space 3} 3.951208
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.290412{col 26}{space 2}  .632435{col 37}{space 1}    0.52{col 46}{space 3}0.603{col 54}{space 4} .4938009{col 67}{space 3} 3.372135
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .2372377{col 26}{space 2} .2476383{col 37}{space 1}   -1.38{col 46}{space 3}0.168{col 54}{space 4} .0306666{col 67}{space 3} 1.835279
{txt}5 most de..  {c |}{col 14}{res}{space 2} 1.448988{col 26}{space 2} .9350473{col 37}{space 1}    0.57{col 46}{space 3}0.565{col 54}{space 4} .4090494{col 67}{space 3} 5.132797
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.166066{col 26}{space 2} .1994693{col 37}{space 1}    0.90{col 46}{space 3}0.369{col 54}{space 4}  .833902{col 67}{space 3} 1.630539
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} .6421372{col 26}{space 2} .3457837{col 37}{space 1}   -0.82{col 46}{space 3}0.411{col 54}{space 4} .2234937{col 67}{space 3} 1.844974
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7745085{col 26}{space 2} .4129125{col 37}{space 1}   -0.48{col 46}{space 3}0.632{col 54}{space 4} .2724121{col 67}{space 3} 2.202044
{txt}{space 7}joint {c |}{col 14}{res}{space 2} .6553183{col 26}{space 2} .3512071{col 37}{space 1}   -0.79{col 46}{space 3}0.430{col 54}{space 4} .2292265{col 67}{space 3}  1.87344
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5272654{col 26}{space 2}   .40116{col 37}{space 1}   -0.84{col 46}{space 3}0.400{col 54}{space 4} .1186885{col 67}{space 3}  2.34234
{txt}{space 6}stroke {c |}{col 14}{res}{space 2} 1.442447{col 26}{space 2} .8330826{col 37}{space 1}    0.63{col 46}{space 3}0.526{col 54}{space 4} .4650394{col 67}{space 3} 4.474142
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.170716{col 26}{space 2} .5737572{col 37}{space 1}    0.32{col 46}{space 3}0.748{col 54}{space 4} .4480075{col 67}{space 3} 3.059269
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 3.24e-15{col 26}{space 2} 3.28e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 6.57e-16{col 26}{space 2} 1.60e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.384822{col 26}{space 2} .8116012{col 37}{space 1}    0.56{col 46}{space 3}0.579{col 54}{space 4} .4390675{col 67}{space 3}  4.36774
{txt}{space 12} {c |}
{space 2}steroidcat {c |}{col 14}{res}{space 2} .5782392{col 26}{space 2}  .599611{col 37}{space 1}   -0.53{col 46}{space 3}0.597{col 54}{space 4}  .075761{col 67}{space 3} 4.413362
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2asensitivity5, replace
{res}{txt}(note: file output/data/primaryobjective2asensitivity5.ster not found)
{txt}file output/data/primaryobjective2asensitivity5.ster saved

{com}. 
. *2a sensitivity 6: covid positivity
. egen stopswab = rmin(first_pos_test_sgss_date diecensor)
{txt}
{com}. stset stopswab, id(patient_id) failure(first_pos_test_sgss==1) origin(time enter_date) scale(365.25)  exit(first_pos_test_sgss==1 time mdy(10,01,2020))

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}first_pos_test_sgss == 1
{txt}obs. time interval:  {res}(stopswab[_n-1], stopswab]
{txt} exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}        401{txt}  observations end on or before enter()
{hline 78}
{res}     38,953{txt}  observations remaining, representing
{res}     38,953{txt}  subjects
{res}      3,506{txt}  failures in single-failure-per-subject data
{res} 22,262.631{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}. stcox standtnf i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-757.85694
{txt}Iteration 1:   log likelihood = {res}-746.35206
{txt}Iteration 2:   log likelihood = {res}-746.08578
{txt}Iteration 3:   log likelihood = {res} -746.0701
{txt}Iteration 4:   log likelihood = {res}-746.06457
{txt}Iteration 5:   log likelihood = {res}-746.06254
{txt}Iteration 6:   log likelihood = {res}-746.06179
{txt}Iteration 7:   log likelihood = {res}-746.06152
{txt}Iteration 8:   log likelihood = {res}-746.06142
{txt}Iteration 9:   log likelihood = {res}-746.06138
{txt}Iteration 10:  log likelihood = {res}-746.06137
{txt}Iteration 11:  log likelihood = {res}-746.06136
{txt}Iteration 12:  log likelihood = {res}-746.06136
{txt}Iteration 13:  log likelihood = {res}-746.06136
{txt}Iteration 14:  log likelihood = {res}-746.06136
{txt}Iteration 15:  log likelihood = {res}-746.06136
{txt}Iteration 16:  log likelihood = {res}-746.06136
{txt}Iteration 17:  log likelihood = {res}-746.06136
{txt}Iteration 18:  log likelihood = {res}-746.06136
{txt}Iteration 19:  log likelihood = {res}-746.06136
{txt}Iteration 20:  log likelihood = {res}-746.06136
{txt}Iteration 21:  log likelihood = {res}-746.06136
{txt}Iteration 22:  log likelihood = {res}-746.06136
{txt}Iteration 23:  log likelihood = {res}-746.06136
{txt}Iteration 24:  log likelihood = {res}-746.06136
{txt}Iteration 25:  log likelihood = {res}-746.06136
{txt}Iteration 26:  log likelihood = {res}-746.06136
{txt}Iteration 27:  log likelihood = {res}-746.06136
{txt}Iteration 28:  log likelihood = {res}-746.06136
{txt}Iteration 29:  log likelihood = {res}-746.06136
{txt}Iteration 30:  log likelihood = {res}-746.06136
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-746.06136
{txt}Iteration 1:   log likelihood = {res}-746.06136

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,155                  {txt}Number of obs    =  {res}     1,155
{txt}No. of failures = {res}         108
{txt}Time at risk    = {res} 662.8884326
                                                {txt}LR chi2({res}21{txt})      =  {res}     23.59
{txt}Log likelihood  =   {res}-746.06136                  {txt}Prob > chi2      =  {res}    0.3133

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}standtnf {c |}{col 14}{res}{space 2} 1.271427{col 26}{space 2} .2844808{col 37}{space 1}    1.07{col 46}{space 3}0.283{col 54}{space 4} .8200415{col 67}{space 3} 1.971275
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.301093{col 26}{space 2} .3718106{col 37}{space 1}    0.92{col 46}{space 3}0.357{col 54}{space 4} .7431256{col 67}{space 3} 2.278004
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.281642{col 26}{space 2} .3832401{col 37}{space 1}    0.83{col 46}{space 3}0.407{col 54}{space 4} .7132443{col 67}{space 3} 2.303008
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.167292{col 26}{space 2} .3756753{col 37}{space 1}    0.48{col 46}{space 3}0.631{col 54}{space 4} .6212025{col 67}{space 3} 2.193441
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.050541{col 26}{space 2} .3542234{col 37}{space 1}    0.15{col 46}{space 3}0.884{col 54}{space 4} .5425048{col 67}{space 3} 2.034337
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.580317{col 26}{space 2} .5667467{col 37}{space 1}    1.28{col 46}{space 3}0.202{col 54}{space 4} .7824908{col 67}{space 3} 3.191607
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.177328{col 26}{space 2} .2294053{col 37}{space 1}    0.84{col 46}{space 3}0.402{col 54}{space 4} .8035976{col 67}{space 3} 1.724869
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .5402994{col 26}{space 2} .2294693{col 37}{space 1}   -1.45{col 46}{space 3}0.147{col 54}{space 4} .2350296{col 67}{space 3} 1.242071
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.073436{col 26}{space 2} .3325782{col 37}{space 1}    0.23{col 46}{space 3}0.819{col 54}{space 4} .5848604{col 67}{space 3} 1.970155
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.278744{col 26}{space 2} .2892715{col 37}{space 1}    1.09{col 46}{space 3}0.277{col 54}{space 4} .8207835{col 67}{space 3} 1.992225
{txt}5 most de..  {c |}{col 14}{res}{space 2} .5502819{col 26}{space 2} .2347282{col 37}{space 1}   -1.40{col 46}{space 3}0.161{col 54}{space 4} .2385046{col 67}{space 3}  1.26962
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.046998{col 26}{space 2} .0669877{col 37}{space 1}    0.72{col 46}{space 3}0.473{col 54}{space 4}  .923603{col 67}{space 3} 1.186879
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.136927{col 26}{space 2} .2361736{col 37}{space 1}    0.62{col 46}{space 3}0.537{col 54}{space 4} .7566809{col 67}{space 3} 1.708254
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7589272{col 26}{space 2}  .157834{col 37}{space 1}   -1.33{col 46}{space 3}0.185{col 54}{space 4} .5048657{col 67}{space 3} 1.140839
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.523307{col 26}{space 2} .3330643{col 37}{space 1}    1.92{col 46}{space 3}0.054{col 54}{space 4} .9923758{col 67}{space 3} 2.338293
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5959948{col 26}{space 2} .1734442{col 37}{space 1}   -1.78{col 46}{space 3}0.075{col 54}{space 4} .3369218{col 67}{space 3}  1.05428
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .8972346{col 26}{space 2} .1747906{col 37}{space 1}   -0.56{col 46}{space 3}0.578{col 54}{space 4} .6124676{col 67}{space 3} 1.314404
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2}  2.68902{col 26}{space 2} 2.736226{col 37}{space 1}    0.97{col 46}{space 3}0.331{col 54}{space 4} .3659735{col 67}{space 3} 19.75779
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 2.55e-14{col 26}{space 2} 3.28e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.218006{col 26}{space 2} .2937028{col 37}{space 1}    0.82{col 46}{space 3}0.413{col 54}{space 4} .7592689{col 67}{space 3} 1.953904
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .8982111{col 26}{space 2} .1076772{col 37}{space 1}   -0.90{col 46}{space 3}0.371{col 54}{space 4} .7101281{col 67}{space 3} 1.136109
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2asensitivity6, replace
{res}{txt}(note: file output/data/primaryobjective2asensitivity6.ster not found)
{txt}file output/data/primaryobjective2asensitivity6.ster saved

{com}. 
. 
. *2b: IL23 vs standard systemics
. stcox standil23

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-27351.735
{txt}Iteration 1:   log likelihood = {res}-27351.554
{txt}Iteration 2:   log likelihood = {res}-27351.554
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-27351.554

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      29,596                  {txt}Number of obs    =  {res}    29,596
{txt}No. of failures = {res}       2,666
{txt}Time at risk    = {res} 16921.46749
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.36
{txt}Log likelihood  =   {res}-27351.554                  {txt}Prob > chi2      =  {res}    0.5468

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil23 {c |}{col 14}{res}{space 2} .9762185{col 26}{space 2}   .03896{col 37}{space 1}   -0.60{col 46}{space 3}0.546{col 54}{space 4} .9027683{col 67}{space 3} 1.055645
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2bunadj, replace
{res}{txt}(note: file output/data/primaryobjective2bunadj.ster not found)
{txt}file output/data/primaryobjective2bunadj.ster saved

{com}. sts graph, by(standil23) xtitle("Analysis time (years)") saving(primeob2b, replace)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2b.gph not found)
{res}{txt}(file primeob2b.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2b.pdf", as(pdf) replace
{txt}(file output/figures/primeob2b.pdf written in PDF format)

{com}. sts graph, cumhaz by(standil23) xtitle("Analysis time (years)") tmax(0.58) legend(order(1 "Standard Systemic" 2 "il23")) saving(primeob2b_NA, replace)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2b_NA.gph not found)
{res}{txt}(file primeob2b_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2b_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob2b_NA.pdf written in PDF format)

{com}. 
. ** Testing assumptions of proportional hazard model
. stcox standil23

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-27351.735
{txt}Iteration 1:   log likelihood = {res}-27351.554
{txt}Iteration 2:   log likelihood = {res}-27351.554
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-27351.554

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      29,596                  {txt}Number of obs    =  {res}    29,596
{txt}No. of failures = {res}       2,666
{txt}Time at risk    = {res} 16921.46749
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.36
{txt}Log likelihood  =   {res}-27351.554                  {txt}Prob > chi2      =  {res}    0.5468

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil23 {c |}{col 14}{res}{space 2} .9762185{col 26}{space 2}   .03896{col 37}{space 1}   -0.60{col 46}{space 3}0.546{col 54}{space 4} .9027683{col 67}{space 3} 1.055645
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. stptime, per (1000) by (standil23)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(9452 missing values generated)

 standil23{col 12}{c |}{col 15}person-time{col 29}failures{col 45}rate{col 52}[95% Conf. Interval]
{hline 11}{c +}{hline 59}
         0{col 12}{c |}{col 16}{res} 6327.9562{col 29}    1012{col 39} 159.92525{col 51} 150.3695{col 63} 170.0883
         {txt}1{col 12}{c |}{col 16}{res} 10593.511{col 29}    1654{col 39} 156.13331{col 51} 148.7873{col 63}  163.842
{txt}{hline 11}{c +}{hline 59}
     total{col 12}{c |}{col 16}{res} 16921.467{col 29}    2666{col 39} 157.55135{col 51} 151.6829{col 63} 163.6468
{txt}
{com}. stphtest, log detail

{txt}      Test of proportional-hazards assumption

      Time:  {res}Log(t)
{txt}      {hline 12}{c TT}{hline 51}
                  {c |}       rho            chi2       df       Prob>chi2
      {hline 12}{c +}{hline 51}
      standil23{col 19}{c |}{res}{col 25}-0.00927{col 37}     0.23{col 50}    1{col 64}0.6323
{txt}      {hline 12}{c +}{hline 51}
      global test {c |}{res}{col 37}     0.23{col 50}    1{col 64}0.6323
{txt}      {hline 12}{c BT}{hline 51}

{com}. stphtest, log plot(standil23) yline(0) 
{res}{txt}
{com}. 
. *if TVC significant, need to use models with tvc
. stcox standil23, tvc(standil23) 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-27351.735
{txt}Iteration 1:   log likelihood = {res}-27351.448
{txt}Iteration 2:   log likelihood = {res}-27351.448
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-27351.448

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      29,596                  {txt}Number of obs    =  {res}    29,596
{txt}No. of failures = {res}       2,666
{txt}Time at risk    = {res} 16921.46749
                                                {txt}LR chi2({res}2{txt})       =  {res}      0.57
{txt}Log likelihood  =   {res}-27351.448                  {txt}Prob > chi2      =  {res}    0.7505

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 3}standil23 {c |}{col 14}{res}{space 2} 1.017244{col 26}{space 2} .0999271{col 37}{space 1}    0.17{col 46}{space 3}0.862{col 54}{space 4} .8390909{col 67}{space 3} 1.233222
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 3}standil23 {c |}{col 14}{res}{space 2} .9085478{col 26}{space 2} .1898065{col 37}{space 1}   -0.46{col 46}{space 3}0.646{col 54}{space 4} .6032838{col 67}{space 3} 1.368277
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2bTVCtest, replace
{res}{txt}(note: file output/data/primaryobjective2bTVCtest.ster not found)
{txt}file output/data/primaryobjective2bTVCtest.ster saved

{com}. 
. stcox standil23 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-722.13648
{txt}Iteration 1:   log likelihood = {res}-709.43708
{txt}Iteration 2:   log likelihood = {res} -709.1242
{txt}Iteration 3:   log likelihood = {res}-709.10845
{txt}Iteration 4:   log likelihood = {res} -709.1032
{txt}Iteration 5:   log likelihood = {res}-709.10127
{txt}Iteration 6:   log likelihood = {res}-709.10055
{txt}Iteration 7:   log likelihood = {res}-709.10029
{txt}Iteration 8:   log likelihood = {res} -709.1002
{txt}Iteration 9:   log likelihood = {res}-709.10016
{txt}Iteration 10:  log likelihood = {res}-709.10015
{txt}Iteration 11:  log likelihood = {res}-709.10014
{txt}Iteration 12:  log likelihood = {res}-709.10014
{txt}Iteration 13:  log likelihood = {res}-709.10014
{txt}Iteration 14:  log likelihood = {res}-709.10014
{txt}Iteration 15:  log likelihood = {res}-709.10014
{txt}Iteration 16:  log likelihood = {res}-709.10014
{txt}Iteration 17:  log likelihood = {res}-709.10014
{txt}Iteration 18:  log likelihood = {res}-709.10014
{txt}Iteration 19:  log likelihood = {res}-709.10014
{txt}Iteration 20:  log likelihood = {res}-709.10014
{txt}Iteration 21:  log likelihood = {res}-709.10014
{txt}Iteration 22:  log likelihood = {res}-709.10014
{txt}Iteration 23:  log likelihood = {res}-709.10014
{txt}Iteration 24:  log likelihood = {res}-709.10014
{txt}Iteration 25:  log likelihood = {res}-709.10014
{txt}Iteration 26:  log likelihood = {res}-709.10014
{txt}Iteration 27:  log likelihood = {res}-709.10014
{txt}Iteration 28:  log likelihood = {res}-709.10014
{txt}Iteration 29:  log likelihood = {res}-709.10014
{txt}Iteration 30:  log likelihood = {res}-709.10014
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-709.10014
{txt}Iteration 1:   log likelihood = {res}-709.10014

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,146                  {txt}Number of obs    =  {res}     1,146
{txt}No. of failures = {res}         103
{txt}Time at risk    = {res}  658.329911
                                                {txt}LR chi2({res}21{txt})      =  {res}     26.07
{txt}Log likelihood  =   {res}-709.10014                  {txt}Prob > chi2      =  {res}    0.2037

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil23 {c |}{col 14}{res}{space 2}  1.26679{col 26}{space 2} .2675998{col 37}{space 1}    1.12{col 46}{space 3}0.263{col 54}{space 4} .8373262{col 67}{space 3} 1.916525
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.525634{col 26}{space 2} .4390755{col 37}{space 1}    1.47{col 46}{space 3}0.142{col 54}{space 4} .8679119{col 67}{space 3} 2.681792
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.376296{col 26}{space 2} .4184126{col 37}{space 1}    1.05{col 46}{space 3}0.293{col 54}{space 4}  .758464{col 67}{space 3} 2.497403
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.141165{col 26}{space 2}  .380635{col 37}{space 1}    0.40{col 46}{space 3}0.692{col 54}{space 4} .5935138{col 67}{space 3}  2.19415
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.054498{col 26}{space 2} .3695607{col 37}{space 1}    0.15{col 46}{space 3}0.880{col 54}{space 4}  .530558{col 67}{space 3} 2.095844
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.558419{col 26}{space 2} .6086534{col 37}{space 1}    1.14{col 46}{space 3}0.256{col 54}{space 4} .7248372{col 67}{space 3} 3.350642
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.110413{col 26}{space 2} .2215515{col 37}{space 1}    0.52{col 46}{space 3}0.600{col 54}{space 4} .7510198{col 67}{space 3}  1.64179
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .5564895{col 26}{space 2} .2367319{col 37}{space 1}   -1.38{col 46}{space 3}0.168{col 54}{space 4} .2417429{col 67}{space 3} 1.281032
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.210047{col 26}{space 2} .3765836{col 37}{space 1}    0.61{col 46}{space 3}0.540{col 54}{space 4} .6575007{col 67}{space 3} 2.226937
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2}  1.32992{col 26}{space 2}  .303034{col 37}{space 1}    1.25{col 46}{space 3}0.211{col 54}{space 4} .8508868{col 67}{space 3}  2.07864
{txt}5 most de..  {c |}{col 14}{res}{space 2} .4750572{col 26}{space 2} .2209528{col 37}{space 1}   -1.60{col 46}{space 3}0.110{col 54}{space 4} .1909174{col 67}{space 3} 1.182078
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.060448{col 26}{space 2} .0694482{col 37}{space 1}    0.90{col 46}{space 3}0.370{col 54}{space 4} .9327057{col 67}{space 3} 1.205686
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.151385{col 26}{space 2} .2463114{col 37}{space 1}    0.66{col 46}{space 3}0.510{col 54}{space 4} .7570534{col 67}{space 3} 1.751116
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6932738{col 26}{space 2} .1485099{col 37}{space 1}   -1.71{col 46}{space 3}0.087{col 54}{space 4} .4555797{col 67}{space 3} 1.054982
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.480982{col 26}{space 2} .3311442{col 37}{space 1}    1.76{col 46}{space 3}0.079{col 54}{space 4} .9554829{col 67}{space 3} 2.295495
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6061135{col 26}{space 2} .1769172{col 37}{space 1}   -1.72{col 46}{space 3}0.086{col 54}{space 4} .3420571{col 67}{space 3} 1.074013
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9925931{col 26}{space 2} .1972552{col 37}{space 1}   -0.04{col 46}{space 3}0.970{col 54}{space 4} .6723795{col 67}{space 3} 1.465305
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.931458{col 26}{space 2} 2.984505{col 37}{space 1}    1.06{col 46}{space 3}0.291{col 54}{space 4} .3985465{col 67}{space 3} 21.56197
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 3.08e-14{col 26}{space 2} 4.06e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.313857{col 26}{space 2} .3181594{col 37}{space 1}    1.13{col 46}{space 3}0.260{col 54}{space 4} .8173801{col 67}{space 3} 2.111895
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9189353{col 26}{space 2} .1056386{col 37}{space 1}   -0.74{col 46}{space 3}0.462{col 54}{space 4} .7335553{col 67}{space 3} 1.151164
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2badjusted, replace
{res}{txt}(note: file output/data/primaryobjective2badjusted.ster not found)
{txt}file output/data/primaryobjective2badjusted.ster saved

{com}. 
. *TVC analysis
. stcox standil23 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m, tvc(standil23) 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-722.13648
{txt}Iteration 1:   log likelihood = {res}-709.42539
{txt}Iteration 2:   log likelihood = {res} -709.1124
{txt}Iteration 3:   log likelihood = {res}-709.09666
{txt}Iteration 4:   log likelihood = {res} -709.0914
{txt}Iteration 5:   log likelihood = {res}-709.08947
{txt}Iteration 6:   log likelihood = {res}-709.08876
{txt}Iteration 7:   log likelihood = {res} -709.0885
{txt}Iteration 8:   log likelihood = {res} -709.0884
{txt}Iteration 9:   log likelihood = {res}-709.08837
{txt}Iteration 10:  log likelihood = {res}-709.08835
{txt}Iteration 11:  log likelihood = {res}-709.08835
{txt}Iteration 12:  log likelihood = {res}-709.08835
{txt}Iteration 13:  log likelihood = {res}-709.08835
{txt}Iteration 14:  log likelihood = {res}-709.08835
{txt}Iteration 15:  log likelihood = {res}-709.08835
{txt}Iteration 16:  log likelihood = {res}-709.08835
{txt}Iteration 17:  log likelihood = {res}-709.08835
{txt}Iteration 18:  log likelihood = {res}-709.08835
{txt}Iteration 19:  log likelihood = {res}-709.08835
{txt}Iteration 20:  log likelihood = {res}-709.08835
{txt}Iteration 21:  log likelihood = {res}-709.08835
{txt}Iteration 22:  log likelihood = {res}-709.08835
{txt}Iteration 23:  log likelihood = {res}-709.08835
{txt}Iteration 24:  log likelihood = {res}-709.08835
{txt}Iteration 25:  log likelihood = {res}-709.08835
{txt}Iteration 26:  log likelihood = {res}-709.08835
{txt}Iteration 27:  log likelihood = {res}-709.08835
{txt}Iteration 28:  log likelihood = {res}-709.08835
{txt}Iteration 29:  log likelihood = {res}-709.08835
{txt}Iteration 30:  log likelihood = {res}-709.08835
{txt}Iteration 31:  log likelihood = {res}-709.08835
{txt}Iteration 32:  log likelihood = {res}-709.08835
{txt}Iteration 33:  log likelihood = {res}-709.08835
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-709.08835
{txt}Iteration 1:   log likelihood = {res}-709.08835

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,146                  {txt}Number of obs    =  {res}     1,146
{txt}No. of failures = {res}         103
{txt}Time at risk    = {res}  658.329911
                                                {txt}LR chi2({res}22{txt})      =  {res}     26.10
{txt}Log likelihood  =   {res}-709.08835                  {txt}Prob > chi2      =  {res}    0.2476

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 3}standil23 {c |}{col 14}{res}{space 2} 1.380804{col 26}{space 2} .8309681{col 37}{space 1}    0.54{col 46}{space 3}0.592{col 54}{space 4} .4245014{col 67}{space 3} 4.491436
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.525947{col 26}{space 2} .4391674{col 37}{space 1}    1.47{col 46}{space 3}0.142{col 54}{space 4}  .868088{col 67}{space 3} 2.682348
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.376306{col 26}{space 2} .4184144{col 37}{space 1}    1.05{col 46}{space 3}0.293{col 54}{space 4} .7584711{col 67}{space 3} 2.497417
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.141327{col 26}{space 2} .3806909{col 37}{space 1}    0.40{col 46}{space 3}0.692{col 54}{space 4} .5935958{col 67}{space 3} 2.194468
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.054449{col 26}{space 2} .3695439{col 37}{space 1}    0.15{col 46}{space 3}0.880{col 54}{space 4} .5305328{col 67}{space 3} 2.095748
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.558721{col 26}{space 2} .6087726{col 37}{space 1}    1.14{col 46}{space 3}0.256{col 54}{space 4} .7249763{col 67}{space 3} 3.351297
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.110379{col 26}{space 2} .2215457{col 37}{space 1}    0.52{col 46}{space 3}0.600{col 54}{space 4} .7509957{col 67}{space 3} 1.641743
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .5564726{col 26}{space 2} .2367249{col 37}{space 1}   -1.38{col 46}{space 3}0.168{col 54}{space 4} .2417355{col 67}{space 3} 1.280994
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.209725{col 26}{space 2}  .376487{col 37}{space 1}    0.61{col 46}{space 3}0.541{col 54}{space 4} .6573225{col 67}{space 3} 2.226358
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.329946{col 26}{space 2} .3030399{col 37}{space 1}    1.25{col 46}{space 3}0.211{col 54}{space 4}  .850903{col 67}{space 3}  2.07868
{txt}5 most de..  {c |}{col 14}{res}{space 2} .4751042{col 26}{space 2} .2209741{col 37}{space 1}   -1.60{col 46}{space 3}0.110{col 54}{space 4} .1909367{col 67}{space 3} 1.182193
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.060437{col 26}{space 2} .0694462{col 37}{space 1}    0.90{col 46}{space 3}0.370{col 54}{space 4}  .932698{col 67}{space 3}  1.20567
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.151535{col 26}{space 2} .2463451{col 37}{space 1}    0.66{col 46}{space 3}0.510{col 54}{space 4} .7571498{col 67}{space 3} 1.751349
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6933959{col 26}{space 2} .1485366{col 37}{space 1}   -1.71{col 46}{space 3}0.087{col 54}{space 4} .4556591{col 67}{space 3}  1.05517
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.481032{col 26}{space 2} .3311575{col 37}{space 1}    1.76{col 46}{space 3}0.079{col 54}{space 4} .9555126{col 67}{space 3} 2.295579
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6061284{col 26}{space 2} .1769218{col 37}{space 1}   -1.72{col 46}{space 3}0.086{col 54}{space 4} .3420651{col 67}{space 3}  1.07404
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9926543{col 26}{space 2}  .197266{col 37}{space 1}   -0.04{col 46}{space 3}0.970{col 54}{space 4} .6724226{col 67}{space 3} 1.465392
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.931413{col 26}{space 2} 2.984464{col 37}{space 1}    1.06{col 46}{space 3}0.291{col 54}{space 4} .3985389{col 67}{space 3} 21.56171
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.53e-15{col 26}{space 2} 9.06e-08{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.313927{col 26}{space 2} .3181759{col 37}{space 1}    1.13{col 46}{space 3}0.260{col 54}{space 4}  .817424{col 67}{space 3} 2.112006
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9188949{col 26}{space 2} .1056386{col 37}{space 1}   -0.74{col 46}{space 3}0.462{col 54}{space 4} .7335157{col 67}{space 3} 1.151124
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 3}standil23 {c |}{col 14}{res}{space 2} .8289773{col 26}{space 2} 1.014519{col 37}{space 1}   -0.15{col 46}{space 3}0.878{col 54}{space 4} .0753053{col 67}{space 3} 9.125569
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2badjustedTVC, replace
{res}{txt}(note: file output/data/primaryobjective2badjustedTVC.ster not found)
{txt}file output/data/primaryobjective2badjustedTVC.ster saved

{com}. 
. *2b sensitivity 1: exclude GP non attenders
. stcox standil23 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m if gp_consult ==1

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-432.03395
{txt}Iteration 1:   log likelihood = {res} -419.6487
{txt}Iteration 2:   log likelihood = {res}-418.80963
{txt}Iteration 3:   log likelihood = {res}-418.79081
{txt}Iteration 4:   log likelihood = {res}-418.78838
{txt}Iteration 5:   log likelihood = {res}-418.78749
{txt}Iteration 6:   log likelihood = {res}-418.78716
{txt}Iteration 7:   log likelihood = {res}-418.78704
{txt}Iteration 8:   log likelihood = {res}  -418.787
{txt}Iteration 9:   log likelihood = {res}-418.78698
{txt}Iteration 10:  log likelihood = {res}-418.78698
{txt}Iteration 11:  log likelihood = {res}-418.78698
{txt}Iteration 12:  log likelihood = {res}-418.78697
{txt}Iteration 13:  log likelihood = {res}-418.78697
{txt}Iteration 14:  log likelihood = {res}-418.78697
{txt}Iteration 15:  log likelihood = {res}-418.78697
{txt}Iteration 16:  log likelihood = {res}-418.78697
{txt}Iteration 17:  log likelihood = {res}-418.78697
{txt}Iteration 18:  log likelihood = {res}-418.78697
{txt}Iteration 19:  log likelihood = {res}-418.78697
{txt}Iteration 20:  log likelihood = {res}-418.78697
{txt}Iteration 21:  log likelihood = {res}-418.78697
{txt}Iteration 22:  log likelihood = {res}-418.78697
{txt}Iteration 23:  log likelihood = {res}-418.78697
{txt}Iteration 24:  log likelihood = {res}-418.78697
{txt}Iteration 25:  log likelihood = {res}-418.78697
{txt}Iteration 26:  log likelihood = {res}-418.78697
{txt}Iteration 27:  log likelihood = {res}-418.78697
{txt}Iteration 28:  log likelihood = {res}-418.78697
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-418.78697
{txt}Iteration 1:   log likelihood = {res}-418.78697

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         721                  {txt}Number of obs    =  {res}       721
{txt}No. of failures = {res}          66
{txt}Time at risk    = {res} 412.9199179
                                                {txt}LR chi2({res}21{txt})      =  {res}     26.49
{txt}Log likelihood  =   {res}-418.78697                  {txt}Prob > chi2      =  {res}    0.1882

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil23 {c |}{col 14}{res}{space 2} 1.221478{col 26}{space 2} .3186891{col 37}{space 1}    0.77{col 46}{space 3}0.443{col 54}{space 4} .7324925{col 67}{space 3} 2.036892
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.249929{col 26}{space 2} .4204543{col 37}{space 1}    0.66{col 46}{space 3}0.507{col 54}{space 4}  .646481{col 67}{space 3} 2.416655
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} .8099951{col 26}{space 2} .3386475{col 37}{space 1}   -0.50{col 46}{space 3}0.614{col 54}{space 4} .3569497{col 67}{space 3} 1.838052
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .6982367{col 26}{space 2} .3071466{col 37}{space 1}   -0.82{col 46}{space 3}0.414{col 54}{space 4} .2948279{col 67}{space 3} 1.653624
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2}  .692813{col 26}{space 2} .3230679{col 37}{space 1}   -0.79{col 46}{space 3}0.431{col 54}{space 4} .2777726{col 67}{space 3} 1.727996
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 2.429533{col 26}{space 2} 1.025728{col 37}{space 1}    2.10{col 46}{space 3}0.036{col 54}{space 4} 1.062069{col 67}{space 3} 5.557671
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.034634{col 26}{space 2} .2599417{col 37}{space 1}    0.14{col 46}{space 3}0.892{col 54}{space 4} .6323108{col 67}{space 3} 1.692945
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4162051{col 26}{space 2}  .248392{col 37}{space 1}   -1.47{col 46}{space 3}0.142{col 54}{space 4} .1292137{col 67}{space 3} 1.340621
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.267207{col 26}{space 2} .4886017{col 37}{space 1}    0.61{col 46}{space 3}0.539{col 54}{space 4} .5951778{col 67}{space 3} 2.698041
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.119273{col 26}{space 2} .3358355{col 37}{space 1}    0.38{col 46}{space 3}0.707{col 54}{space 4} .6216339{col 67}{space 3} 2.015288
{txt}5 most de..  {c |}{col 14}{res}{space 2} .2799419{col 26}{space 2} .2035356{col 37}{space 1}   -1.75{col 46}{space 3}0.080{col 54}{space 4} .0673271{col 67}{space 3} 1.163981
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.139559{col 26}{space 2} .0969266{col 37}{space 1}    1.54{col 46}{space 3}0.125{col 54}{space 4} .9645771{col 67}{space 3} 1.346285
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.085265{col 26}{space 2} .2933096{col 37}{space 1}    0.30{col 46}{space 3}0.762{col 54}{space 4} .6389776{col 67}{space 3} 1.843258
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .5811975{col 26}{space 2} .1643844{col 37}{space 1}   -1.92{col 46}{space 3}0.055{col 54}{space 4}  .333866{col 67}{space 3} 1.011755
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.526456{col 26}{space 2}  .433493{col 37}{space 1}    1.49{col 46}{space 3}0.136{col 54}{space 4} .8748922{col 67}{space 3} 2.663263
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .7716781{col 26}{space 2} .2619601{col 37}{space 1}   -0.76{col 46}{space 3}0.445{col 54}{space 4} .3967166{col 67}{space 3} 1.501039
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9268464{col 26}{space 2} .2331048{col 37}{space 1}   -0.30{col 46}{space 3}0.763{col 54}{space 4} .5661453{col 67}{space 3} 1.517357
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2}  2.78132{col 26}{space 2} 2.865116{col 37}{space 1}    0.99{col 46}{space 3}0.321{col 54}{space 4} .3693214{col 67}{space 3} 20.94583
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.90e-13{col 26}{space 2} 1.36e-06{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.166751{col 26}{space 2} .3556101{col 37}{space 1}    0.51{col 46}{space 3}0.613{col 54}{space 4} .6420125{col 67}{space 3} 2.120377
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9514445{col 26}{space 2} .1215048{col 37}{space 1}   -0.39{col 46}{space 3}0.697{col 54}{space 4} .7407646{col 67}{space 3} 1.222044
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2bsensitivity1, replace
{res}{txt}(note: file output/data/primaryobjective2bsensitivity1.ster not found)
{txt}file output/data/primaryobjective2bsensitivity1.ster saved

{com}. 
. *2b sensitivity 2: Additional confounders
. stcox standil23 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m  ckd chronic_liver_disease chronic_respiratory_disease 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-722.13648
{txt}Iteration 1:   log likelihood = {res}-705.56914
{txt}Iteration 2:   log likelihood = {res}-705.15452
{txt}Iteration 3:   log likelihood = {res}-705.13957
{txt}Iteration 4:   log likelihood = {res}-705.13451
{txt}Iteration 5:   log likelihood = {res}-705.13265
{txt}Iteration 6:   log likelihood = {res}-705.13197
{txt}Iteration 7:   log likelihood = {res}-705.13171
{txt}Iteration 8:   log likelihood = {res}-705.13162
{txt}Iteration 9:   log likelihood = {res}-705.13159
{txt}Iteration 10:  log likelihood = {res}-705.13157
{txt}Iteration 11:  log likelihood = {res}-705.13157
{txt}Iteration 12:  log likelihood = {res}-705.13157
{txt}Iteration 13:  log likelihood = {res}-705.13157
{txt}Iteration 14:  log likelihood = {res}-705.13157
{txt}Iteration 15:  log likelihood = {res}-705.13157
{txt}Iteration 16:  log likelihood = {res}-705.13157
{txt}Iteration 17:  log likelihood = {res}-705.13157
{txt}Iteration 18:  log likelihood = {res}-705.13157
{txt}Iteration 19:  log likelihood = {res}-705.13157
{txt}Iteration 20:  log likelihood = {res}-705.13157
{txt}Iteration 21:  log likelihood = {res}-705.13157
{txt}Iteration 22:  log likelihood = {res}-705.13157
{txt}Iteration 23:  log likelihood = {res}-705.13157
{txt}Iteration 24:  log likelihood = {res}-705.13157
{txt}Iteration 25:  log likelihood = {res}-705.13157
{txt}Iteration 26:  log likelihood = {res}-705.13157
{txt}Iteration 27:  log likelihood = {res}-705.13157
{txt}Iteration 28:  log likelihood = {res}-705.13157
{txt}Iteration 29:  log likelihood = {res}-705.13157
{txt}Iteration 30:  log likelihood = {res}-705.13157
{txt}Iteration 31:  log likelihood = {res}-705.13157
{txt}Iteration 32:  log likelihood = {res}-705.13157
{txt}Iteration 33:  log likelihood = {res}-705.13157
{txt}Iteration 34:  log likelihood = {res}-705.13157
{txt}Iteration 35:  log likelihood = {res}-705.13157
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-705.13157
{txt}Iteration 1:   log likelihood = {res}-705.13157
{txt}Iteration 2:   log likelihood = {res}-705.13157
{txt}Iteration 3:   log likelihood = {res}-705.13157
{txt}Iteration 4:   log likelihood = {res}-705.13157

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,146                  {txt}Number of obs    =  {res}     1,146
{txt}No. of failures = {res}         103
{txt}Time at risk    = {res}  658.329911
                                                {txt}LR chi2({res}24{txt})      =  {res}     34.01
{txt}Log likelihood  =   {res}-705.13157                  {txt}Prob > chi2      =  {res}    0.0845

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil23 {c |}{col 14}{res}{space 2} 1.273438{col 26}{space 2} .2708196{col 37}{space 1}    1.14{col 46}{space 3}0.256{col 54}{space 4} .8393721{col 67}{space 3} 1.931974
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.524015{col 26}{space 2} .4395621{col 37}{space 1}    1.46{col 46}{space 3}0.144{col 54}{space 4} .8659296{col 67}{space 3}  2.68223
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.431589{col 26}{space 2}  .435904{col 37}{space 1}    1.18{col 46}{space 3}0.239{col 54}{space 4} .7881998{col 67}{space 3} 2.600162
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2}  1.12348{col 26}{space 2} .3754847{col 37}{space 1}    0.35{col 46}{space 3}0.728{col 54}{space 4} .5835534{col 67}{space 3} 2.162969
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.017455{col 26}{space 2} .3570261{col 37}{space 1}    0.05{col 46}{space 3}0.961{col 54}{space 4} .5114785{col 67}{space 3} 2.023964
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.560932{col 26}{space 2} .6108169{col 37}{space 1}    1.14{col 46}{space 3}0.255{col 54}{space 4}  .724929{col 67}{space 3}  3.36103
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.102692{col 26}{space 2} .2202791{col 37}{space 1}    0.49{col 46}{space 3}0.625{col 54}{space 4} .7454427{col 67}{space 3} 1.631152
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2}  .559059{col 26}{space 2} .2375597{col 37}{space 1}   -1.37{col 46}{space 3}0.171{col 54}{space 4} .2430851{col 67}{space 3} 1.285751
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.245703{col 26}{space 2} .3888565{col 37}{space 1}    0.70{col 46}{space 3}0.482{col 54}{space 4} .6756233{col 67}{space 3} 2.296805
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.310885{col 26}{space 2} .2989755{col 37}{space 1}    1.19{col 46}{space 3}0.235{col 54}{space 4}  .838359{col 67}{space 3} 2.049743
{txt}5 most de..  {c |}{col 14}{res}{space 2} .4641559{col 26}{space 2} .2161174{col 37}{space 1}   -1.65{col 46}{space 3}0.099{col 54}{space 4} .1863513{col 67}{space 3} 1.156099
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.050806{col 26}{space 2} .0689487{col 37}{space 1}    0.76{col 46}{space 3}0.450{col 54}{space 4} .9239974{col 67}{space 3} 1.195017
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.175646{col 26}{space 2}  .252213{col 37}{space 1}    0.75{col 46}{space 3}0.451{col 54}{space 4} .7720889{col 67}{space 3} 1.790136
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6915423{col 26}{space 2} .1489819{col 37}{space 1}   -1.71{col 46}{space 3}0.087{col 54}{space 4} .4533575{col 67}{space 3} 1.054865
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.505617{col 26}{space 2} .3369195{col 37}{space 1}    1.83{col 46}{space 3}0.067{col 54}{space 4} .9710391{col 67}{space 3}  2.33449
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5835413{col 26}{space 2}  .171129{col 37}{space 1}   -1.84{col 46}{space 3}0.066{col 54}{space 4} .3284345{col 67}{space 3} 1.036799
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9860857{col 26}{space 2} .1961759{col 37}{space 1}   -0.07{col 46}{space 3}0.944{col 54}{space 4} .6676874{col 67}{space 3} 1.456318
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.587366{col 26}{space 2} 2.639106{col 37}{space 1}    0.93{col 46}{space 3}0.351{col 54}{space 4} .3504569{col 67}{space 3}  19.1021
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 9.77e-18{col 26}{space 2} 7.17e-09{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.341266{col 26}{space 2} .3251902{col 37}{space 1}    1.21{col 46}{space 3}0.226{col 54}{space 4} .8339515{col 67}{space 3} 2.157192
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9061112{col 26}{space 2} .1047327{col 37}{space 1}   -0.85{col 46}{space 3}0.394{col 54}{space 4} .7224295{col 67}{space 3} 1.136495
{txt}{space 9}ckd {c |}{col 14}{res}{space 2} .8041777{col 26}{space 2} .1609111{col 37}{space 1}   -1.09{col 46}{space 3}0.276{col 54}{space 4}   .54329{col 67}{space 3} 1.190344
{txt}chronic_l~se {c |}{col 14}{res}{space 2} .7221848{col 26}{space 2} .1985128{col 37}{space 1}   -1.18{col 46}{space 3}0.236{col 54}{space 4} .4213778{col 67}{space 3} 1.237728
{txt}chronic_r~se {c |}{col 14}{res}{space 2} .5242015{col 26}{space 2} .1566737{col 37}{space 1}   -2.16{col 46}{space 3}0.031{col 54}{space 4} .2918035{col 67}{space 3} .9416857
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2bsensitivity2, replace
{res}{txt}(note: file output/data/primaryobjective2bsensitivity2.ster not found)
{txt}file output/data/primaryobjective2bsensitivity2.ster saved

{com}. 
. *2b sensitivity 3: restricted exposure window
. stcox standil233m i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res} -574.7107
{txt}Iteration 1:   log likelihood = {res}-561.51085
{txt}Iteration 2:   log likelihood = {res}-559.68705
{txt}Iteration 3:   log likelihood = {res}-559.48641
{txt}Iteration 4:   log likelihood = {res}-559.47424
{txt}Iteration 5:   log likelihood = {res}-559.47246
{txt}Iteration 6:   log likelihood = {res}-559.47181
{txt}Iteration 7:   log likelihood = {res}-559.47157
{txt}Iteration 8:   log likelihood = {res}-559.47149
{txt}Iteration 9:   log likelihood = {res}-559.47145
{txt}Iteration 10:  log likelihood = {res}-559.47144
{txt}Iteration 11:  log likelihood = {res}-559.47144
{txt}Iteration 12:  log likelihood = {res}-559.47144
{txt}Iteration 13:  log likelihood = {res}-559.47144
{txt}Iteration 14:  log likelihood = {res}-559.47143
{txt}Iteration 15:  log likelihood = {res}-559.47143
{txt}Iteration 16:  log likelihood = {res}-559.47143
{txt}Iteration 17:  log likelihood = {res}-559.47143
{txt}Iteration 18:  log likelihood = {res}-559.47143
{txt}Iteration 19:  log likelihood = {res}-559.47143
{txt}Iteration 20:  log likelihood = {res}-559.47143
{txt}Iteration 21:  log likelihood = {res}-559.47143
{txt}Iteration 22:  log likelihood = {res}-559.47143
{txt}Iteration 23:  log likelihood = {res}-559.47143
{txt}Iteration 24:  log likelihood = {res}-559.47143
{txt}Iteration 25:  log likelihood = {res}-559.47143
{txt}Iteration 26:  log likelihood = {res}-559.47143
{txt}Iteration 27:  log likelihood = {res}-559.47143
{txt}Iteration 28:  log likelihood = {res}-559.47143
{txt}Iteration 29:  log likelihood = {res}-559.47143
{txt}Iteration 30:  log likelihood = {res}-559.47143
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-559.47143
{txt}Iteration 1:   log likelihood = {res}-559.47143
{txt}Iteration 2:   log likelihood = {res}-559.47143

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         967                  {txt}Number of obs    =  {res}       967
{txt}No. of failures = {res}          84
{txt}Time at risk    = {res}  555.394935
                                                {txt}LR chi2({res}21{txt})      =  {res}     30.48
{txt}Log likelihood  =   {res}-559.47143                  {txt}Prob > chi2      =  {res}    0.0828

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 1}standil233m {c |}{col 14}{res}{space 2} 1.169623{col 26}{space 2} .2621858{col 37}{space 1}    0.70{col 46}{space 3}0.485{col 54}{space 4} .7537694{col 67}{space 3} 1.814904
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.322147{col 26}{space 2} .4253654{col 37}{space 1}    0.87{col 46}{space 3}0.385{col 54}{space 4} .7037661{col 67}{space 3} 2.483883
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2}  1.45554{col 26}{space 2} .4766186{col 37}{space 1}    1.15{col 46}{space 3}0.252{col 54}{space 4} .7661208{col 67}{space 3} 2.765358
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.097015{col 26}{space 2} .4040682{col 37}{space 1}    0.25{col 46}{space 3}0.802{col 54}{space 4}  .532949{col 67}{space 3} 2.258079
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .8696005{col 26}{space 2}  .343804{col 37}{space 1}   -0.35{col 46}{space 3}0.724{col 54}{space 4} .4006729{col 67}{space 3} 1.887338
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.571219{col 26}{space 2} .6535212{col 37}{space 1}    1.09{col 46}{space 3}0.277{col 54}{space 4} .6953356{col 67}{space 3} 3.550416
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} .8812105{col 26}{space 2} .1959838{col 37}{space 1}   -0.57{col 46}{space 3}0.570{col 54}{space 4} .5698623{col 67}{space 3} 1.362666
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .5602047{col 26}{space 2} .2618305{col 37}{space 1}   -1.24{col 46}{space 3}0.215{col 54}{space 4} .2241347{col 67}{space 3} 1.400181
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.291708{col 26}{space 2} .4421666{col 37}{space 1}    0.75{col 46}{space 3}0.455{col 54}{space 4} .6603717{col 67}{space 3} 2.526623
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.407767{col 26}{space 2}  .355745{col 37}{space 1}    1.35{col 46}{space 3}0.176{col 54}{space 4} .8578887{col 67}{space 3}   2.3101
{txt}5 most de..  {c |}{col 14}{res}{space 2}  .240861{col 26}{space 2} .1739091{col 37}{space 1}   -1.97{col 46}{space 3}0.049{col 54}{space 4} .0585022{col 67}{space 3} .9916545
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.000208{col 26}{space 2} .0723529{col 37}{space 1}    0.00{col 46}{space 3}0.998{col 54}{space 4} .8679932{col 67}{space 3} 1.152562
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.012647{col 26}{space 2} .2258007{col 37}{space 1}    0.06{col 46}{space 3}0.955{col 54}{space 4} .6541192{col 67}{space 3} 1.567688
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6592426{col 26}{space 2} .1557333{col 37}{space 1}   -1.76{col 46}{space 3}0.078{col 54}{space 4}  .414921{col 67}{space 3}  1.04743
{txt}{space 7}joint {c |}{col 14}{res}{space 2}   1.7328{col 26}{space 2} .4134193{col 37}{space 1}    2.30{col 46}{space 3}0.021{col 54}{space 4} 1.085588{col 67}{space 3} 2.765871
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5777593{col 26}{space 2} .1903966{col 37}{space 1}   -1.66{col 46}{space 3}0.096{col 54}{space 4} .3028582{col 67}{space 3} 1.102185
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} 1.028659{col 26}{space 2} .2270871{col 37}{space 1}    0.13{col 46}{space 3}0.898{col 54}{space 4} .6673595{col 67}{space 3} 1.585561
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 4.610224{col 26}{space 2} 4.748731{col 37}{space 1}    1.48{col 46}{space 3}0.138{col 54}{space 4} .6122763{col 67}{space 3} 34.71336
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.14e-14{col 26}{space 2} 2.59e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.607866{col 26}{space 2} .4080144{col 37}{space 1}    1.87{col 46}{space 3}0.061{col 54}{space 4} .9777949{col 67}{space 3} 2.643943
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9139454{col 26}{space 2} .1173677{col 37}{space 1}   -0.70{col 46}{space 3}0.483{col 54}{space 4} .7105753{col 67}{space 3} 1.175521
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2bsensitivity3, replace
{res}{txt}(note: file output/data/primaryobjective2bsensitivity3.ster not found)
{txt}file output/data/primaryobjective2bsensitivity3.ster saved

{com}. 
. *2b sensitivity 4: covid positivity 
. stset stopswab, id(patient_id) failure(first_pos_test_sgss==1) origin(time enter_date) scale(365.25)  exit(first_pos_test_sgss==1 time mdy(10,01,2020))

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}first_pos_test_sgss == 1
{txt}obs. time interval:  {res}(stopswab[_n-1], stopswab]
{txt} exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}        401{txt}  observations end on or before enter()
{hline 78}
{res}     38,953{txt}  observations remaining, representing
{res}     38,953{txt}  subjects
{res}      3,506{txt}  failures in single-failure-per-subject data
{res} 22,262.631{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}. stcox standil23 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-722.13648
{txt}Iteration 1:   log likelihood = {res}-709.43708
{txt}Iteration 2:   log likelihood = {res} -709.1242
{txt}Iteration 3:   log likelihood = {res}-709.10845
{txt}Iteration 4:   log likelihood = {res} -709.1032
{txt}Iteration 5:   log likelihood = {res}-709.10127
{txt}Iteration 6:   log likelihood = {res}-709.10055
{txt}Iteration 7:   log likelihood = {res}-709.10029
{txt}Iteration 8:   log likelihood = {res} -709.1002
{txt}Iteration 9:   log likelihood = {res}-709.10016
{txt}Iteration 10:  log likelihood = {res}-709.10015
{txt}Iteration 11:  log likelihood = {res}-709.10014
{txt}Iteration 12:  log likelihood = {res}-709.10014
{txt}Iteration 13:  log likelihood = {res}-709.10014
{txt}Iteration 14:  log likelihood = {res}-709.10014
{txt}Iteration 15:  log likelihood = {res}-709.10014
{txt}Iteration 16:  log likelihood = {res}-709.10014
{txt}Iteration 17:  log likelihood = {res}-709.10014
{txt}Iteration 18:  log likelihood = {res}-709.10014
{txt}Iteration 19:  log likelihood = {res}-709.10014
{txt}Iteration 20:  log likelihood = {res}-709.10014
{txt}Iteration 21:  log likelihood = {res}-709.10014
{txt}Iteration 22:  log likelihood = {res}-709.10014
{txt}Iteration 23:  log likelihood = {res}-709.10014
{txt}Iteration 24:  log likelihood = {res}-709.10014
{txt}Iteration 25:  log likelihood = {res}-709.10014
{txt}Iteration 26:  log likelihood = {res}-709.10014
{txt}Iteration 27:  log likelihood = {res}-709.10014
{txt}Iteration 28:  log likelihood = {res}-709.10014
{txt}Iteration 29:  log likelihood = {res}-709.10014
{txt}Iteration 30:  log likelihood = {res}-709.10014
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-709.10014
{txt}Iteration 1:   log likelihood = {res}-709.10014

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,146                  {txt}Number of obs    =  {res}     1,146
{txt}No. of failures = {res}         103
{txt}Time at risk    = {res}  658.329911
                                                {txt}LR chi2({res}21{txt})      =  {res}     26.07
{txt}Log likelihood  =   {res}-709.10014                  {txt}Prob > chi2      =  {res}    0.2037

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil23 {c |}{col 14}{res}{space 2}  1.26679{col 26}{space 2} .2675998{col 37}{space 1}    1.12{col 46}{space 3}0.263{col 54}{space 4} .8373262{col 67}{space 3} 1.916525
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.525634{col 26}{space 2} .4390755{col 37}{space 1}    1.47{col 46}{space 3}0.142{col 54}{space 4} .8679119{col 67}{space 3} 2.681792
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.376296{col 26}{space 2} .4184126{col 37}{space 1}    1.05{col 46}{space 3}0.293{col 54}{space 4}  .758464{col 67}{space 3} 2.497403
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.141165{col 26}{space 2}  .380635{col 37}{space 1}    0.40{col 46}{space 3}0.692{col 54}{space 4} .5935138{col 67}{space 3}  2.19415
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.054498{col 26}{space 2} .3695607{col 37}{space 1}    0.15{col 46}{space 3}0.880{col 54}{space 4}  .530558{col 67}{space 3} 2.095844
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.558419{col 26}{space 2} .6086534{col 37}{space 1}    1.14{col 46}{space 3}0.256{col 54}{space 4} .7248372{col 67}{space 3} 3.350642
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.110413{col 26}{space 2} .2215515{col 37}{space 1}    0.52{col 46}{space 3}0.600{col 54}{space 4} .7510198{col 67}{space 3}  1.64179
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .5564895{col 26}{space 2} .2367319{col 37}{space 1}   -1.38{col 46}{space 3}0.168{col 54}{space 4} .2417429{col 67}{space 3} 1.281032
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.210047{col 26}{space 2} .3765836{col 37}{space 1}    0.61{col 46}{space 3}0.540{col 54}{space 4} .6575007{col 67}{space 3} 2.226937
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2}  1.32992{col 26}{space 2}  .303034{col 37}{space 1}    1.25{col 46}{space 3}0.211{col 54}{space 4} .8508868{col 67}{space 3}  2.07864
{txt}5 most de..  {c |}{col 14}{res}{space 2} .4750572{col 26}{space 2} .2209528{col 37}{space 1}   -1.60{col 46}{space 3}0.110{col 54}{space 4} .1909174{col 67}{space 3} 1.182078
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.060448{col 26}{space 2} .0694482{col 37}{space 1}    0.90{col 46}{space 3}0.370{col 54}{space 4} .9327057{col 67}{space 3} 1.205686
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.151385{col 26}{space 2} .2463114{col 37}{space 1}    0.66{col 46}{space 3}0.510{col 54}{space 4} .7570534{col 67}{space 3} 1.751116
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6932738{col 26}{space 2} .1485099{col 37}{space 1}   -1.71{col 46}{space 3}0.087{col 54}{space 4} .4555797{col 67}{space 3} 1.054982
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.480982{col 26}{space 2} .3311442{col 37}{space 1}    1.76{col 46}{space 3}0.079{col 54}{space 4} .9554829{col 67}{space 3} 2.295495
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6061135{col 26}{space 2} .1769172{col 37}{space 1}   -1.72{col 46}{space 3}0.086{col 54}{space 4} .3420571{col 67}{space 3} 1.074013
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9925931{col 26}{space 2} .1972552{col 37}{space 1}   -0.04{col 46}{space 3}0.970{col 54}{space 4} .6723795{col 67}{space 3} 1.465305
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.931458{col 26}{space 2} 2.984505{col 37}{space 1}    1.06{col 46}{space 3}0.291{col 54}{space 4} .3985465{col 67}{space 3} 21.56197
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 3.08e-14{col 26}{space 2} 4.06e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.313857{col 26}{space 2} .3181594{col 37}{space 1}    1.13{col 46}{space 3}0.260{col 54}{space 4} .8173801{col 67}{space 3} 2.111895
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9189353{col 26}{space 2} .1056386{col 37}{space 1}   -0.74{col 46}{space 3}0.462{col 54}{space 4} .7335553{col 67}{space 3} 1.151164
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2bsensitivity4, replace
{res}{txt}(note: file output/data/primaryobjective2bsensitivity4.ster not found)
{txt}file output/data/primaryobjective2bsensitivity4.ster saved

{com}. 
. *2c: Il17 vs standard systemics (Psoriasis, PsA and AxSpa only) 
. 
. stcox standil17, 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-25255.328
{txt}Iteration 1:   log likelihood = {res}-25254.929
{txt}Iteration 2:   log likelihood = {res}-25254.929
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-25254.929

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      27,547                  {txt}Number of obs    =  {res}    27,547
{txt}No. of failures = {res}       2,479
{txt}Time at risk    = {res} 15743.46886
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.80
{txt}Log likelihood  =   {res}-25254.929                  {txt}Prob > chi2      =  {res}    0.3716

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil17 {c |}{col 14}{res}{space 2} .9611919{col 26}{space 2} .0427027{col 37}{space 1}   -0.89{col 46}{space 3}0.373{col 54}{space 4} .8810366{col 67}{space 3}  1.04864
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2cunadj, replace
{res}{txt}(note: file output/data/primaryobjective2cunadj.ster not found)
{txt}file output/data/primaryobjective2cunadj.ster saved

{com}. sts graph, by(standil17) xtitle("Analysis time (years)") saving(primeob2b, replace)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(file primeob2b.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2c.pdf", as(pdf) replace
{txt}(file output/figures/primeob2c.pdf written in PDF format)

{com}. sts graph, cumhaz by(standil17) xtitle("Analysis time (years)") tmax(0.58) legend(order(1 "Standard Systemic" 2 "il17"))  saving(primeob2b_NA, replace)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(file primeob2b_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2c_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob2c_NA.pdf written in PDF format)

{com}. 
. ** Testing assumptions of proportional hazard model
. stcox standil17

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-25255.328
{txt}Iteration 1:   log likelihood = {res}-25254.929
{txt}Iteration 2:   log likelihood = {res}-25254.929
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-25254.929

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      27,547                  {txt}Number of obs    =  {res}    27,547
{txt}No. of failures = {res}       2,479
{txt}Time at risk    = {res} 15743.46886
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.80
{txt}Log likelihood  =   {res}-25254.929                  {txt}Prob > chi2      =  {res}    0.3716

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil17 {c |}{col 14}{res}{space 2} .9611919{col 26}{space 2} .0427027{col 37}{space 1}   -0.89{col 46}{space 3}0.373{col 54}{space 4} .8810366{col 67}{space 3}  1.04864
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. stptime, per (1000) by (standil17)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(11525 missing values generated)

 standil17{col 12}{c |}{col 15}person-time{col 29}failures{col 45}rate{col 52}[95% Conf. Interval]
{hline 11}{c +}{hline 59}
         0{col 12}{c |}{col 16}{res} 11107.006{col 29}    1769{col 39} 159.26884{col 51} 152.0172{col 63} 166.8664
         {txt}1{col 12}{c |}{col 16}{res} 4636.4627{col 29}     710{col 39} 153.13398{col 51} 142.2743{col 63} 164.8225
{txt}{hline 11}{c +}{hline 59}
     total{col 12}{c |}{col 16}{res} 15743.469{col 29}    2479{col 39} 157.46212{col 51}  151.384{col 63} 163.7842
{txt}
{com}. stphtest, log detail

{txt}      Test of proportional-hazards assumption

      Time:  {res}Log(t)
{txt}      {hline 12}{c TT}{hline 51}
                  {c |}       rho            chi2       df       Prob>chi2
      {hline 12}{c +}{hline 51}
      standil17{col 19}{c |}{res}{col 25}-0.00794{col 37}     0.16{col 50}    1{col 64}0.6926
{txt}      {hline 12}{c +}{hline 51}
      global test {c |}{res}{col 37}     0.16{col 50}    1{col 64}0.6926
{txt}      {hline 12}{c BT}{hline 51}

{com}. stphtest, log plot(standil17) yline(0) 
{res}{txt}
{com}. 
. *if TVC significant, need to use models with tvc
. stcox standil17, tvc(standil17) 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-25255.328
{txt}Iteration 1:   log likelihood = {res}-25254.708
{txt}Iteration 2:   log likelihood = {res}-25254.708
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-25254.708

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      27,547                  {txt}Number of obs    =  {res}    27,547
{txt}No. of failures = {res}       2,479
{txt}Time at risk    = {res} 15743.46886
                                                {txt}LR chi2({res}2{txt})       =  {res}      1.24
{txt}Log likelihood  =   {res}-25254.708                  {txt}Prob > chi2      =  {res}    0.5382

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 3}standil17 {c |}{col 14}{res}{space 2} 1.025438{col 26}{space 2} .1094154{col 37}{space 1}    0.24{col 46}{space 3}0.814{col 54}{space 4} .8319269{col 67}{space 3} 1.263961
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 3}standil17 {c |}{col 14}{res}{space 2} .8587399{col 26}{space 2} .1966395{col 37}{space 1}   -0.67{col 46}{space 3}0.506{col 54}{space 4} .5482118{col 67}{space 3} 1.345163
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2cTVCtest, replace 
{res}{txt}(note: file output/data/primaryobjective2cTVCtest.ster not found)
{txt}file output/data/primaryobjective2cTVCtest.ster saved

{com}. 
. stcox standil17 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-664.49453
{txt}Iteration 1:   log likelihood = {res}-654.09343
{txt}Iteration 2:   log likelihood = {res} -653.8169
{txt}Iteration 3:   log likelihood = {res}-653.80093
{txt}Iteration 4:   log likelihood = {res}-653.79547
{txt}Iteration 5:   log likelihood = {res}-653.79347
{txt}Iteration 6:   log likelihood = {res}-653.79273
{txt}Iteration 7:   log likelihood = {res}-653.79246
{txt}Iteration 8:   log likelihood = {res}-653.79236
{txt}Iteration 9:   log likelihood = {res}-653.79232
{txt}Iteration 10:  log likelihood = {res}-653.79231
{txt}Iteration 11:  log likelihood = {res} -653.7923
{txt}Iteration 12:  log likelihood = {res} -653.7923
{txt}Iteration 13:  log likelihood = {res} -653.7923
{txt}Iteration 14:  log likelihood = {res} -653.7923
{txt}Iteration 15:  log likelihood = {res} -653.7923
{txt}Iteration 16:  log likelihood = {res} -653.7923
{txt}Iteration 17:  log likelihood = {res} -653.7923
{txt}Iteration 18:  log likelihood = {res} -653.7923
{txt}Iteration 19:  log likelihood = {res} -653.7923
{txt}Iteration 20:  log likelihood = {res} -653.7923
{txt}Iteration 21:  log likelihood = {res} -653.7923
{txt}Iteration 22:  log likelihood = {res} -653.7923
{txt}Iteration 23:  log likelihood = {res} -653.7923
{txt}Iteration 24:  log likelihood = {res} -653.7923
{txt}Iteration 25:  log likelihood = {res} -653.7923
{txt}Iteration 26:  log likelihood = {res} -653.7923
{txt}Iteration 27:  log likelihood = {res} -653.7923
{txt}Iteration 28:  log likelihood = {res} -653.7923
{txt}Refining estimates:
Iteration 0:   log likelihood = {res} -653.7923
{txt}Iteration 1:   log likelihood = {res} -653.7923
{txt}Iteration 2:   log likelihood = {res} -653.7923

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,049                  {txt}Number of obs    =  {res}     1,049
{txt}No. of failures = {res}          96
{txt}Time at risk    = {res} 602.5708419
                                                {txt}LR chi2({res}21{txt})      =  {res}     21.40
{txt}Log likelihood  =   {res} -653.7923                  {txt}Prob > chi2      =  {res}    0.4345

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil17 {c |}{col 14}{res}{space 2} 1.138637{col 26}{space 2} .2627918{col 37}{space 1}    0.56{col 46}{space 3}0.574{col 54}{space 4}  .724323{col 67}{space 3}  1.78994
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.481504{col 26}{space 2} .4553881{col 37}{space 1}    1.28{col 46}{space 3}0.201{col 54}{space 4}   .81107{col 67}{space 3}  2.70612
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.474113{col 26}{space 2} .4663166{col 37}{space 1}    1.23{col 46}{space 3}0.220{col 54}{space 4} .7929838{col 67}{space 3} 2.740296
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.097938{col 26}{space 2} .3927335{col 37}{space 1}    0.26{col 46}{space 3}0.794{col 54}{space 4} .5446311{col 67}{space 3} 2.213367
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.246441{col 26}{space 2} .4340752{col 37}{space 1}    0.63{col 46}{space 3}0.527{col 54}{space 4} .6298534{col 67}{space 3} 2.466631
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.916129{col 26}{space 2} .7323115{col 37}{space 1}    1.70{col 46}{space 3}0.089{col 54}{space 4} .9059621{col 67}{space 3} 4.052652
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.162091{col 26}{space 2} .2409552{col 37}{space 1}    0.72{col 46}{space 3}0.469{col 54}{space 4}   .77401{col 67}{space 3} 1.744751
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4764104{col 26}{space 2} .2208992{col 37}{space 1}   -1.60{col 46}{space 3}0.110{col 54}{space 4} .1919999{col 67}{space 3}  1.18212
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.149662{col 26}{space 2} .3727662{col 37}{space 1}    0.43{col 46}{space 3}0.667{col 54}{space 4} .6089432{col 67}{space 3} 2.170519
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.128406{col 26}{space 2} .2784905{col 37}{space 1}    0.49{col 46}{space 3}0.624{col 54}{space 4} .6956469{col 67}{space 3} 1.830382
{txt}5 most de..  {c |}{col 14}{res}{space 2}  .620083{col 26}{space 2} .2655113{col 37}{space 1}   -1.12{col 46}{space 3}0.264{col 54}{space 4} .2679024{col 67}{space 3} 1.435235
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.058401{col 26}{space 2} .0720764{col 37}{space 1}    0.83{col 46}{space 3}0.405{col 54}{space 4} .9261553{col 67}{space 3} 1.209529
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.214055{col 26}{space 2} .2672835{col 37}{space 1}    0.88{col 46}{space 3}0.378{col 54}{space 4} .7885694{col 67}{space 3} 1.869119
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7342584{col 26}{space 2} .1636622{col 37}{space 1}   -1.39{col 46}{space 3}0.166{col 54}{space 4} .4743738{col 67}{space 3}  1.13652
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.449734{col 26}{space 2} .3510345{col 37}{space 1}    1.53{col 46}{space 3}0.125{col 54}{space 4} .9019465{col 67}{space 3} 2.330214
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6919895{col 26}{space 2} .2041881{col 37}{space 1}   -1.25{col 46}{space 3}0.212{col 54}{space 4} .3880896{col 67}{space 3} 1.233863
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9742557{col 26}{space 2} .2008126{col 37}{space 1}   -0.13{col 46}{space 3}0.899{col 54}{space 4} .6504653{col 67}{space 3} 1.459223
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.758641{col 26}{space 2} 2.817869{col 37}{space 1}    0.99{col 46}{space 3}0.321{col 54}{space 4} .3725792{col 67}{space 3} 20.42546
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 8.39e-14{col 26}{space 2} 6.59e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.252589{col 26}{space 2} .3179646{col 37}{space 1}    0.89{col 46}{space 3}0.375{col 54}{space 4} .7616138{col 67}{space 3} 2.060073
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .8625272{col 26}{space 2} .1156369{col 37}{space 1}   -1.10{col 46}{space 3}0.270{col 54}{space 4}  .663215{col 67}{space 3} 1.121738
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2cadjusted, replace
{res}{txt}(note: file output/data/primaryobjective2cadjusted.ster not found)
{txt}file output/data/primaryobjective2cadjusted.ster saved

{com}. 
. *TVC Analysis
. stcox standil17 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m, tvc(standil17) 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-664.49453
{txt}Iteration 1:   log likelihood = {res}-654.05867
{txt}Iteration 2:   log likelihood = {res}-653.78216
{txt}Iteration 3:   log likelihood = {res}-653.76619
{txt}Iteration 4:   log likelihood = {res}-653.76073
{txt}Iteration 5:   log likelihood = {res}-653.75873
{txt}Iteration 6:   log likelihood = {res}-653.75799
{txt}Iteration 7:   log likelihood = {res}-653.75772
{txt}Iteration 8:   log likelihood = {res}-653.75762
{txt}Iteration 9:   log likelihood = {res}-653.75758
{txt}Iteration 10:  log likelihood = {res}-653.75757
{txt}Iteration 11:  log likelihood = {res}-653.75756
{txt}Iteration 12:  log likelihood = {res}-653.75756
{txt}Iteration 13:  log likelihood = {res}-653.75756
{txt}Iteration 14:  log likelihood = {res}-653.75756
{txt}Iteration 15:  log likelihood = {res}-653.75756
{txt}Iteration 16:  log likelihood = {res}-653.75756
{txt}Iteration 17:  log likelihood = {res}-653.75756
{txt}Iteration 18:  log likelihood = {res}-653.75756
{txt}Iteration 19:  log likelihood = {res}-653.75756
{txt}Iteration 20:  log likelihood = {res}-653.75756
{txt}Iteration 21:  log likelihood = {res}-653.75756
{txt}Iteration 22:  log likelihood = {res}-653.75756
{txt}Iteration 23:  log likelihood = {res}-653.75756
{txt}Iteration 24:  log likelihood = {res}-653.75756
{txt}Iteration 25:  log likelihood = {res}-653.75756
{txt}Iteration 26:  log likelihood = {res}-653.75756
{txt}Iteration 27:  log likelihood = {res}-653.75756
{txt}Iteration 28:  log likelihood = {res}-653.75756
{txt}Iteration 29:  log likelihood = {res}-653.75756
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-653.75756
{txt}Iteration 1:   log likelihood = {res}-653.75756

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,049                  {txt}Number of obs    =  {res}     1,049
{txt}No. of failures = {res}          96
{txt}Time at risk    = {res} 602.5708419
                                                {txt}LR chi2({res}22{txt})      =  {res}     21.47
{txt}Log likelihood  =   {res}-653.75756                  {txt}Prob > chi2      =  {res}    0.4916

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 3}standil17 {c |}{col 14}{res}{space 2} 1.329409{col 26}{space 2} .8350937{col 37}{space 1}    0.45{col 46}{space 3}0.650{col 54}{space 4} .3881144{col 67}{space 3} 4.553624
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.482066{col 26}{space 2} .4555674{col 37}{space 1}    1.28{col 46}{space 3}0.201{col 54}{space 4} .8113711{col 67}{space 3}  2.70717
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.474448{col 26}{space 2} .4664265{col 37}{space 1}    1.23{col 46}{space 3}0.220{col 54}{space 4} .7931593{col 67}{space 3} 2.740932
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.098023{col 26}{space 2} .3927623{col 37}{space 1}    0.26{col 46}{space 3}0.794{col 54}{space 4} .5446744{col 67}{space 3} 2.213532
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.246646{col 26}{space 2} .4341464{col 37}{space 1}    0.63{col 46}{space 3}0.527{col 54}{space 4} .6299567{col 67}{space 3} 2.467036
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.916678{col 26}{space 2} .7325245{col 37}{space 1}    1.70{col 46}{space 3}0.089{col 54}{space 4} .9062194{col 67}{space 3} 4.053827
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.162356{col 26}{space 2}  .241006{col 37}{space 1}    0.73{col 46}{space 3}0.468{col 54}{space 4} .7741924{col 67}{space 3} 1.745137
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2}  .476416{col 26}{space 2}  .220901{col 37}{space 1}   -1.60{col 46}{space 3}0.110{col 54}{space 4} .1920028{col 67}{space 3}  1.18213
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.150266{col 26}{space 2} .3729725{col 37}{space 1}    0.43{col 46}{space 3}0.666{col 54}{space 4} .6092521{col 67}{space 3} 2.171698
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.128376{col 26}{space 2} .2784828{col 37}{space 1}    0.49{col 46}{space 3}0.625{col 54}{space 4} .6956291{col 67}{space 3} 1.830333
{txt}5 most de..  {c |}{col 14}{res}{space 2} .6199906{col 26}{space 2} .2654714{col 37}{space 1}   -1.12{col 46}{space 3}0.264{col 54}{space 4} .2678628{col 67}{space 3}  1.43502
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.058417{col 26}{space 2} .0720777{col 37}{space 1}    0.83{col 46}{space 3}0.404{col 54}{space 4} .9261691{col 67}{space 3} 1.209548
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  1.21387{col 26}{space 2} .2672465{col 37}{space 1}    0.88{col 46}{space 3}0.379{col 54}{space 4} .7884443{col 67}{space 3} 1.868845
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7338199{col 26}{space 2} .1635717{col 37}{space 1}   -1.39{col 46}{space 3}0.165{col 54}{space 4} .4740814{col 67}{space 3} 1.135863
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.449386{col 26}{space 2} .3509679{col 37}{space 1}    1.53{col 46}{space 3}0.125{col 54}{space 4}  .901708{col 67}{space 3}  2.32971
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6921143{col 26}{space 2} .2042288{col 37}{space 1}   -1.25{col 46}{space 3}0.212{col 54}{space 4} .3881554{col 67}{space 3} 1.234099
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9743766{col 26}{space 2} .2008344{col 37}{space 1}   -0.13{col 46}{space 3}0.900{col 54}{space 4} .6505501{col 67}{space 3} 1.459395
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.758101{col 26}{space 2} 2.817317{col 37}{space 1}    0.99{col 46}{space 3}0.321{col 54}{space 4} .3725062{col 67}{space 3} 20.42146
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 8.40e-14{col 26}{space 2} 6.59e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.252297{col 26}{space 2} .3178851{col 37}{space 1}    0.89{col 46}{space 3}0.375{col 54}{space 4} .7614422{col 67}{space 3} 2.059575
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .8626079{col 26}{space 2} .1156437{col 37}{space 1}   -1.10{col 46}{space 3}0.270{col 54}{space 4}  .663283{col 67}{space 3} 1.121832
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 3}standil17 {c |}{col 14}{res}{space 2} .7135654{col 26}{space 2} .9112196{col 37}{space 1}   -0.26{col 46}{space 3}0.792{col 54}{space 4} .0584055{col 67}{space 3} 8.717944
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2cadjustedTVC, replace
{res}{txt}(note: file output/data/primaryobjective2cadjustedTVC.ster not found)
{txt}file output/data/primaryobjective2cadjustedTVC.ster saved

{com}. 
. *2c sensitivity 1: exclude GP non attenders
. stcox standil17 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m if gp_consult ==1

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-394.44114
{txt}Iteration 1:   log likelihood = {res}-381.90635
{txt}Iteration 2:   log likelihood = {res}-380.20169
{txt}Iteration 3:   log likelihood = {res}-380.16067
{txt}Iteration 4:   log likelihood = {res} -380.1584
{txt}Iteration 5:   log likelihood = {res}-380.15757
{txt}Iteration 6:   log likelihood = {res}-380.15727
{txt}Iteration 7:   log likelihood = {res}-380.15716
{txt}Iteration 8:   log likelihood = {res}-380.15712
{txt}Iteration 9:   log likelihood = {res} -380.1571
{txt}Iteration 10:  log likelihood = {res} -380.1571
{txt}Iteration 11:  log likelihood = {res}-380.15709
{txt}Iteration 12:  log likelihood = {res}-380.15709
{txt}Iteration 13:  log likelihood = {res}-380.15709
{txt}Iteration 14:  log likelihood = {res}-380.15709
{txt}Iteration 15:  log likelihood = {res}-380.15709
{txt}Iteration 16:  log likelihood = {res}-380.15709
{txt}Iteration 17:  log likelihood = {res}-380.15709
{txt}Iteration 18:  log likelihood = {res}-380.15709
{txt}Iteration 19:  log likelihood = {res}-380.15709
{txt}Iteration 20:  log likelihood = {res}-380.15709
{txt}Iteration 21:  log likelihood = {res}-380.15709
{txt}Iteration 22:  log likelihood = {res}-380.15709
{txt}Iteration 23:  log likelihood = {res}-380.15709
{txt}Iteration 24:  log likelihood = {res}-380.15709
{txt}Iteration 25:  log likelihood = {res}-380.15709
{txt}Iteration 26:  log likelihood = {res}-380.15709
{txt}Iteration 27:  log likelihood = {res}-380.15709
{txt}Iteration 28:  log likelihood = {res}-380.15709
{txt}Iteration 29:  log likelihood = {res}-380.15709
{txt}Iteration 30:  log likelihood = {res}-380.15709
{txt}Iteration 31:  log likelihood = {res}-380.15709
{txt}Iteration 32:  log likelihood = {res}-380.15709
{txt}Iteration 33:  log likelihood = {res}-380.15709
{txt}Iteration 34:  log likelihood = {res}-380.15709
{txt}Iteration 35:  log likelihood = {res}-380.15709
{txt}Iteration 36:  log likelihood = {res}-380.15709
{txt}Iteration 37:  log likelihood = {res}-380.15709
{txt}Iteration 38:  log likelihood = {res}-380.15709
{txt}Iteration 39:  log likelihood = {res}-380.15709
{txt}Iteration 40:  log likelihood = {res}-380.15709
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-380.15709
{txt}Iteration 1:   log likelihood = {res}-380.15709

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         666                  {txt}Number of obs    =  {res}       666
{txt}No. of failures = {res}          61
{txt}Time at risk    = {res} 381.5386721
                                                {txt}LR chi2({res}21{txt})      =  {res}     28.57
{txt}Log likelihood  =   {res}-380.15709                  {txt}Prob > chi2      =  {res}    0.1248

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil17 {c |}{col 14}{res}{space 2} 1.048952{col 26}{space 2} .3085249{col 37}{space 1}    0.16{col 46}{space 3}0.871{col 54}{space 4}  .589379{col 67}{space 3} 1.866882
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.389109{col 26}{space 2} .5095828{col 37}{space 1}    0.90{col 46}{space 3}0.370{col 54}{space 4} .6768309{col 67}{space 3} 2.850968
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.028791{col 26}{space 2} .4446995{col 37}{space 1}    0.07{col 46}{space 3}0.948{col 54}{space 4} .4409524{col 67}{space 3} 2.400285
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} .7041693{col 26}{space 2} .3371421{col 37}{space 1}   -0.73{col 46}{space 3}0.464{col 54}{space 4} .2755109{col 67}{space 3} 1.799763
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2}  .960061{col 26}{space 2} .4345776{col 37}{space 1}   -0.09{col 46}{space 3}0.928{col 54}{space 4}  .395364{col 67}{space 3} 2.331313
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 3.348968{col 26}{space 2} 1.407918{col 37}{space 1}    2.87{col 46}{space 3}0.004{col 54}{space 4} 1.469139{col 67}{space 3} 7.634124
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2}  1.16455{col 26}{space 2} .3054762{col 37}{space 1}    0.58{col 46}{space 3}0.561{col 54}{space 4} .6964293{col 67}{space 3} 1.947328
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .2725647{col 26}{space 2} .1975924{col 37}{space 1}   -1.79{col 46}{space 3}0.073{col 54}{space 4} .0658266{col 67}{space 3} 1.128594
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.319413{col 26}{space 2} .5093952{col 37}{space 1}    0.72{col 46}{space 3}0.473{col 54}{space 4} .6190863{col 67}{space 3} 2.811967
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2}  .846767{col 26}{space 2} .2874955{col 37}{space 1}   -0.49{col 46}{space 3}0.624{col 54}{space 4} .4352741{col 67}{space 3} 1.647271
{txt}5 most de..  {c |}{col 14}{res}{space 2}  .273287{col 26}{space 2} .1991201{col 37}{space 1}   -1.78{col 46}{space 3}0.075{col 54}{space 4} .0655275{col 67}{space 3} 1.139762
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.140569{col 26}{space 2} .1011243{col 37}{space 1}    1.48{col 46}{space 3}0.138{col 54}{space 4} .9586339{col 67}{space 3} 1.357032
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.273978{col 26}{space 2} .3546888{col 37}{space 1}    0.87{col 46}{space 3}0.384{col 54}{space 4} .7382077{col 67}{space 3} 2.198596
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6838969{col 26}{space 2} .1988738{col 37}{space 1}   -1.31{col 46}{space 3}0.191{col 54}{space 4} .3867813{col 67}{space 3} 1.209249
{txt}{space 7}joint {c |}{col 14}{res}{space 2}   1.7577{col 26}{space 2} .5501309{col 37}{space 1}    1.80{col 46}{space 3}0.072{col 54}{space 4} .9517719{col 67}{space 3} 3.246061
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8791268{col 26}{space 2} .3033621{col 37}{space 1}   -0.37{col 46}{space 3}0.709{col 54}{space 4} .4470187{col 67}{space 3}  1.72893
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9198644{col 26}{space 2} .2418265{col 37}{space 1}   -0.32{col 46}{space 3}0.751{col 54}{space 4} .5494755{col 67}{space 3} 1.539924
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.505487{col 26}{space 2} 2.601868{col 37}{space 1}    0.88{col 46}{space 3}0.376{col 54}{space 4} .3273002{col 67}{space 3} 19.17953
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 7.51e-19{col 26}{space 2} 2.25e-09{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2}  1.16857{col 26}{space 2} .3818791{col 37}{space 1}    0.48{col 46}{space 3}0.634{col 54}{space 4} .6158702{col 67}{space 3}  2.21728
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9101459{col 26}{space 2}  .130818{col 37}{space 1}   -0.66{col 46}{space 3}0.512{col 54}{space 4} .6866971{col 67}{space 3} 1.206304
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2csensitivity1, replace
{res}{txt}(note: file output/data/primaryobjective2csensitivity1.ster not found)
{txt}file output/data/primaryobjective2csensitivity1.ster saved

{com}. 
. *2c sensitivity 2: Additional confounders
. stcox standil17 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m  ckd chronic_liver_disease chronic_respiratory_disease 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-664.49453
{txt}Iteration 1:   log likelihood = {res}-651.71234
{txt}Iteration 2:   log likelihood = {res}-651.41633
{txt}Iteration 3:   log likelihood = {res}-651.40053
{txt}Iteration 4:   log likelihood = {res}-651.39505
{txt}Iteration 5:   log likelihood = {res}-651.39303
{txt}Iteration 6:   log likelihood = {res}-651.39229
{txt}Iteration 7:   log likelihood = {res}-651.39202
{txt}Iteration 8:   log likelihood = {res}-651.39192
{txt}Iteration 9:   log likelihood = {res}-651.39188
{txt}Iteration 10:  log likelihood = {res}-651.39187
{txt}Iteration 11:  log likelihood = {res}-651.39186
{txt}Iteration 12:  log likelihood = {res}-651.39186
{txt}Iteration 13:  log likelihood = {res}-651.39186
{txt}Iteration 14:  log likelihood = {res}-651.39186
{txt}Iteration 15:  log likelihood = {res}-651.39186
{txt}Iteration 16:  log likelihood = {res}-651.39186
{txt}Iteration 17:  log likelihood = {res}-651.39186
{txt}Iteration 18:  log likelihood = {res}-651.39186
{txt}Iteration 19:  log likelihood = {res}-651.39186
{txt}Iteration 20:  log likelihood = {res}-651.39186
{txt}Iteration 21:  log likelihood = {res}-651.39186
{txt}Iteration 22:  log likelihood = {res}-651.39186
{txt}Iteration 23:  log likelihood = {res}-651.39186
{txt}Iteration 24:  log likelihood = {res}-651.39186
{txt}Iteration 25:  log likelihood = {res}-651.39186
{txt}Iteration 26:  log likelihood = {res}-651.39186
{txt}Iteration 27:  log likelihood = {res}-651.39186
{txt}Iteration 28:  log likelihood = {res}-651.39186
{txt}Iteration 29:  log likelihood = {res}-651.39186
{txt}Iteration 30:  log likelihood = {res}-651.39186
{txt}Iteration 31:  log likelihood = {res}-651.39186
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-651.39186
{txt}Iteration 1:   log likelihood = {res}-651.39186
{txt}Iteration 2:   log likelihood = {res}-651.39186

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,049                  {txt}Number of obs    =  {res}     1,049
{txt}No. of failures = {res}          96
{txt}Time at risk    = {res} 602.5708419
                                                {txt}LR chi2({res}24{txt})      =  {res}     26.21
{txt}Log likelihood  =   {res}-651.39186                  {txt}Prob > chi2      =  {res}    0.3428

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil17 {c |}{col 14}{res}{space 2} 1.148013{col 26}{space 2} .2659417{col 37}{space 1}    0.60{col 46}{space 3}0.551{col 54}{space 4} .7290593{col 67}{space 3} 1.807719
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.446828{col 26}{space 2} .4456005{col 37}{space 1}    1.20{col 46}{space 3}0.230{col 54}{space 4} .7911522{col 67}{space 3} 2.645902
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.521722{col 26}{space 2} .4824339{col 37}{space 1}    1.32{col 46}{space 3}0.185{col 54}{space 4} .8174805{col 67}{space 3} 2.832651
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.073611{col 26}{space 2} .3843429{col 37}{space 1}    0.20{col 46}{space 3}0.843{col 54}{space 4} .5322613{col 67}{space 3} 2.165555
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.199687{col 26}{space 2} .4187208{col 37}{space 1}    0.52{col 46}{space 3}0.602{col 54}{space 4}  .605309{col 67}{space 3} 2.377708
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.848149{col 26}{space 2} .7073873{col 37}{space 1}    1.60{col 46}{space 3}0.109{col 54}{space 4} .8728424{col 67}{space 3} 3.913255
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.155891{col 26}{space 2} .2399233{col 37}{space 1}    0.70{col 46}{space 3}0.485{col 54}{space 4} .7695498{col 67}{space 3} 1.736189
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4795093{col 26}{space 2} .2223162{col 37}{space 1}   -1.59{col 46}{space 3}0.113{col 54}{space 4} .1932645{col 67}{space 3} 1.189712
{txt}{space 6}Other  {c |}{col 14}{res}{space 2}  1.16454{col 26}{space 2} .3784723{col 37}{space 1}    0.47{col 46}{space 3}0.639{col 54}{space 4} .6159086{col 67}{space 3} 2.201875
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.125577{col 26}{space 2}  .278258{col 37}{space 1}    0.48{col 46}{space 3}0.632{col 54}{space 4} .6933401{col 67}{space 3} 1.827274
{txt}5 most de..  {c |}{col 14}{res}{space 2}  .622353{col 26}{space 2} .2664652{col 37}{space 1}   -1.11{col 46}{space 3}0.268{col 54}{space 4} .2688984{col 67}{space 3} 1.440407
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.051241{col 26}{space 2}  .071849{col 37}{space 1}    0.73{col 46}{space 3}0.465{col 54}{space 4} .9194439{col 67}{space 3}  1.20193
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.243869{col 26}{space 2} .2750709{col 37}{space 1}    0.99{col 46}{space 3}0.324{col 54}{space 4} .8063777{col 67}{space 3} 1.918715
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7380833{col 26}{space 2} .1659385{col 37}{space 1}   -1.35{col 46}{space 3}0.177{col 54}{space 4} .4750455{col 67}{space 3} 1.146768
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.464237{col 26}{space 2} .3550556{col 37}{space 1}    1.57{col 46}{space 3}0.116{col 54}{space 4} .9103485{col 67}{space 3} 2.355131
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6688279{col 26}{space 2} .1975588{col 37}{space 1}   -1.36{col 46}{space 3}0.173{col 54}{space 4} .3748746{col 67}{space 3} 1.193281
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9740656{col 26}{space 2} .2010944{col 37}{space 1}   -0.13{col 46}{space 3}0.899{col 54}{space 4} .6499185{col 67}{space 3} 1.459881
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.547997{col 26}{space 2} 2.605774{col 37}{space 1}    0.91{col 46}{space 3}0.360{col 54}{space 4} .3433174{col 67}{space 3} 18.91045
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 4.01e-15{col 26}{space 2} 1.41e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2}  1.27738{col 26}{space 2} .3241965{col 37}{space 1}    0.96{col 46}{space 3}0.335{col 54}{space 4} .7767599{col 67}{space 3} 2.100648
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .8509876{col 26}{space 2} .1147873{col 37}{space 1}   -1.20{col 46}{space 3}0.232{col 54}{space 4} .6532916{col 67}{space 3} 1.108509
{txt}{space 9}ckd {c |}{col 14}{res}{space 2} .9268494{col 26}{space 2} .1939329{col 37}{space 1}   -0.36{col 46}{space 3}0.717{col 54}{space 4} .6150419{col 67}{space 3} 1.396734
{txt}chronic_l~se {c |}{col 14}{res}{space 2} .7282675{col 26}{space 2} .2066159{col 37}{space 1}   -1.12{col 46}{space 3}0.264{col 54}{space 4} .4176356{col 67}{space 3} 1.269943
{txt}chronic_r~se {c |}{col 14}{res}{space 2} .5911971{col 26}{space 2} .1784976{col 37}{space 1}   -1.74{col 46}{space 3}0.082{col 54}{space 4} .3271392{col 67}{space 3} 1.068395
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2csensitivity2, replace
{res}{txt}(note: file output/data/primaryobjective2csensitivity2.ster not found)
{txt}file output/data/primaryobjective2csensitivity2.ster saved

{com}. 
. *2c sensitivity 3: restricted exposure window
. stcox standil173m i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-577.30667
{txt}Iteration 1:   log likelihood = {res}-572.96126
{txt}Iteration 2:   log likelihood = {res}-566.69285
{txt}Iteration 3:   log likelihood = {res} -565.2343
{txt}Iteration 4:   log likelihood = {res}-564.99041
{txt}Iteration 5:   log likelihood = {res}-564.97497
{txt}Iteration 6:   log likelihood = {res}-564.97428
{txt}Iteration 7:   log likelihood = {res}-564.97405
{txt}Iteration 8:   log likelihood = {res}-564.97396
{txt}Iteration 9:   log likelihood = {res}-564.97393
{txt}Iteration 10:  log likelihood = {res}-564.97392
{txt}Iteration 11:  log likelihood = {res}-564.97392
{txt}Iteration 12:  log likelihood = {res}-564.97392
{txt}Iteration 13:  log likelihood = {res}-564.97392
{txt}Iteration 14:  log likelihood = {res}-564.97392
{txt}Iteration 15:  log likelihood = {res}-564.97392
{txt}Iteration 16:  log likelihood = {res}-564.97392
{txt}Iteration 17:  log likelihood = {res}-564.97392
{txt}Iteration 18:  log likelihood = {res}-564.97392
{txt}Iteration 19:  log likelihood = {res}-564.97392
{txt}Iteration 20:  log likelihood = {res}-564.97392
{txt}Iteration 21:  log likelihood = {res}-564.97392
{txt}Iteration 22:  log likelihood = {res}-564.97392
{txt}Iteration 23:  log likelihood = {res}-564.97392
{txt}Iteration 24:  log likelihood = {res}-564.97392
{txt}Iteration 25:  log likelihood = {res}-564.97392
{txt}Iteration 26:  log likelihood = {res}-564.97392
{txt}Iteration 27:  log likelihood = {res}-564.97392
{txt}Iteration 28:  log likelihood = {res}-564.97392
{txt}Iteration 29:  log likelihood = {res}-564.97392
{txt}Iteration 30:  log likelihood = {res}-564.97392
{txt}Iteration 31:  log likelihood = {res}-564.97392
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-564.97392
{txt}Iteration 1:   log likelihood = {res}-564.97392

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         923                  {txt}Number of obs    =  {res}       923
{txt}No. of failures = {res}          85
{txt}Time at risk    = {res} 529.3442847
                                                {txt}LR chi2({res}21{txt})      =  {res}     24.67
{txt}Log likelihood  =   {res}-564.97392                  {txt}Prob > chi2      =  {res}    0.2619

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 1}standil173m {c |}{col 14}{res}{space 2} 1.269244{col 26}{space 2} .2851749{col 37}{space 1}    1.06{col 46}{space 3}0.289{col 54}{space 4} .8171403{col 67}{space 3} 1.971487
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2}  1.18798{col 26}{space 2} .3968575{col 37}{space 1}    0.52{col 46}{space 3}0.606{col 54}{space 4} .6172428{col 67}{space 3} 2.286452
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.502663{col 26}{space 2} .4855463{col 37}{space 1}    1.26{col 46}{space 3}0.208{col 54}{space 4} .7976605{col 67}{space 3} 2.830774
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.373196{col 26}{space 2} .4688412{col 37}{space 1}    0.93{col 46}{space 3}0.353{col 54}{space 4} .7032546{col 67}{space 3} 2.681345
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .9377487{col 26}{space 2} .3710955{col 37}{space 1}   -0.16{col 46}{space 3}0.871{col 54}{space 4} .4317579{col 67}{space 3} 2.036726
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.420085{col 26}{space 2} .6175164{col 37}{space 1}    0.81{col 46}{space 3}0.420{col 54}{space 4} .6055833{col 67}{space 3} 3.330081
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} .7547287{col 26}{space 2} .1678244{col 37}{space 1}   -1.27{col 46}{space 3}0.206{col 54}{space 4} .4881064{col 67}{space 3}  1.16699
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .5455532{col 26}{space 2}  .254815{col 37}{space 1}   -1.30{col 46}{space 3}0.195{col 54}{space 4} .2184042{col 67}{space 3} 1.362741
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.300189{col 26}{space 2} .4260805{col 37}{space 1}    0.80{col 46}{space 3}0.423{col 54}{space 4} .6840093{col 67}{space 3} 2.471444
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.340916{col 26}{space 2} .3411421{col 37}{space 1}    1.15{col 46}{space 3}0.249{col 54}{space 4} .8144189{col 67}{space 3} 2.207779
{txt}5 most de..  {c |}{col 14}{res}{space 2} .6441309{col 26}{space 2} .3017645{col 37}{space 1}   -0.94{col 46}{space 3}0.348{col 54}{space 4} .2571583{col 67}{space 3} 1.613421
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.058577{col 26}{space 2} .0785895{col 37}{space 1}    0.77{col 46}{space 3}0.443{col 54}{space 4} .9152264{col 67}{space 3}  1.22438
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.023902{col 26}{space 2} .2268602{col 37}{space 1}    0.11{col 46}{space 3}0.915{col 54}{space 4} .6632278{col 67}{space 3} 1.580718
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .8250061{col 26}{space 2} .1914952{col 37}{space 1}   -0.83{col 46}{space 3}0.407{col 54}{space 4} .5234578{col 67}{space 3} 1.300268
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.493595{col 26}{space 2} .3452429{col 37}{space 1}    1.74{col 46}{space 3}0.083{col 54}{space 4}  .949464{col 67}{space 3} 2.349564
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5300687{col 26}{space 2} .1822496{col 37}{space 1}   -1.85{col 46}{space 3}0.065{col 54}{space 4} .2701903{col 67}{space 3} 1.039907
{txt}{space 6}cancer {c |}{col 14}{res}{space 2}  1.08982{col 26}{space 2}  .239507{col 37}{space 1}    0.39{col 46}{space 3}0.696{col 54}{space 4}  .708416{col 67}{space 3} 1.676568
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 9.245084{col 26}{space 2} 9.672841{col 37}{space 1}    2.13{col 46}{space 3}0.034{col 54}{space 4} 1.189393{col 67}{space 3} 71.86151
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.01e-14{col 26}{space 2} 2.35e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.770605{col 26}{space 2} .4458099{col 37}{space 1}    2.27{col 46}{space 3}0.023{col 54}{space 4} 1.080943{col 67}{space 3} 2.900284
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9085697{col 26}{space 2} .1177281{col 37}{space 1}   -0.74{col 46}{space 3}0.459{col 54}{space 4} .7047964{col 67}{space 3} 1.171259
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2csensitivity3, replace
{res}{txt}(note: file output/data/primaryobjective2csensitivity3.ster not found)
{txt}file output/data/primaryobjective2csensitivity3.ster saved

{com}. 
. *2c sensitivity 4: covid positivity 
. stset stopswab, id(patient_id) failure(first_pos_test_sgss==1) origin(time enter_date) scale(365.25)  exit(first_pos_test_sgss==1 time mdy(10,01,2020))

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}first_pos_test_sgss == 1
{txt}obs. time interval:  {res}(stopswab[_n-1], stopswab]
{txt} exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}        401{txt}  observations end on or before enter()
{hline 78}
{res}     38,953{txt}  observations remaining, representing
{res}     38,953{txt}  subjects
{res}      3,506{txt}  failures in single-failure-per-subject data
{res} 22,262.631{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}. stcox standil17 i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-664.49453
{txt}Iteration 1:   log likelihood = {res}-654.09343
{txt}Iteration 2:   log likelihood = {res} -653.8169
{txt}Iteration 3:   log likelihood = {res}-653.80093
{txt}Iteration 4:   log likelihood = {res}-653.79547
{txt}Iteration 5:   log likelihood = {res}-653.79347
{txt}Iteration 6:   log likelihood = {res}-653.79273
{txt}Iteration 7:   log likelihood = {res}-653.79246
{txt}Iteration 8:   log likelihood = {res}-653.79236
{txt}Iteration 9:   log likelihood = {res}-653.79232
{txt}Iteration 10:  log likelihood = {res}-653.79231
{txt}Iteration 11:  log likelihood = {res} -653.7923
{txt}Iteration 12:  log likelihood = {res} -653.7923
{txt}Iteration 13:  log likelihood = {res} -653.7923
{txt}Iteration 14:  log likelihood = {res} -653.7923
{txt}Iteration 15:  log likelihood = {res} -653.7923
{txt}Iteration 16:  log likelihood = {res} -653.7923
{txt}Iteration 17:  log likelihood = {res} -653.7923
{txt}Iteration 18:  log likelihood = {res} -653.7923
{txt}Iteration 19:  log likelihood = {res} -653.7923
{txt}Iteration 20:  log likelihood = {res} -653.7923
{txt}Iteration 21:  log likelihood = {res} -653.7923
{txt}Iteration 22:  log likelihood = {res} -653.7923
{txt}Iteration 23:  log likelihood = {res} -653.7923
{txt}Iteration 24:  log likelihood = {res} -653.7923
{txt}Iteration 25:  log likelihood = {res} -653.7923
{txt}Iteration 26:  log likelihood = {res} -653.7923
{txt}Iteration 27:  log likelihood = {res} -653.7923
{txt}Iteration 28:  log likelihood = {res} -653.7923
{txt}Refining estimates:
Iteration 0:   log likelihood = {res} -653.7923
{txt}Iteration 1:   log likelihood = {res} -653.7923
{txt}Iteration 2:   log likelihood = {res} -653.7923

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,049                  {txt}Number of obs    =  {res}     1,049
{txt}No. of failures = {res}          96
{txt}Time at risk    = {res} 602.5708419
                                                {txt}LR chi2({res}21{txt})      =  {res}     21.40
{txt}Log likelihood  =   {res} -653.7923                  {txt}Prob > chi2      =  {res}    0.4345

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standil17 {c |}{col 14}{res}{space 2} 1.138637{col 26}{space 2} .2627918{col 37}{space 1}    0.56{col 46}{space 3}0.574{col 54}{space 4}  .724323{col 67}{space 3}  1.78994
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.481504{col 26}{space 2} .4553881{col 37}{space 1}    1.28{col 46}{space 3}0.201{col 54}{space 4}   .81107{col 67}{space 3}  2.70612
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.474113{col 26}{space 2} .4663166{col 37}{space 1}    1.23{col 46}{space 3}0.220{col 54}{space 4} .7929838{col 67}{space 3} 2.740296
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.097938{col 26}{space 2} .3927335{col 37}{space 1}    0.26{col 46}{space 3}0.794{col 54}{space 4} .5446311{col 67}{space 3} 2.213367
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.246441{col 26}{space 2} .4340752{col 37}{space 1}    0.63{col 46}{space 3}0.527{col 54}{space 4} .6298534{col 67}{space 3} 2.466631
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.916129{col 26}{space 2} .7323115{col 37}{space 1}    1.70{col 46}{space 3}0.089{col 54}{space 4} .9059621{col 67}{space 3} 4.052652
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.162091{col 26}{space 2} .2409552{col 37}{space 1}    0.72{col 46}{space 3}0.469{col 54}{space 4}   .77401{col 67}{space 3} 1.744751
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4764104{col 26}{space 2} .2208992{col 37}{space 1}   -1.60{col 46}{space 3}0.110{col 54}{space 4} .1919999{col 67}{space 3}  1.18212
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.149662{col 26}{space 2} .3727662{col 37}{space 1}    0.43{col 46}{space 3}0.667{col 54}{space 4} .6089432{col 67}{space 3} 2.170519
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.128406{col 26}{space 2} .2784905{col 37}{space 1}    0.49{col 46}{space 3}0.624{col 54}{space 4} .6956469{col 67}{space 3} 1.830382
{txt}5 most de..  {c |}{col 14}{res}{space 2}  .620083{col 26}{space 2} .2655113{col 37}{space 1}   -1.12{col 46}{space 3}0.264{col 54}{space 4} .2679024{col 67}{space 3} 1.435235
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.058401{col 26}{space 2} .0720764{col 37}{space 1}    0.83{col 46}{space 3}0.405{col 54}{space 4} .9261553{col 67}{space 3} 1.209529
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.214055{col 26}{space 2} .2672835{col 37}{space 1}    0.88{col 46}{space 3}0.378{col 54}{space 4} .7885694{col 67}{space 3} 1.869119
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7342584{col 26}{space 2} .1636622{col 37}{space 1}   -1.39{col 46}{space 3}0.166{col 54}{space 4} .4743738{col 67}{space 3}  1.13652
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.449734{col 26}{space 2} .3510345{col 37}{space 1}    1.53{col 46}{space 3}0.125{col 54}{space 4} .9019465{col 67}{space 3} 2.330214
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6919895{col 26}{space 2} .2041881{col 37}{space 1}   -1.25{col 46}{space 3}0.212{col 54}{space 4} .3880896{col 67}{space 3} 1.233863
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9742557{col 26}{space 2} .2008126{col 37}{space 1}   -0.13{col 46}{space 3}0.899{col 54}{space 4} .6504653{col 67}{space 3} 1.459223
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.758641{col 26}{space 2} 2.817869{col 37}{space 1}    0.99{col 46}{space 3}0.321{col 54}{space 4} .3725792{col 67}{space 3} 20.42546
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 8.39e-14{col 26}{space 2} 6.59e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.252589{col 26}{space 2} .3179646{col 37}{space 1}    0.89{col 46}{space 3}0.375{col 54}{space 4} .7616138{col 67}{space 3} 2.060073
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .8625272{col 26}{space 2} .1156369{col 37}{space 1}   -1.10{col 46}{space 3}0.270{col 54}{space 4}  .663215{col 67}{space 3} 1.121738
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2csensitivity4, replace
{res}{txt}(note: file output/data/primaryobjective2csensitivity4.ster not found)
{txt}file output/data/primaryobjective2csensitivity4.ster saved

{com}. 
. *2d: Jaki vs standard systemics
. 
. stcox standjaki

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-25969.655
{txt}Iteration 1:   log likelihood = {res}-25969.648
{txt}Iteration 2:   log likelihood = {res}-25969.648
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-25969.648

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      28,119                  {txt}Number of obs    =  {res}    28,119
{txt}No. of failures = {res}       2,544
{txt}Time at risk    = {res} 16073.14442
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.01
{txt}Log likelihood  =   {res}-25969.648                  {txt}Prob > chi2      =  {res}    0.9048

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standjaki {c |}{col 14}{res}{space 2} 1.004858{col 26}{space 2}  .040691{col 37}{space 1}    0.12{col 46}{space 3}0.905{col 54}{space 4} .9281875{col 67}{space 3} 1.087861
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2dunadj, replace
{res}{txt}(note: file output/data/primaryobjective2dunadj.ster not found)
{txt}file output/data/primaryobjective2dunadj.ster saved

{com}. sts graph, by(standjaki) xtitle("Analysis time (years)") saving(primeob2d, replace)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2d.gph not found)
{res}{txt}(file primeob2d.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2d.pdf", as(pdf) replace
{txt}(file output/figures/primeob2d.pdf written in PDF format)

{com}. sts graph, cumhaz by(standjaki) xtitle("Analysis time (years)") tmax(0.58) legend(order(1 "Standard Systemic" 2 "JAKi")) saving(primeob2d_NA, replace)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(note: file primeob2d_NA.gph not found)
{res}{txt}(file primeob2d_NA.gph saved)
{res}{txt}
{com}. graph export "output/figures/primeob2d_NA.pdf", as(pdf) replace
{txt}(file output/figures/primeob2d_NA.pdf written in PDF format)

{com}. 
. ** Testing assumptions of proportional hazard model
. stcox standjaki

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-25969.655
{txt}Iteration 1:   log likelihood = {res}-25969.648
{txt}Iteration 2:   log likelihood = {res}-25969.648
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-25969.648

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      28,119                  {txt}Number of obs    =  {res}    28,119
{txt}No. of failures = {res}       2,544
{txt}Time at risk    = {res} 16073.14442
                                                {txt}LR chi2({res}1{txt})       =  {res}      0.01
{txt}Log likelihood  =   {res}-25969.648                  {txt}Prob > chi2      =  {res}    0.9048

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standjaki {c |}{col 14}{res}{space 2} 1.004858{col 26}{space 2}  .040691{col 37}{space 1}    0.12{col 46}{space 3}0.905{col 54}{space 4} .9281875{col 67}{space 3} 1.087861
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. stptime, per (1000) by (standjaki)

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id
{txt}(10952 missing values generated)

 standjaki{col 12}{c |}{col 15}person-time{col 29}failures{col 45}rate{col 52}[95% Conf. Interval]
{hline 11}{c +}{hline 59}
         0{col 12}{c |}{col 16}{res} 9685.3662{col 29}    1530{col 39} 157.97028{col 51} 150.2498{col 63} 166.0874
         {txt}1{col 12}{c |}{col 16}{res} 6387.7782{col 29}    1014{col 39} 158.74064{col 51} 149.2647{col 63} 168.8181
{txt}{hline 11}{c +}{hline 59}
     total{col 12}{c |}{col 16}{res} 16073.144{col 29}    2544{col 39} 158.27644{col 51}  152.244{col 63} 164.5479
{txt}
{com}. stphtest, log detail

{txt}      Test of proportional-hazards assumption

      Time:  {res}Log(t)
{txt}      {hline 12}{c TT}{hline 51}
                  {c |}       rho            chi2       df       Prob>chi2
      {hline 12}{c +}{hline 51}
      standjaki{col 19}{c |}{res}{col 25} 0.01646{col 37}     0.69{col 50}    1{col 64}0.4064
{txt}      {hline 12}{c +}{hline 51}
      global test {c |}{res}{col 37}     0.69{col 50}    1{col 64}0.4064
{txt}      {hline 12}{c BT}{hline 51}

{com}. stphtest, log plot(standjaki) yline(0) 
{res}{txt}
{com}. 
. *if TVC significant, need to use models with tvc
. stcox standjaki, tvc(standjaki) 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-25969.655
{txt}Iteration 1:   log likelihood = {res}-25969.467
{txt}Iteration 2:   log likelihood = {res}-25969.467
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-25969.467

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}      28,119                  {txt}Number of obs    =  {res}    28,119
{txt}No. of failures = {res}       2,544
{txt}Time at risk    = {res} 16073.14442
                                                {txt}LR chi2({res}2{txt})       =  {res}      0.38
{txt}Log likelihood  =   {res}-25969.467                  {txt}Prob > chi2      =  {res}    0.8290

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 3}standjaki {c |}{col 14}{res}{space 2} .9517104{col 26}{space 2} .0944819{col 37}{space 1}   -0.50{col 46}{space 3}0.618{col 54}{space 4} .7834314{col 67}{space 3} 1.156135
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 3}standjaki {c |}{col 14}{res}{space 2} 1.135226{col 26}{space 2} .2398921{col 37}{space 1}    0.60{col 46}{space 3}0.548{col 54}{space 4} .7502558{col 67}{space 3} 1.717732
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2dTVCtest, replace
{res}{txt}(note: file output/data/primaryobjective2dTVCtest.ster not found)
{txt}file output/data/primaryobjective2dTVCtest.ster saved

{com}. 
. stcox standjaki i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-681.18156
{txt}Iteration 1:   log likelihood = {res}-671.09726
{txt}Iteration 2:   log likelihood = {res}-670.85728
{txt}Iteration 3:   log likelihood = {res}-670.84175
{txt}Iteration 4:   log likelihood = {res} -670.8364
{txt}Iteration 5:   log likelihood = {res}-670.83443
{txt}Iteration 6:   log likelihood = {res}-670.83371
{txt}Iteration 7:   log likelihood = {res}-670.83344
{txt}Iteration 8:   log likelihood = {res}-670.83335
{txt}Iteration 9:   log likelihood = {res}-670.83331
{txt}Iteration 10:  log likelihood = {res} -670.8333
{txt}Iteration 11:  log likelihood = {res}-670.83329
{txt}Iteration 12:  log likelihood = {res}-670.83329
{txt}Iteration 13:  log likelihood = {res}-670.83329
{txt}Iteration 14:  log likelihood = {res}-670.83329
{txt}Iteration 15:  log likelihood = {res}-670.83329
{txt}Iteration 16:  log likelihood = {res}-670.83329
{txt}Iteration 17:  log likelihood = {res}-670.83329
{txt}Iteration 18:  log likelihood = {res}-670.83329
{txt}Iteration 19:  log likelihood = {res}-670.83329
{txt}Iteration 20:  log likelihood = {res}-670.83329
{txt}Iteration 21:  log likelihood = {res}-670.83329
{txt}Iteration 22:  log likelihood = {res}-670.83329
{txt}Iteration 23:  log likelihood = {res}-670.83329
{txt}Iteration 24:  log likelihood = {res}-670.83329
{txt}Iteration 25:  log likelihood = {res}-670.83329
{txt}Iteration 26:  log likelihood = {res}-670.83329
{txt}Iteration 27:  log likelihood = {res}-670.83329
{txt}Iteration 28:  log likelihood = {res}-670.83329
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-670.83329
{txt}Iteration 1:   log likelihood = {res}-670.83329

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,078                  {txt}Number of obs    =  {res}     1,078
{txt}No. of failures = {res}          98
{txt}Time at risk    = {res} 619.7919233
                                                {txt}LR chi2({res}21{txt})      =  {res}     20.70
{txt}Log likelihood  =   {res}-670.83329                  {txt}Prob > chi2      =  {res}    0.4776

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standjaki {c |}{col 14}{res}{space 2} .8169964{col 26}{space 2} .1774821{col 37}{space 1}   -0.93{col 46}{space 3}0.352{col 54}{space 4} .5337125{col 67}{space 3} 1.250642
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.680301{col 26}{space 2} .4919807{col 37}{space 1}    1.77{col 46}{space 3}0.076{col 54}{space 4} .9465883{col 67}{space 3} 2.982724
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.354796{col 26}{space 2} .4316085{col 37}{space 1}    0.95{col 46}{space 3}0.341{col 54}{space 4} .7256041{col 67}{space 3} 2.529579
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.197914{col 26}{space 2} .4142639{col 37}{space 1}    0.52{col 46}{space 3}0.602{col 54}{space 4} .6082224{col 67}{space 3} 2.359332
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.082227{col 26}{space 2}  .395629{col 37}{space 1}    0.22{col 46}{space 3}0.829{col 54}{space 4} .5286217{col 67}{space 3} 2.215601
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.778249{col 26}{space 2} .6734013{col 37}{space 1}    1.52{col 46}{space 3}0.128{col 54}{space 4} .8465502{col 67}{space 3} 3.735358
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.158996{col 26}{space 2} .2371576{col 37}{space 1}    0.72{col 46}{space 3}0.471{col 54}{space 4} .7760798{col 67}{space 3} 1.730843
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4887174{col 26}{space 2} .2267245{col 37}{space 1}   -1.54{col 46}{space 3}0.123{col 54}{space 4}  .196866{col 67}{space 3} 1.213235
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.189808{col 26}{space 2} .3706377{col 37}{space 1}    0.56{col 46}{space 3}0.577{col 54}{space 4} .6461282{col 67}{space 3} 2.190964
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.076677{col 26}{space 2} .2647449{col 37}{space 1}    0.30{col 46}{space 3}0.764{col 54}{space 4} .6649402{col 67}{space 3} 1.743363
{txt}5 most de..  {c |}{col 14}{res}{space 2} .6171933{col 26}{space 2} .2642481{col 37}{space 1}   -1.13{col 46}{space 3}0.260{col 54}{space 4} .2666759{col 67}{space 3} 1.428429
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.056547{col 26}{space 2} .0710175{col 37}{space 1}    0.82{col 46}{space 3}0.413{col 54}{space 4} .9261342{col 67}{space 3} 1.205324
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  1.00128{col 26}{space 2} .2183819{col 37}{space 1}    0.01{col 46}{space 3}0.995{col 54}{space 4} .6529895{col 67}{space 3} 1.535341
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7349353{col 26}{space 2} .1607785{col 37}{space 1}   -1.41{col 46}{space 3}0.159{col 54}{space 4} .4786693{col 67}{space 3} 1.128399
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.389165{col 26}{space 2} .3176931{col 37}{space 1}    1.44{col 46}{space 3}0.151{col 54}{space 4} .8873389{col 67}{space 3} 2.174794
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6765619{col 26}{space 2} .1993943{col 37}{space 1}   -1.33{col 46}{space 3}0.185{col 54}{space 4}  .379703{col 67}{space 3} 1.205511
{txt}{space 6}cancer {c |}{col 14}{res}{space 2}   .96848{col 26}{space 2} .1971752{col 37}{space 1}   -0.16{col 46}{space 3}0.875{col 54}{space 4} .6498191{col 67}{space 3} 1.443407
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.793288{col 26}{space 2}  2.85162{col 37}{space 1}    1.01{col 46}{space 3}0.314{col 54}{space 4} .3776928{col 67}{space 3} 20.65821
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 2.70e-13{col 26}{space 2} 1.30e-06{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.226252{col 26}{space 2} .3038427{col 37}{space 1}    0.82{col 46}{space 3}0.410{col 54}{space 4} .7545145{col 67}{space 3} 1.992929
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9146237{col 26}{space 2} .1107949{col 37}{space 1}   -0.74{col 46}{space 3}0.461{col 54}{space 4} .7213239{col 67}{space 3} 1.159724
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2dadjusted, replace
{res}{txt}(note: file output/data/primaryobjective2dadjusted.ster not found)
{txt}file output/data/primaryobjective2dadjusted.ster saved

{com}. 
. *TVC analysis
. stcox standjaki i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m, tvc(standjaki) 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-681.18156
{txt}Iteration 1:   log likelihood = {res}-670.28076
{txt}Iteration 2:   log likelihood = {res} -670.0343
{txt}Iteration 3:   log likelihood = {res}-670.01875
{txt}Iteration 4:   log likelihood = {res}-670.01339
{txt}Iteration 5:   log likelihood = {res}-670.01142
{txt}Iteration 6:   log likelihood = {res} -670.0107
{txt}Iteration 7:   log likelihood = {res}-670.01043
{txt}Iteration 8:   log likelihood = {res}-670.01033
{txt}Iteration 9:   log likelihood = {res} -670.0103
{txt}Iteration 10:  log likelihood = {res}-670.01028
{txt}Iteration 11:  log likelihood = {res}-670.01028
{txt}Iteration 12:  log likelihood = {res}-670.01028
{txt}Iteration 13:  log likelihood = {res}-670.01028
{txt}Iteration 14:  log likelihood = {res}-670.01028
{txt}Iteration 15:  log likelihood = {res}-670.01028
{txt}Iteration 16:  log likelihood = {res}-670.01028
{txt}Iteration 17:  log likelihood = {res}-670.01028
{txt}Iteration 18:  log likelihood = {res}-670.01028
{txt}Iteration 19:  log likelihood = {res}-670.01028
{txt}Iteration 20:  log likelihood = {res}-670.01028
{txt}Iteration 21:  log likelihood = {res}-670.01028
{txt}Iteration 22:  log likelihood = {res}-670.01028
{txt}Iteration 23:  log likelihood = {res}-670.01028
{txt}Iteration 24:  log likelihood = {res}-670.01028
{txt}Iteration 25:  log likelihood = {res}-670.01028
{txt}Iteration 26:  log likelihood = {res}-670.01028
{txt}Iteration 27:  log likelihood = {res}-670.01028
{txt}Iteration 28:  log likelihood = {res}-670.01028
{txt}Iteration 29:  log likelihood = {res}-670.01028
{txt}Iteration 30:  log likelihood = {res}-670.01028
{txt}Iteration 31:  log likelihood = {res}-670.01028
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-670.01028
{txt}Iteration 1:   log likelihood = {res}-670.01028

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,078                  {txt}Number of obs    =  {res}     1,078
{txt}No. of failures = {res}          98
{txt}Time at risk    = {res} 619.7919233
                                                {txt}LR chi2({res}22{txt})      =  {res}     22.34
{txt}Log likelihood  =   {res}-670.01028                  {txt}Prob > chi2      =  {res}    0.4396

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}main         {txt}{c |}
{space 3}standjaki {c |}{col 14}{res}{space 2}  1.71585{col 26}{space 2} 1.045516{col 37}{space 1}    0.89{col 46}{space 3}0.376{col 54}{space 4} .5197788{col 67}{space 3} 5.664222
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.678751{col 26}{space 2} .4915356{col 37}{space 1}    1.77{col 46}{space 3}0.077{col 54}{space 4} .9457052{col 67}{space 3} 2.980003
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.356898{col 26}{space 2} .4323071{col 37}{space 1}    0.96{col 46}{space 3}0.338{col 54}{space 4} .7266996{col 67}{space 3} 2.533609
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2}  1.19963{col 26}{space 2} .4148623{col 37}{space 1}    0.53{col 46}{space 3}0.599{col 54}{space 4} .6090882{col 67}{space 3} 2.362731
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.082685{col 26}{space 2} .3957959{col 37}{space 1}    0.22{col 46}{space 3}0.828{col 54}{space 4} .5288459{col 67}{space 3} 2.216536
{txt}{space 8}80+  {c |}{col 14}{res}{space 2}  1.77783{col 26}{space 2} .6732502{col 37}{space 1}    1.52{col 46}{space 3}0.129{col 54}{space 4} .8463438{col 67}{space 3} 3.734509
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.156922{col 26}{space 2} .2367452{col 37}{space 1}    0.71{col 46}{space 3}0.476{col 54}{space 4} .7746752{col 67}{space 3} 1.727781
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4885858{col 26}{space 2} .2266651{col 37}{space 1}   -1.54{col 46}{space 3}0.123{col 54}{space 4} .1968116{col 67}{space 3} 1.212917
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.189931{col 26}{space 2} .3706922{col 37}{space 1}    0.56{col 46}{space 3}0.577{col 54}{space 4}  .646178{col 67}{space 3} 2.191248
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2}  1.07674{col 26}{space 2} .2647458{col 37}{space 1}    0.30{col 46}{space 3}0.764{col 54}{space 4} .6649974{col 67}{space 3}  1.74342
{txt}5 most de..  {c |}{col 14}{res}{space 2} .6174476{col 26}{space 2} .2643484{col 37}{space 1}   -1.13{col 46}{space 3}0.260{col 54}{space 4}  .266793{col 67}{space 3} 1.428979
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.056378{col 26}{space 2} .0710194{col 37}{space 1}    0.82{col 46}{space 3}0.415{col 54}{space 4} .9259635{col 67}{space 3} 1.205161
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  1.00068{col 26}{space 2} .2182113{col 37}{space 1}    0.00{col 46}{space 3}0.998{col 54}{space 4} .6526489{col 67}{space 3} 1.534302
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7357769{col 26}{space 2}  .160985{col 37}{space 1}   -1.40{col 46}{space 3}0.161{col 54}{space 4} .4791888{col 67}{space 3} 1.129758
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.388532{col 26}{space 2} .3175365{col 37}{space 1}    1.44{col 46}{space 3}0.151{col 54}{space 4} .8869497{col 67}{space 3} 2.173767
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6775629{col 26}{space 2} .1996971{col 37}{space 1}   -1.32{col 46}{space 3}0.187{col 54}{space 4} .3802562{col 67}{space 3} 1.207322
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9691533{col 26}{space 2} .1973247{col 37}{space 1}   -0.15{col 46}{space 3}0.878{col 54}{space 4} .6502545{col 67}{space 3} 1.444447
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.791833{col 26}{space 2} 2.850211{col 37}{space 1}    1.01{col 46}{space 3}0.315{col 54}{space 4} .3774756{col 67}{space 3} 20.64857
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.35e-14{col 26}{space 2} 2.90e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.226019{col 26}{space 2} .3037886{col 37}{space 1}    0.82{col 46}{space 3}0.411{col 54}{space 4} .7543663{col 67}{space 3} 1.992562
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2}  .914382{col 26}{space 2} .1108086{col 37}{space 1}   -0.74{col 46}{space 3}0.460{col 54}{space 4} .7210669{col 67}{space 3} 1.159524
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}tvc          {txt}{c |}
{space 3}standjaki {c |}{col 14}{res}{space 2} .1977955{col 26}{space 2}   .24894{col 37}{space 1}   -1.29{col 46}{space 3}0.198{col 54}{space 4} .0167848{col 67}{space 3} 2.330856
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{p 0 6 0 78}Note: Variables in {res}tvc{txt} equation interacted with _t.{p_end}

{com}. estimates save output/data/primaryobjective2dadjustedTVC, replace
{res}{txt}(note: file output/data/primaryobjective2dadjustedTVC.ster not found)
{txt}file output/data/primaryobjective2dadjustedTVC.ster saved

{com}. 
. *2d sensitivity 1: exclude GP non attenders
. stcox standjaki i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m if gp_consult ==1

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res} -416.0066
{txt}Iteration 1:   log likelihood = {res}-403.11753
{txt}Iteration 2:   log likelihood = {res}-402.02493
{txt}Iteration 3:   log likelihood = {res}-402.00078
{txt}Iteration 4:   log likelihood = {res} -401.9984
{txt}Iteration 5:   log likelihood = {res}-401.99753
{txt}Iteration 6:   log likelihood = {res}-401.99721
{txt}Iteration 7:   log likelihood = {res}-401.99709
{txt}Iteration 8:   log likelihood = {res}-401.99704
{txt}Iteration 9:   log likelihood = {res}-401.99703
{txt}Iteration 10:  log likelihood = {res}-401.99702
{txt}Iteration 11:  log likelihood = {res}-401.99702
{txt}Iteration 12:  log likelihood = {res}-401.99702
{txt}Iteration 13:  log likelihood = {res}-401.99702
{txt}Iteration 14:  log likelihood = {res}-401.99702
{txt}Iteration 15:  log likelihood = {res}-401.99702
{txt}Iteration 16:  log likelihood = {res}-401.99702
{txt}Iteration 17:  log likelihood = {res}-401.99702
{txt}Iteration 18:  log likelihood = {res}-401.99702
{txt}Iteration 19:  log likelihood = {res}-401.99702
{txt}Iteration 20:  log likelihood = {res}-401.99702
{txt}Iteration 21:  log likelihood = {res}-401.99702
{txt}Iteration 22:  log likelihood = {res}-401.99702
{txt}Iteration 23:  log likelihood = {res}-401.99702
{txt}Iteration 24:  log likelihood = {res}-401.99702
{txt}Iteration 25:  log likelihood = {res}-401.99702
{txt}Iteration 26:  log likelihood = {res}-401.99702
{txt}Iteration 27:  log likelihood = {res}-401.99702
{txt}Iteration 28:  log likelihood = {res}-401.99702
{txt}Iteration 29:  log likelihood = {res}-401.99702
{txt}Iteration 30:  log likelihood = {res}-401.99702
{txt}Iteration 31:  log likelihood = {res}-401.99702
{txt}Iteration 32:  log likelihood = {res}-401.99702
{txt}Iteration 33:  log likelihood = {res}-401.99702
{txt}Iteration 34:  log likelihood = {res}-401.99702
{txt}Iteration 35:  log likelihood = {res}-401.99702
{txt}Iteration 36:  log likelihood = {res}-401.99702
{txt}Iteration 37:  log likelihood = {res}-401.99702
{txt}Iteration 38:  log likelihood = {res}-401.99702
{txt}Iteration 39:  log likelihood = {res}-401.99702
{txt}Iteration 40:  log likelihood = {res}-401.99702
{txt}Iteration 41:  log likelihood = {res}-401.99702
{txt}Iteration 42:  log likelihood = {res}-401.99702
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-401.99702

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         688                  {txt}Number of obs    =  {res}       688
{txt}No. of failures = {res}          64
{txt}Time at risk    = {res} 394.4695414
                                                {txt}LR chi2({res}20{txt})      =  {res}     28.02
{txt}Log likelihood  =   {res}-401.99702                  {txt}Prob > chi2      =  {res}    0.1089

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standjaki {c |}{col 14}{res}{space 2}  .716036{col 26}{space 2} .1962021{col 37}{space 1}   -1.22{col 46}{space 3}0.223{col 54}{space 4} .4185003{col 67}{space 3} 1.225107
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.570558{col 26}{space 2}  .549917{col 37}{space 1}    1.29{col 46}{space 3}0.197{col 54}{space 4}  .790703{col 67}{space 3}  3.11957
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2}   .96519{col 26}{space 2} .4127647{col 37}{space 1}   -0.08{col 46}{space 3}0.934{col 54}{space 4} .4174412{col 67}{space 3} 2.231671
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2}  .823998{col 26}{space 2} .3693469{col 37}{space 1}   -0.43{col 46}{space 3}0.666{col 54}{space 4} .3422832{col 67}{space 3} 1.983658
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .8290095{col 26}{space 2} .3935158{col 37}{space 1}   -0.40{col 46}{space 3}0.693{col 54}{space 4} .3269712{col 67}{space 3} 2.101888
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 2.856863{col 26}{space 2} 1.180787{col 37}{space 1}    2.54{col 46}{space 3}0.011{col 54}{space 4} 1.270791{col 67}{space 3} 6.422508
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.136577{col 26}{space 2} .2903095{col 37}{space 1}    0.50{col 46}{space 3}0.616{col 54}{space 4} .6889395{col 67}{space 3} 1.875066
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .2680626{col 26}{space 2} .1942158{col 37}{space 1}   -1.82{col 46}{space 3}0.069{col 54}{space 4} .0647928{col 67}{space 3} 1.109036
{txt}{space 6}Other  {c |}{col 14}{res}{space 2}  1.23921{col 26}{space 2} .4773812{col 37}{space 1}    0.56{col 46}{space 3}0.578{col 54}{space 4} .5824196{col 67}{space 3} 2.636656
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} .8916518{col 26}{space 2} .2927107{col 37}{space 1}   -0.35{col 46}{space 3}0.727{col 54}{space 4} .4685583{col 67}{space 3} 1.696786
{txt}5 most de..  {c |}{col 14}{res}{space 2} .2808514{col 26}{space 2} .2043419{col 37}{space 1}   -1.75{col 46}{space 3}0.081{col 54}{space 4} .0674775{col 67}{space 3} 1.168944
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.149081{col 26}{space 2} .0991937{col 37}{space 1}    1.61{col 46}{space 3}0.107{col 54}{space 4} .9702216{col 67}{space 3} 1.360912
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.036279{col 26}{space 2} .2832653{col 37}{space 1}    0.13{col 46}{space 3}0.896{col 54}{space 4}   .60646{col 67}{space 3} 1.770726
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6795495{col 26}{space 2} .1920855{col 37}{space 1}   -1.37{col 46}{space 3}0.172{col 54}{space 4} .3904949{col 67}{space 3}  1.18257
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.548758{col 26}{space 2}  .447748{col 37}{space 1}    1.51{col 46}{space 3}0.130{col 54}{space 4} .8788201{col 67}{space 3} 2.729399
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .8632249{col 26}{space 2} .2978108{col 37}{space 1}   -0.43{col 46}{space 3}0.670{col 54}{space 4} .4389966{col 67}{space 3}  1.69741
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9362589{col 26}{space 2} .2386683{col 37}{space 1}   -0.26{col 46}{space 3}0.796{col 54}{space 4}  .568081{col 67}{space 3} 1.543056
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.493987{col 26}{space 2} 2.582785{col 37}{space 1}    0.88{col 46}{space 3}0.378{col 54}{space 4} .3276315{col 67}{space 3} 18.98465
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 4.35e-19{col 26}{space 2}        .{col 37}{space 1}       .{col 46}{space 3}    .{col 54}{space 4}        .{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.153211{col 26}{space 2} .3532033{col 37}{space 1}    0.47{col 46}{space 3}0.642{col 54}{space 4}   .63271{col 67}{space 3} 2.101906
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9669802{col 26}{space 2} .1239847{col 37}{space 1}   -0.26{col 46}{space 3}0.793{col 54}{space 4} .7521039{col 67}{space 3} 1.243247
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2dsensitivity1, replace
{res}{txt}(note: file output/data/primaryobjective2dsensitivity1.ster not found)
{txt}file output/data/primaryobjective2dsensitivity1.ster saved

{com}. 
. *2d sensitivity 2: Additional confounders
. stcox standjaki i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m  ckd chronic_liver_disease chronic_respiratory_disease

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-681.18156
{txt}Iteration 1:   log likelihood = {res}-669.25755
{txt}Iteration 2:   log likelihood = {res}-668.97056
{txt}Iteration 3:   log likelihood = {res}-668.95527
{txt}Iteration 4:   log likelihood = {res}-668.94999
{txt}Iteration 5:   log likelihood = {res}-668.94805
{txt}Iteration 6:   log likelihood = {res}-668.94734
{txt}Iteration 7:   log likelihood = {res}-668.94707
{txt}Iteration 8:   log likelihood = {res}-668.94698
{txt}Iteration 9:   log likelihood = {res}-668.94694
{txt}Iteration 10:  log likelihood = {res}-668.94693
{txt}Iteration 11:  log likelihood = {res}-668.94692
{txt}Iteration 12:  log likelihood = {res}-668.94692
{txt}Iteration 13:  log likelihood = {res}-668.94692
{txt}Iteration 14:  log likelihood = {res}-668.94692
{txt}Iteration 15:  log likelihood = {res}-668.94692
{txt}Iteration 16:  log likelihood = {res}-668.94692
{txt}Iteration 17:  log likelihood = {res}-668.94692
{txt}Iteration 18:  log likelihood = {res}-668.94692
{txt}Iteration 19:  log likelihood = {res}-668.94692
{txt}Iteration 20:  log likelihood = {res}-668.94692
{txt}Iteration 21:  log likelihood = {res}-668.94692
{txt}Iteration 22:  log likelihood = {res}-668.94692
{txt}Iteration 23:  log likelihood = {res}-668.94692
{txt}Iteration 24:  log likelihood = {res}-668.94692
{txt}Iteration 25:  log likelihood = {res}-668.94692
{txt}Iteration 26:  log likelihood = {res}-668.94692
{txt}Iteration 27:  log likelihood = {res}-668.94692
{txt}Iteration 28:  log likelihood = {res}-668.94692
{txt}Iteration 29:  log likelihood = {res}-668.94692
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-668.94692
{txt}Iteration 1:   log likelihood = {res}-668.94692

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,078                  {txt}Number of obs    =  {res}     1,078
{txt}No. of failures = {res}          98
{txt}Time at risk    = {res} 619.7919233
                                                {txt}LR chi2({res}24{txt})      =  {res}     24.47
{txt}Log likelihood  =   {res}-668.94692                  {txt}Prob > chi2      =  {res}    0.4350

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standjaki {c |}{col 14}{res}{space 2} .8119996{col 26}{space 2} .1768666{col 37}{space 1}   -0.96{col 46}{space 3}0.339{col 54}{space 4} .5298469{col 67}{space 3} 1.244404
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.645705{col 26}{space 2} .4822781{col 37}{space 1}    1.70{col 46}{space 3}0.089{col 54}{space 4} .9266279{col 67}{space 3} 2.922798
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.395149{col 26}{space 2} .4450508{col 37}{space 1}    1.04{col 46}{space 3}0.297{col 54}{space 4} .7466008{col 67}{space 3} 2.607071
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.183166{col 26}{space 2} .4098339{col 37}{space 1}    0.49{col 46}{space 3}0.627{col 54}{space 4} .6000673{col 67}{space 3} 2.332874
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.052059{col 26}{space 2} .3850137{col 37}{space 1}    0.14{col 46}{space 3}0.890{col 54}{space 4} .5134904{col 67}{space 3} 2.155498
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.733803{col 26}{space 2} .6576086{col 37}{space 1}    1.45{col 46}{space 3}0.147{col 54}{space 4} .8244235{col 67}{space 3} 3.646274
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.155818{col 26}{space 2} .2366401{col 37}{space 1}    0.71{col 46}{space 3}0.479{col 54}{space 4} .7737776{col 67}{space 3} 1.726486
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4850679{col 26}{space 2} .2251283{col 37}{space 1}   -1.56{col 46}{space 3}0.119{col 54}{space 4} .1953194{col 67}{space 3} 1.204647
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.190526{col 26}{space 2} .3713095{col 37}{space 1}    0.56{col 46}{space 3}0.576{col 54}{space 4} .6460416{col 67}{space 3} 2.193904
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.072186{col 26}{space 2} .2642153{col 37}{space 1}    0.28{col 46}{space 3}0.777{col 54}{space 4} .6614714{col 67}{space 3} 1.737916
{txt}5 most de..  {c |}{col 14}{res}{space 2} .6070954{col 26}{space 2} .2601526{col 37}{space 1}   -1.16{col 46}{space 3}0.244{col 54}{space 4} .2621199{col 67}{space 3} 1.406093
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.049217{col 26}{space 2} .0705225{col 37}{space 1}    0.71{col 46}{space 3}0.475{col 54}{space 4} .9197131{col 67}{space 3} 1.196957
{txt}{space 7}bowel {c |}{col 14}{res}{space 2} 1.009859{col 26}{space 2} .2209745{col 37}{space 1}    0.04{col 46}{space 3}0.964{col 54}{space 4} .6576625{col 67}{space 3} 1.550666
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7339087{col 26}{space 2} .1615513{col 37}{space 1}   -1.41{col 46}{space 3}0.160{col 54}{space 4} .4767291{col 67}{space 3} 1.129828
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.407314{col 26}{space 2} .3215752{col 37}{space 1}    1.50{col 46}{space 3}0.135{col 54}{space 4} .8992678{col 67}{space 3} 2.202383
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6600899{col 26}{space 2} .1951217{col 37}{space 1}   -1.41{col 46}{space 3}0.160{col 54}{space 4} .3698189{col 67}{space 3} 1.178195
{txt}{space 6}cancer {c |}{col 14}{res}{space 2} .9647517{col 26}{space 2} .1965872{col 37}{space 1}   -0.18{col 46}{space 3}0.860{col 54}{space 4} .6470925{col 67}{space 3}  1.43835
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.494515{col 26}{space 2} 2.553637{col 37}{space 1}    0.89{col 46}{space 3}0.372{col 54}{space 4} .3354367{col 67}{space 3} 18.55076
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 9.33e-14{col 26}{space 2} 7.45e-07{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.259228{col 26}{space 2} .3121683{col 37}{space 1}    0.93{col 46}{space 3}0.352{col 54}{space 4} .7746185{col 67}{space 3} 2.047015
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9045008{col 26}{space 2} .1100499{col 37}{space 1}   -0.82{col 46}{space 3}0.409{col 54}{space 4}  .712597{col 67}{space 3} 1.148085
{txt}{space 9}ckd {c |}{col 14}{res}{space 2} .8602499{col 26}{space 2} .1770841{col 37}{space 1}   -0.73{col 46}{space 3}0.465{col 54}{space 4} .5746497{col 67}{space 3} 1.287793
{txt}chronic_l~se {c |}{col 14}{res}{space 2} .8330499{col 26}{space 2}   .22464{col 37}{space 1}   -0.68{col 46}{space 3}0.498{col 54}{space 4} .4910619{col 67}{space 3} 1.413207
{txt}chronic_r~se {c |}{col 14}{res}{space 2} .6215423{col 26}{space 2} .1814591{col 37}{space 1}   -1.63{col 46}{space 3}0.103{col 54}{space 4} .3507217{col 67}{space 3} 1.101485
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2dsensitivity2, replace
{res}{txt}(note: file output/data/primaryobjective2dsensitivity2.ster not found)
{txt}file output/data/primaryobjective2dsensitivity2.ster saved

{com}. 
. *2d sensitivity 3: restricted exposure window
. stcox standjaki3m i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m 

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-474.90037
{txt}Iteration 1:   log likelihood = {res}-465.55841
{txt}Iteration 2:   log likelihood = {res}-464.06097
{txt}Iteration 3:   log likelihood = {res}-463.86522
{txt}Iteration 4:   log likelihood = {res}-463.85194
{txt}Iteration 5:   log likelihood = {res}-463.85014
{txt}Iteration 6:   log likelihood = {res}-463.84949
{txt}Iteration 7:   log likelihood = {res}-463.84925
{txt}Iteration 8:   log likelihood = {res}-463.84916
{txt}Iteration 9:   log likelihood = {res}-463.84913
{txt}Iteration 10:  log likelihood = {res}-463.84912
{txt}Iteration 11:  log likelihood = {res}-463.84911
{txt}Iteration 12:  log likelihood = {res}-463.84911
{txt}Iteration 13:  log likelihood = {res}-463.84911
{txt}Iteration 14:  log likelihood = {res}-463.84911
{txt}Iteration 15:  log likelihood = {res}-463.84911
{txt}Iteration 16:  log likelihood = {res}-463.84911
{txt}Iteration 17:  log likelihood = {res}-463.84911
{txt}Iteration 18:  log likelihood = {res}-463.84911
{txt}Iteration 19:  log likelihood = {res}-463.84911
{txt}Iteration 20:  log likelihood = {res}-463.84911
{txt}Iteration 21:  log likelihood = {res}-463.84911
{txt}Iteration 22:  log likelihood = {res}-463.84911
{txt}Iteration 23:  log likelihood = {res}-463.84911
{txt}Iteration 24:  log likelihood = {res}-463.84911
{txt}Iteration 25:  log likelihood = {res}-463.84911
{txt}Iteration 26:  log likelihood = {res}-463.84911
{txt}Iteration 27:  log likelihood = {res}-463.84911
{txt}Iteration 28:  log likelihood = {res}-463.84911
{txt}Iteration 29:  log likelihood = {res}-463.84911
{txt}Iteration 30:  log likelihood = {res}-463.84911
{txt}Iteration 31:  log likelihood = {res}-463.84911
{txt}Iteration 32:  log likelihood = {res}-463.84911
{txt}Iteration 33:  log likelihood = {res}-463.84911
{txt}Iteration 34:  log likelihood = {res}-463.84911
{txt}Iteration 35:  log likelihood = {res}-463.84911
{txt}Iteration 36:  log likelihood = {res}-463.84911
{txt}Iteration 37:  log likelihood = {res}-463.84911
{txt}Iteration 38:  log likelihood = {res}-463.84911
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-463.84911
{txt}Iteration 1:   log likelihood = {res}-463.84911

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}         830                  {txt}Number of obs    =  {res}       830
{txt}No. of failures = {res}          71
{txt}Time at risk    = {res} 477.3689254
                                                {txt}LR chi2({res}21{txt})      =  {res}     22.10
{txt}Log likelihood  =   {res}-463.84911                  {txt}Prob > chi2      =  {res}    0.3936

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 1}standjaki3m {c |}{col 14}{res}{space 2} .9399043{col 26}{space 2} .2541559{col 37}{space 1}   -0.23{col 46}{space 3}0.819{col 54}{space 4} .5532399{col 67}{space 3} 1.596812
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.572582{col 26}{space 2} .5541275{col 37}{space 1}    1.28{col 46}{space 3}0.199{col 54}{space 4} .7882741{col 67}{space 3} 3.137252
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.493339{col 26}{space 2} .5366843{col 37}{space 1}    1.12{col 46}{space 3}0.264{col 54}{space 4} .7383272{col 67}{space 3} 3.020423
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.655429{col 26}{space 2} .6218621{col 37}{space 1}    1.34{col 46}{space 3}0.180{col 54}{space 4} .7927872{col 67}{space 3} 3.456722
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} .9796269{col 26}{space 2}    .4389{col 37}{space 1}   -0.05{col 46}{space 3}0.963{col 54}{space 4} .4070978{col 67}{space 3} 2.357342
{txt}{space 8}80+  {c |}{col 14}{res}{space 2}  1.25246{col 26}{space 2} .6380832{col 37}{space 1}    0.44{col 46}{space 3}0.659{col 54}{space 4} .4614315{col 67}{space 3} 3.399542
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} .8720084{col 26}{space 2} .2118221{col 37}{space 1}   -0.56{col 46}{space 3}0.573{col 54}{space 4} .5416925{col 67}{space 3} 1.403746
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .7006043{col 26}{space 2} .3297572{col 37}{space 1}   -0.76{col 46}{space 3}0.450{col 54}{space 4} .2785051{col 67}{space 3} 1.762432
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.182207{col 26}{space 2}  .429684{col 37}{space 1}    0.46{col 46}{space 3}0.645{col 54}{space 4} .5798511{col 67}{space 3} 2.410297
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2}  1.36582{col 26}{space 2} .3743785{col 37}{space 1}    1.14{col 46}{space 3}0.255{col 54}{space 4} .7981318{col 67}{space 3} 2.337288
{txt}5 most de..  {c |}{col 14}{res}{space 2} .5901273{col 26}{space 2} .3096006{col 37}{space 1}   -1.01{col 46}{space 3}0.315{col 54}{space 4} .2110459{col 67}{space 3} 1.650116
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} .9849005{col 26}{space 2} .0776656{col 37}{space 1}   -0.19{col 46}{space 3}0.847{col 54}{space 4} .8438587{col 67}{space 3} 1.149516
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  1.27541{col 26}{space 2} .3184413{col 37}{space 1}    0.97{col 46}{space 3}0.330{col 54}{space 4} .7818509{col 67}{space 3} 2.080539
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .6642757{col 26}{space 2} .1718641{col 37}{space 1}   -1.58{col 46}{space 3}0.114{col 54}{space 4} .4000572{col 67}{space 3} 1.102998
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.550272{col 26}{space 2} .4113883{col 37}{space 1}    1.65{col 46}{space 3}0.098{col 54}{space 4} .9215705{col 67}{space 3} 2.607878
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .5471273{col 26}{space 2} .2024797{col 37}{space 1}   -1.63{col 46}{space 3}0.103{col 54}{space 4} .2648973{col 67}{space 3} 1.130054
{txt}{space 6}cancer {c |}{col 14}{res}{space 2}  1.04188{col 26}{space 2} .2507933{col 37}{space 1}    0.17{col 46}{space 3}0.865{col 54}{space 4} .6500144{col 67}{space 3} 1.669984
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 4.952993{col 26}{space 2} 5.157036{col 37}{space 1}    1.54{col 46}{space 3}0.124{col 54}{space 4} .6435764{col 67}{space 3} 38.11845
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 1.04e-17{col 26}{space 2} 7.85e-09{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.490112{col 26}{space 2} .4107761{col 37}{space 1}    1.45{col 46}{space 3}0.148{col 54}{space 4} .8681006{col 67}{space 3} 2.557808
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .8446611{col 26}{space 2} .1462558{col 37}{space 1}   -0.97{col 46}{space 3}0.330{col 54}{space 4} .6015811{col 67}{space 3} 1.185962
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2dsensitivity3, replace
{res}{txt}(note: file output/data/primaryobjective2dsensitivity3.ster not found)
{txt}file output/data/primaryobjective2dsensitivity3.ster saved

{com}. 
. *2d sensitivity 4: covid positivity- ?include primary care swabs or just sgss?
. 
. stset stopswab, id(patient_id) failure(first_pos_test_sgss==1) origin(time enter_date) scale(365.25)  exit(first_pos_test_sgss==1 time mdy(10,01,2020))

                {txt}id:  {res}patient_id
     {txt}failure event:  {res}first_pos_test_sgss == 1
{txt}obs. time interval:  {res}(stopswab[_n-1], stopswab]
{txt} exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
    {txt}t for analysis:  {res}(time-origin)/365.25
            {txt}origin:  {res}time enter_date

{txt}{hline 78}
{res}     39,354{txt}  total observations
{res}        401{txt}  observations end on or before enter()
{hline 78}
{res}     38,953{txt}  observations remaining, representing
{res}     38,953{txt}  subjects
{res}      3,506{txt}  failures in single-failure-per-subject data
{res} 22,262.631{txt}  total analysis time at risk and under observation
                                                at risk from t = {res}        0
                                     {txt}earliest observed entry t = {res}        0
                                          {txt}last observed exit t = {res} .5859001
{txt}
{com}. stcox standjaki i.agegroup male i.ethnicity i.imd bmicat bowel skin joint chronic_cardiac_disease cancer i.diabcat oral_prednisolone_3m_0m

         {txt}failure _d:  {res}first_pos_test_sgss == 1
   {txt}analysis time _t:  {res}(stopswab-origin)/365.25
             {txt}origin:  {res}time enter_date
{txt}  exit on or before:  {res}first_pos_test_sgss==1 time mdy(10,01,2020)
                 {txt}id:  {res}patient_id

{txt}Iteration 0:   log likelihood = {res}-681.18156
{txt}Iteration 1:   log likelihood = {res}-671.09726
{txt}Iteration 2:   log likelihood = {res}-670.85728
{txt}Iteration 3:   log likelihood = {res}-670.84175
{txt}Iteration 4:   log likelihood = {res} -670.8364
{txt}Iteration 5:   log likelihood = {res}-670.83443
{txt}Iteration 6:   log likelihood = {res}-670.83371
{txt}Iteration 7:   log likelihood = {res}-670.83344
{txt}Iteration 8:   log likelihood = {res}-670.83335
{txt}Iteration 9:   log likelihood = {res}-670.83331
{txt}Iteration 10:  log likelihood = {res} -670.8333
{txt}Iteration 11:  log likelihood = {res}-670.83329
{txt}Iteration 12:  log likelihood = {res}-670.83329
{txt}Iteration 13:  log likelihood = {res}-670.83329
{txt}Iteration 14:  log likelihood = {res}-670.83329
{txt}Iteration 15:  log likelihood = {res}-670.83329
{txt}Iteration 16:  log likelihood = {res}-670.83329
{txt}Iteration 17:  log likelihood = {res}-670.83329
{txt}Iteration 18:  log likelihood = {res}-670.83329
{txt}Iteration 19:  log likelihood = {res}-670.83329
{txt}Iteration 20:  log likelihood = {res}-670.83329
{txt}Iteration 21:  log likelihood = {res}-670.83329
{txt}Iteration 22:  log likelihood = {res}-670.83329
{txt}Iteration 23:  log likelihood = {res}-670.83329
{txt}Iteration 24:  log likelihood = {res}-670.83329
{txt}Iteration 25:  log likelihood = {res}-670.83329
{txt}Iteration 26:  log likelihood = {res}-670.83329
{txt}Iteration 27:  log likelihood = {res}-670.83329
{txt}Iteration 28:  log likelihood = {res}-670.83329
{txt}Refining estimates:
Iteration 0:   log likelihood = {res}-670.83329
{txt}Iteration 1:   log likelihood = {res}-670.83329

{txt}Cox regression -- Breslow method for ties

No. of subjects = {res}       1,078                  {txt}Number of obs    =  {res}     1,078
{txt}No. of failures = {res}          98
{txt}Time at risk    = {res} 619.7919233
                                                {txt}LR chi2({res}21{txt})      =  {res}     20.70
{txt}Log likelihood  =   {res}-670.83329                  {txt}Prob > chi2      =  {res}    0.4776

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}          _t{col 14}{c |} Haz. Ratio{col 26}   Std. Err.{col 38}      z{col 46}   P>|z|{col 54}     [95% Con{col 67}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 3}standjaki {c |}{col 14}{res}{space 2} .8169964{col 26}{space 2} .1774821{col 37}{space 1}   -0.93{col 46}{space 3}0.352{col 54}{space 4} .5337125{col 67}{space 3} 1.250642
{txt}{space 12} {c |}
{space 4}agegroup {c |}
{space 5}40-<50  {c |}{col 14}{res}{space 2} 1.680301{col 26}{space 2} .4919807{col 37}{space 1}    1.77{col 46}{space 3}0.076{col 54}{space 4} .9465883{col 67}{space 3} 2.982724
{txt}{space 5}50-<60  {c |}{col 14}{res}{space 2} 1.354796{col 26}{space 2} .4316085{col 37}{space 1}    0.95{col 46}{space 3}0.341{col 54}{space 4} .7256041{col 67}{space 3} 2.529579
{txt}{space 5}60-<70  {c |}{col 14}{res}{space 2} 1.197914{col 26}{space 2} .4142639{col 37}{space 1}    0.52{col 46}{space 3}0.602{col 54}{space 4} .6082224{col 67}{space 3} 2.359332
{txt}{space 5}70-<80  {c |}{col 14}{res}{space 2} 1.082227{col 26}{space 2}  .395629{col 37}{space 1}    0.22{col 46}{space 3}0.829{col 54}{space 4} .5286217{col 67}{space 3} 2.215601
{txt}{space 8}80+  {c |}{col 14}{res}{space 2} 1.778249{col 26}{space 2} .6734013{col 37}{space 1}    1.52{col 46}{space 3}0.128{col 54}{space 4} .8465502{col 67}{space 3} 3.735358
{txt}{space 12} {c |}
{space 8}male {c |}{col 14}{res}{space 2} 1.158996{col 26}{space 2} .2371576{col 37}{space 1}    0.72{col 46}{space 3}0.471{col 54}{space 4} .7760798{col 67}{space 3} 1.730843
{txt}{space 12} {c |}
{space 3}ethnicity {c |}
South Asian  {c |}{col 14}{res}{space 2} .4887174{col 26}{space 2} .2267245{col 37}{space 1}   -1.54{col 46}{space 3}0.123{col 54}{space 4}  .196866{col 67}{space 3} 1.213235
{txt}{space 6}Other  {c |}{col 14}{res}{space 2} 1.189808{col 26}{space 2} .3706377{col 37}{space 1}    0.56{col 46}{space 3}0.577{col 54}{space 4} .6461282{col 67}{space 3} 2.190964
{txt}{space 12} {c |}
{space 9}imd {c |}
{space 10}4  {c |}{col 14}{res}{space 2} 1.076677{col 26}{space 2} .2647449{col 37}{space 1}    0.30{col 46}{space 3}0.764{col 54}{space 4} .6649402{col 67}{space 3} 1.743363
{txt}5 most de..  {c |}{col 14}{res}{space 2} .6171933{col 26}{space 2} .2642481{col 37}{space 1}   -1.13{col 46}{space 3}0.260{col 54}{space 4} .2666759{col 67}{space 3} 1.428429
{txt}{space 12} {c |}
{space 6}bmicat {c |}{col 14}{res}{space 2} 1.056547{col 26}{space 2} .0710175{col 37}{space 1}    0.82{col 46}{space 3}0.413{col 54}{space 4} .9261342{col 67}{space 3} 1.205324
{txt}{space 7}bowel {c |}{col 14}{res}{space 2}  1.00128{col 26}{space 2} .2183819{col 37}{space 1}    0.01{col 46}{space 3}0.995{col 54}{space 4} .6529895{col 67}{space 3} 1.535341
{txt}{space 8}skin {c |}{col 14}{res}{space 2} .7349353{col 26}{space 2} .1607785{col 37}{space 1}   -1.41{col 46}{space 3}0.159{col 54}{space 4} .4786693{col 67}{space 3} 1.128399
{txt}{space 7}joint {c |}{col 14}{res}{space 2} 1.389165{col 26}{space 2} .3176931{col 37}{space 1}    1.44{col 46}{space 3}0.151{col 54}{space 4} .8873389{col 67}{space 3} 2.174794
{txt}chronic_c~se {c |}{col 14}{res}{space 2} .6765619{col 26}{space 2} .1993943{col 37}{space 1}   -1.33{col 46}{space 3}0.185{col 54}{space 4}  .379703{col 67}{space 3} 1.205511
{txt}{space 6}cancer {c |}{col 14}{res}{space 2}   .96848{col 26}{space 2} .1971752{col 37}{space 1}   -0.16{col 46}{space 3}0.875{col 54}{space 4} .6498191{col 67}{space 3} 1.443407
{txt}{space 12} {c |}
{space 5}diabcat {c |}
Controlle..  {c |}{col 14}{res}{space 2} 2.793288{col 26}{space 2}  2.85162{col 37}{space 1}    1.01{col 46}{space 3}0.314{col 54}{space 4} .3776928{col 67}{space 3} 20.65821
{txt}Uncontrol..  {c |}{col 14}{res}{space 2} 2.70e-13{col 26}{space 2} 1.30e-06{col 37}{space 1}   -0.00{col 46}{space 3}1.000{col 54}{space 4}        0{col 67}{space 3}        .
{txt}Diabetes,..  {c |}{col 14}{res}{space 2} 1.226252{col 26}{space 2} .3038427{col 37}{space 1}    0.82{col 46}{space 3}0.410{col 54}{space 4} .7545145{col 67}{space 3} 1.992929
{txt}{space 12} {c |}
oral_pred~0m {c |}{col 14}{res}{space 2} .9146237{col 26}{space 2} .1107949{col 37}{space 1}   -0.74{col 46}{space 3}0.461{col 54}{space 4} .7213239{col 67}{space 3} 1.159724
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}

{com}. estimates save output/data/primaryobjective2dsensitivity4, replace
{res}{txt}(note: file output/data/primaryobjective2dsensitivity4.ster not found)
{txt}file output/data/primaryobjective2dsensitivity4.ster saved

{com}. 
. log close
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/workspace/logs/cr_create_analysis_dataset.smcl
  {txt}log type:  {res}smcl
 {txt}closed on:  {res}17 Mar 2021, 13:55:19
{txt}{.-}
{smcl}
{txt}{sf}{ul off}